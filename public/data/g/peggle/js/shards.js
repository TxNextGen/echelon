function launch(){var t=new Shards.Game,e=Shards.Global.SPONSORS[Shards.sponsorName];if("undefined"==typeof e);else{Shards.Global.sponsor=e;var i=e.id;1===i?e.sdk=new Sponsor.SponsorBuongiorno(t):2===i?e.sdk=new Sponsor.SponsorFamobi(t):e.sdk=new Sponsor.SponsorAdapter(t)}}var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Shards;!function(t){var e;!function(t){function e(t,e,i){var s=t*Math.PI*2*e,a=t*Math.PI*2*i;return Math.sin(s)*Math.cos(a)}function i(t,e,i){var s=t*Math.PI*2*e,a=-t*i;return Math.sin(s)*Math.exp(a)}function s(t){return t*(2*t-1)}function a(t){return-2*t*t+3*t}function o(t){return-(a(1-t)-1)}function n(t){return Math.sin(2*t*Math.PI)}function r(t){return Math.sin(2*t*Math.PI)}function h(t,e){return Math.sin(2*t*Math.PI*e)}t.wiggle=e,t.sinWithExpDecay=i,t.parabolic=s,t.pop5=a,t.pop5rev=o,t.sin=n,t.sinRotate=r,t.sinWithPeriod=h}(e=t.Easing||(t.Easing={}))}(Shards||(Shards={}));var Helper;!function(t){var e=function(){function t(e,i,s){if(void 0===i&&(i=-1),void 0===s&&(s=!0),this._bounceDuration=[],this._bounceHeight=[],this._bouceVelocity=[],!(0>=e&&0>i)){if(e>0&&0>i)i=Math.pow(t.EPSILON,1/e);else if(i>0&&0>=e){if(i>=1)return;e=Math.floor(Math.log(t.EPSILON)/Math.log(i)),e=Math.min(e,t.BOUNCES_MAX)}for(var a=t.EPSILON,o=0,n=1,r=0;e>r;r++){var h=2*Math.sqrt(2*n/a);s&&0==r&&(h/=2),this._bounceDuration[r]=h,this._bounceHeight[r]=n,o+=h,n*=i}for(var r=0;e>r;r++){var h=this._bounceDuration[r]/o;this._bounceDuration[r]=h}var l=s?this._bounceDuration[0]:this._bounceDuration[0]/2;this._acceleration=2/(l*l);for(var r=0;e>r;r++)0==r&&s?this._bouceVelocity[r]=0:this._bouceVelocity[r]=this._bounceDuration[r]/2*this._acceleration;this._acceleration=-this._acceleration,this._bounces=e,this._elasticity=i,this._halveFirstBounce=s}}return t.prototype.easing=function(t){for(var e=0,i=0;e<this._bounces&&t>i+this._bounceDuration[e];)i+=this._bounceDuration[e],++e;if(e>=this._bounces)return 0;t-=i;var s=0;return s=0==e&&this._halveFirstBounce?1+this._acceleration*(t*t)/2:t*(this._bouceVelocity[e]+this._acceleration*t/2)},t.EPSILON=.001,t.BOUNCES_MAX=10,t}();t.GravityBounce=e}(Helper||(Helper={}));var Helper;!function(t){function e(t,e,i){return(e-t)*i+t}function i(t,i,s,a){return e(e(t,i,a),e(i,s,a),a)}function s(t,s,a,o,n){return e(i(t,s,a,n),i(s,a,o,n),n)}function a(t,i,a,o,n,r){return e(s(t,i,a,o,r),s(i,a,o,n,r),r)}function o(t,e,i,s){return 0===i?t:(i>0?e>t&&(e-=360):t>e&&(e+=360),this.linear(t,e,s))}t.linear=e,t.quadratic=i,t.cubic=s,t.quintic=a,t.angleLinear=o}(Helper||(Helper={}));var Helper;!function(t){var e=function(){function t(){}return t.create=function(e,i,s,a,o,n,r,h,l,_){void 0===n&&(n=0),void 0===r&&(r=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===_&&(_=!1);var c,d=new Phaser.Image(e,0,0,a,o);return c="string"==typeof o?e.cache.getFrameByName(a,o):e.cache.getFrameByIndex(a,o),t.calculateNineImage(c,i,s,n,r,h,l,_),t._nineImage=new Phaser.BitmapData(e,"NineImage"+t._textureKey++,t._width,t._height),t.renderNineImage(d),t._nineImage},t.calculateNineImage=function(e,i,s,a,o,n,r,h){if(t._centralWidth=e.width-o-r,t._centralHeight=e.height-a-n,h)t._horizontalRepeats=i,t._verticalRepeats=s,t._width=o+r+t._centralWidth*i,t._height=a+n+t._centralHeight*s,t._lastWidth=0,t._lastHeight=0;else{var l=i-o-r;t._horizontalRepeats=Math.floor(l/t._centralWidth),t._lastWidth=l%t._centralWidth;var _=s-a-n;t._verticalRepeats=Math.floor(_/t._centralHeight),t._lastHeight=_%t._centralHeight,t._width=i,t._height=s}t._leftWidth=o,t._rightWidth=r,t._topHeight=a,t._bottomHeight=n},t.renderNineImage=function(e){var i=0,s=0;t._topHeight>0&&(t.renderNineImageRow(e,i,s,t._topHeight),i+=t._topHeight,s+=t._topHeight);for(var a=0;a<t._verticalRepeats;a++)t.renderNineImageRow(e,i,s,t._centralHeight),s+=t._centralHeight;t._lastHeight>0&&(t.renderNineImageRow(e,i,s,t._lastHeight),s+=t._lastHeight),i+=t._centralHeight,t._bottomHeight>0&&t.renderNineImageRow(e,i,s,t._bottomHeight)},t.renderNineImageRow=function(e,i,s,a){var o=0,n=0;t._leftWidth>0&&(t._nineImage.copy(e,o,i,t._leftWidth,a,n,s),n+=t._leftWidth,o+=t._leftWidth);for(var r=0;r<t._horizontalRepeats;r++)t._nineImage.copy(e,o,i,t._centralWidth,a,n,s),n+=t._centralWidth;t._lastWidth>0&&(t._nineImage.copy(e,o,i,t._lastWidth,a,n,s),n+=t._lastWidth),o+=t._centralWidth,t._rightWidth>0&&t._nineImage.copy(e,o,i,t._rightWidth,a,n,s)},t._textureKey=0,t}();t.NineImage=e}(Helper||(Helper={}));var Helper;!function(t){var e;!function(t){t[t.UNDEFINED=-1]="UNDEFINED",t[t.SPACE=1]="SPACE",t[t.NEWLINE=2]="NEWLINE",t[t.CHARACTER=3]="CHARACTER"}(e||(e={}));var i=function(){function t(){}return t.hasNext=function(){return t.textPosition<t.text.length},t.getChar=function(){return t.text.charAt(t.textPosition++)},t.peekChar=function(){return t.text.charAt(t.textPosition)},t.getPosition=function(){return t.textPosition},t.setPosition=function(e){t.textPosition=e},t.getCharAdvance=function(e,i){var s=t.fontData.chars[e],a=s.xAdvance;return i>0&&s.kerning[i]&&(a+=s.kerning[i]),a},t.getCharType=function(t){return" "===t?e.SPACE:/(?:\r\n|\r|\n)/.test(t)?e.NEWLINE:e.CHARACTER},t.wrapText=function(i,s,a,o,n,r){t.text=s,t.setPosition(0),t.fontData=i.cache.getBitmapFont(n).font,void 0===r&&(r=t.fontData.size);var h=r/t.fontData.size,l=t.fontData.lineHeight*h,_=a/h,c=[],d=[],u=[],p=0,g=!0,m=0,S=0;c[p]=S,u[m++]=0;for(var T=o;t.hasNext();){for(var E=0,f=0,y=-1,O=e.UNDEFINED,b=e.UNDEFINED,A=_,v=-1;t.hasNext();){S=t.getPosition();var I=t.getChar();O=t.getCharType(I);var C=I.charCodeAt(0);if(O===e.SPACE)b!==e.SPACE&&(f=E),++E,A-=t.getCharAdvance(C,v);else if(O===e.CHARACTER){if(b!==e.CHARACTER&&(y=S),A-=t.getCharAdvance(C,v),0>A)break;++E}else if(O===e.NEWLINE){var N=!1;if(t.hasNext()&&(N=!0,f=E,y=t.getPosition(),S=y,A=-1,O=e.CHARACTER),N)break}b=O,v=C}T-=l,0>T&&(u[m++]=p),0>A&&O===e.CHARACTER?(0!==f?d[p]=f:d[p]=E,g=!1,0>T&&(g=!0,T=o-l),0!==f?(c[++p]=y,t.setPosition(y)):(c[++p]=S,t.setPosition(S))):t.hasNext()||(O===e.CHARACTER?d[p]=E:O===e.SPACE&&(d[p]=f))}u[m]=p+1;for(var B=[],P=1;m>=P;P++){for(var M=u[P-1],L=u[P],x=[],G=M;L>G;G++)x.push(t.text.substr(c[G],d[G]));B.push(x.join("\n"))}return B},t}();t.TextWrapper=i}(Helper||(Helper={}));var Shards;!function(t){var e=function(t){function e(){t.call(this),this._animIdx=0,this._time=-500,this._animOver=!1}return __extends(e,t),e.prototype.preload=function(){this.load.image("Logo","assets/sponsor/Logo.png"),this.load.audio("LogoSound",["assets/sponsor/sound.ogg","assets/sponsor/sound.m4a","assets/sponsor/sound.mp3"])},e.prototype.create=function(){this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width,this.game.height),this.camera.focusOnXY(0,0),this.stage.backgroundColor=0,this._sound=this.add.audio("LogoSound");var t=this.add.group(this.world),i=this.game.width/e.LOGO_ANIM_WIDTH;t.scale.set(i,i),this._logo=this.add.sprite(0,0,"Logo",0,t),this._logo.anchor.copyFrom(e.LOGO_ANCHOR),this.setLogoFrame(this._animIdx)},e.prototype.setLogoFrame=function(t){t>=e.LOGO_ANIM.length&&(t=e.LOGO_ANIM.length-1);var i=e.LOGO_ANIM[t];this._logo.position.set(i.x,i.y),this._logo.scale.set(i.scaleX,i.scaleY);var s=i.sound;"undefined"!=typeof s&&this._sound.play()},e.prototype.update=function(){if(!this._animOver&&(this._time+=this.time.elapsedMS,e.LOGO_ANIM[this._animIdx].time<this._time))if(this.setLogoFrame(this._animIdx),this._animIdx===e.LOGO_ANIM.length-1)this._animOver=!0,this.game.state.start("Preloader",!0,!1);else for(;this._animIdx<e.LOGO_ANIM.length&&e.LOGO_ANIM[this._animIdx].time<this._time;)++this._animIdx},e.prototype.shutdown=function(){this._logo=null,this._sound=null,this.cache.removeSound("LogoSound")},e.LOGO_ANIM_WIDTH=1440,e.LOGO_ANIM_HEIGHT=900,e.LOGO_ANCHOR=new Phaser.Point(.510396975,.29820498),e.LOGO_ANIM=[{time:0,x:1,y:-1,scaleX:0,scaleY:0,sound:"LogoSound"},{time:791,x:1,y:-1,scaleX:.462769,scaleY:.462769},{time:1458,x:1,y:-1,scaleX:.77356,scaleY:.77356},{time:1999,x:1,y:-1,scaleX:1.440338,scaleY:1.440338},{time:2291,x:1,y:-1,scaleX:1.445007,scaleY:1.445007},{time:2374,x:1,y:-1,scaleX:1.658508,scaleY:1.658508},{time:2583,x:1,y:-1,scaleX:1.74144,scaleY:1.74144},{time:2791,x:1,y:-1,scaleX:2.028625,scaleY:2.028625},{time:3207,x:1,y:-1,scaleX:2.120972,scaleY:2.120972},{time:3291,x:1,y:-1,scaleX:2.436874,scaleY:2.436874},{time:3457,x:1,y:-1,scaleX:2.103882,scaleY:2.103882},{time:3582,x:1,y:-1,scaleX:2.135498,scaleY:2.135498},{time:3707,x:1,y:-1,scaleX:0,scaleY:0},{time:3749,x:1,y:-1,scaleX:2.135498,scaleY:2.135498},{time:3874,x:1,y:-1,scaleX:0,scaleY:0},{time:3957,x:1,y:-1,scaleX:8.09906,scaleY:8.09906},{time:3999,x:-175,y:159,scaleX:8.09906,scaleY:8.09906},{time:4040,x:241,y:-155,scaleX:8.09906,scaleY:8.09906},{time:4165,x:1,y:-1,scaleX:0,scaleY:0},{time:4207,x:1,y:-1,scaleX:2.412292,scaleY:2.412292},{time:5498,x:1,y:-1,scaleX:0,scaleY:0}],e}(Phaser.State);t.Logo2=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this),this._lock=!1}return __extends(i,e),i.prototype.create=function(){this.stage.backgroundColor=16777215},i.prototype.update=function(){this._lock||t.Global.correctOrientation&&(this._lock=!0,this.time.events.add(200,function(){"undefined"==typeof t.Global.sponsor.logo?this.game.state.start("Preloader",!0,!1):(this.game.state.add("Logo",t.Logo),this.game.state.start("Logo",!0,!1))},this))},i}(Phaser.State);t.OrientationWait=e}(Shards||(Shards={}));var UI;!function(t){var e=function(t){function e(e,i,s,a,o,n,r){t.call(this,e),this.onClick=new Phaser.Signal,this.onDown=new Phaser.Signal,this.scaleOnOver=new Phaser.Point(1,1),this.scaleOnDown=new Phaser.Point(1,1),this.offsetOnOver=new Phaser.Point(0,0),this.offsetOnDown=new Phaser.Point(0,0),this._tinted=!1,this._downTint=8421504,this._overTint=0,this._savePosition=new Phaser.Point,this._saveScale=new Phaser.Point,this._over=!1,this._down=!1;var h=new Phaser.Button(e,0,0,s);this.add(h),this._button=h,void 0!==o&&o&&(this._tinted=!0),void 0===n&&(this._tinted||!e.cache.getFrameByName(s,n))&&(n=null),void 0===r&&(this._tinted||!e.cache.getFrameByName(s,r))&&(r=null),h.setFrames(r,a,n,a),h.anchor.setTo(.5,.5),h.name=i,h.onInputOver.add(this.overEvent,this),h.onInputOut.add(this.outEvent,this),h.onInputDown.add(this.downEvent,this),h.onInputUp.add(this.upEvent,this)}return __extends(e,t),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._button.anchor},enumerable:!0,configurable:!0}),e.prototype.setHitArea=function(t){this._button.hitArea=t},e.prototype.setTint=function(t,e){void 0===e&&(e=0),this._downTint=t,this._overTint=e},e.prototype.overEvent=function(){this.setButton(!0,this._down),this.overAction()},e.prototype.outEvent=function(){this.setButton(!1,!1),this.outAction()},e.prototype.downEvent=function(){this.setButton(this._over,!0),this.downAction(),this.onDown.dispatch(this)},e.prototype.upEvent=function(t,e,i){this.setButton(this._over,!1),this.upAction(),i&&this.onClick.dispatch(this)},e.prototype.setButton=function(t,e){this._over||this._down||(this._saveScale.copyFrom(this._button.scale),this._savePosition.copyFrom(this._button.position)),this._down=e,this._over=t,e?(Phaser.Point.multiply(this._saveScale,this.scaleOnDown,this._button.scale),Phaser.Point.add(this._button.position,this.offsetOnDown,this._button.position),this._tinted&&(this._button.tint=this._downTint)):t?(Phaser.Point.multiply(this._saveScale,this.scaleOnOver,this._button.scale),Phaser.Point.add(this._button.position,this.offsetOnOver,this._button.position),this._tinted&&(this._button.tint=this._overTint)):(this._button.scale.copyFrom(this._saveScale),this._button.position.copyFrom(this._savePosition),this._tinted&&(this._button.tint=16777215))},e.prototype.overAction=function(){},e.prototype.outAction=function(){},e.prototype.downAction=function(){Utils.AudioUtils.playSound(Shards.Sfx.CLICK)},e.prototype.upAction=function(){},e}(Phaser.Group);t.Button=e}(UI||(UI={}));var UI;!function(t){var e=function(t){function e(e,i,s,a,o,n,r,h){t.call(this,e,i,s,a,n,r,h),this._changeOnDown=!1,this._checkFramePosition=new Phaser.Point,this._checked=!1;var l=o+"On";!this.game.cache.getFrameByName(s,l),this._frameChecked=l;var _=o+"Off";this.game.cache.getFrameByName(s,l)||(_=null),this._frameUnchecked=_;var c=new Phaser.Sprite(e,0,0,s);c.anchor.set(.5,.5),this.addChild(c),this._checkSprite=c,this.checked=!1}return __extends(e,t),Object.defineProperty(e.prototype,"checked",{get:function(){return this._checked},set:function(t){if(this._checked=t,t)this._checkSprite.frameName=this._frameChecked,this._checkSprite.visible=!0;else{var e=null!==this._frameUnchecked;e&&(this._checkSprite.frameName=this._frameUnchecked),this._checkSprite.visible=e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"changeOnDown",{get:function(){return this._changeOnDown},set:function(t){this._changeOnDown=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checkSprite",{get:function(){return this._checkSprite},enumerable:!0,configurable:!0}),e.prototype.setCheckPosition=function(t,e){this._checkSprite.position.set(t,e)},e.prototype.downEvent=function(){this.setButton(this._over,!0),this._changeOnDown&&(this.checked=!this.checked),this.downAction(),this.onDown.dispatch(this,this._checked)},e.prototype.upEvent=function(t,e,i){this.setButton(this._over,!1),this.upAction(),i&&(this._changeOnDown||(this.checked=!this.checked),this.onClick.dispatch(this,this._checked))},e}(t.Button);t.CheckBox=e}(UI||(UI={}));var UI;!function(t){var e=function(t){function e(e,i,s,a,o,n){t.call(this,e,i,s,a,n,o),this._toggled=!1,this._changeOnDown=!0,this._frameToggled=o,this._frameUntoggled=a,this.toggled=this._toggled}return __extends(e,t),Object.defineProperty(e.prototype,"toggled",{get:function(){return this._toggled},set:function(t){this._toggled=t,t?(this._button.setFrames(null,this._frameToggled,this._frameToggled,this._frameToggled),this._changeOnDown&&(this._button.frameName=this._frameToggled)):(this._button.setFrames(null,this._frameUntoggled,this._frameUntoggled,this._frameUntoggled),this._changeOnDown&&(this._button.frameName=this._frameUntoggled))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"changeOnDown",{get:function(){return this._changeOnDown},set:function(t){this._changeOnDown=t},enumerable:!0,configurable:!0}),e.prototype.downEvent=function(){this.setButton(this._over,!0),this._changeOnDown&&(this.toggled=!this.toggled),this.downAction(),this.onDown.dispatch(this,this._toggled)},e.prototype.upEvent=function(t,e,i){this.setButton(this._over,!1),this.upAction(),i&&(this._changeOnDown||(this.toggled=!this.toggled),this.onClick.dispatch(this,this._toggled))},e}(t.Button);t.Toggle=e}(UI||(UI={}));var Shards;!function(t){!function(t){t[t.NULL_TERMINATED=0]="NULL_TERMINATED",t[t.READ_LENGTH=1]="READ_LENGTH",t[t.FIXED_LENGTH=2]="FIXED_LENGTH"}(t.eStringLenghtType||(t.eStringLenghtType={}));var e=t.eStringLenghtType,i=function(){function t(t,i){void 0===i&&(i=!1),this._bin=new DataView(t),this._littleEndian=i,this._position=0;var s=this.readString(e.FIXED_LENGTH,3);"NC2"===s&&(this._compound=!0,this._filesCount=(this.readUint32()>>2)-1),this.setFile(0)}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),t.prototype.setFile=function(t){void 0===t&&(t=0),this._compound?(this._position=3+4*t,this._lbound=this.readUint32()+3,this._ubound=this.readUint32()+3,this._position=this._lbound):(this._lbound=0,this._ubound=this._bin.byteLength,this._position=0)},t.prototype.hasNext=function(){return this._position<this._ubound},t.prototype.readUint8=function(){return this._bin.getUint8(this._position++)},t.prototype.readInt8=function(){return this._bin.getInt8(this._position++)},t.prototype.readUint16=function(t){void 0===t&&(t=this._littleEndian);var e=this._bin.getUint16(this._position,t);return this._position+=2,e},t.prototype.readInt16=function(t){void 0===t&&(t=this._littleEndian);var e=this._bin.getInt16(this._position,t);return this._position+=2,e},t.prototype.readUint32=function(t){void 0===t&&(t=this._littleEndian);var e=this._bin.getUint32(this._position,t);return this._position+=4,e},t.prototype.readInt32=function(t){void 0===t&&(t=this._littleEndian);var e=this._bin.getInt32(this._position,t);return this._position+=4,e},t.prototype.readFixed16_16=function(t){void 0===t&&(t=this._littleEndian);var e=this._bin.getInt32(this._position,t);return this._position+=4,e/65536},t.prototype.readFixed1_7=function(){var t=255&this._bin.getInt8(this._position++);return t/128},t.prototype.readString=function(t,i){void 0===i&&(i=0);var s=[];for(t===e.READ_LENGTH&&(i=this._bin.getUint8(this._position++));i>0||t===e.NULL_TERMINATED;){var a=this._bin.getUint8(this._position++);if(t===e.NULL_TERMINATED&&0===a)break;s.push(a),--i}return String.fromCharCode.apply(null,s)},t}();t.BinaryFileReader=i}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function e(t){this._game=t,this._loader=new Phaser.Loader(t),this._musicToPlay=-1}return e.prototype.loadMusic=function(){for(var e="assets/",i=0;i<t.Global.MAX_MUSIC;i++){var s="Music"+i;this._loader.audio(s,[e+s+".ogg",e+s+".m4a"])}this._loader.onFileComplete.add(this.onFileComplete,this),this._loader.start()},e.prototype.onFileComplete=function(t,e,i,s,a){var o=this._game.add.audio(e);Utils.AudioUtils.addMusic(e,o)},e.prototype.getMusic=function(){var e=this._musicToPlay;-1===e&&(e=this._game.rnd.integerInRange(0,t.Global.MAX_MUSIC-1),this._musicToPlay=e);do{var i="Music"+e;if(this._game.cache.getSound(i)&&this._game.cache.isSoundDecoded(i))return this._musicToPlay=(e+1)%t.Global.MAX_MUSIC,i;e=(e+1)%t.Global.MAX_MUSIC}while(e!==this._musicToPlay);return null},e}();t.MusicManager=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(){}return t.PTM=48,t.MUSIC_FILES_COUNT=4,t.EMPTY_HITS=40,t.EMPTY_HIT_DURATION=.25,t.NO_HIT_TIME=12.5,t.INITIAL_EFFECT_DURATION=.65,t.INITIAL_EFFECT_SCALE=10,t.IMPACT_DURATION=250,t.IMPACT_SCALE=1.0234375,t.BEST_ANIM_TIME=750,t.BEST_ANIM_TROPHY_SCALE=10,t.COLORED_BRICKS_MAX=20,t.SHADOW_OFFSET_X=19,t.SHADOW_OFFSET_Y=24,t.BRICK_SHINE=["BRICK_SHINE_0","BRICK_SHINE_1","BRICK_SHINE_2","BRICK_SHINE_3","BRICK_SHINE_4","BRICK_SHINE_5"],t.LAST_BRICK_TIME=29,t.LOST_TIME_BOMB=2,t.LOST_TIME_BALL=1,t.LOST_TIME_TOTAL=5,t.WON_TIME=3,t.TITLE_LEVEL=2.5,t.TITLE_GAMEOVER=5,t.BALLS_MAX=5,t.BALL_DIAMETER=33,t.PADDLE_HEIGHT_LEVEL=.147,t.PADDLE_SIZE_NORMAL=1,t.PADDLE_SIZE_SMALL=.5,t.PADDLE_SIZE_BIG=1.3,t.PADDLE_CHANGE_SPEED=1,t.CANNON_ON_ANIMATION=["GUN_0","GUN_1","GUN_2","GUN_3","GUN_4","GUN_5","GUN_6","GUN_7","GUN_8","GUN_9","GUN_10","GUN_11","GUN_12","GUN_13","GUN_14","GUN_15","GUN_16","GUN_17","GUN_18","GUN_19","GUN_20","GUN_21"],t.CANNON_OFF_ANIMATION=["GUN_21","GUN_20","GUN_19","GUN_18","GUN_17","GUN_16","GUN_15","GUN_14","GUN_13","GUN_12","GUN_11","GUN_10","GUN_9","GUN_8","GUN_7","GUN_6","GUN_5","GUN_4","GUN_3","GUN_2","GUN_1","GUN_0"],t.CANNON_DURATION=5,t.CANNON_OFFSET=40,t.PADDLE_OVERLAY_TIME=.5,t.BORDER_WIDTH=12,t.SHADOW_OFFSET=new Phaser.Point(0,0),t.PARTICLES_MAX=196,t.SPEED_NORMAL_SLOW_GAME=350,t.SPEED_INCREMENT=150,t.SPEED_FAST_RATE=1.5,t.SPEED_SLOW_RATE=.67,t.MISSILE_MAX=30,t.ENEMY_MAX=21,t.ENEMY_TIME_TO_SPAWN_MIN=5,t.ENEMY_TIME_TO_SPAWN_RANGE=15,t.ENEMY_RAGE_ADD=4,t.ENEMY_RAGE_LIMIT=10,t.ENEMY_RAGE_TIME=5,t.ENEMY_SPEED_NORMAL=1,t.ENEMY_SPEED_RAGE=5,t.ENEMY_TIME_TO_CHANGE_DIR_MIN=2,t.COMBOS_MAX=10,t.COMBO_TIMEOUT=1.5,t.BONUSES_MAX=16,t.PROBABILITY_BONUS=20,t.BONUS_FAST_DURATION=20,t.BONUS_SLOW_DURATION=20,t.BONUS_STICKY_DURATION=20,t.BONUS_POWER_DURATION=10,t.SCORE_DESTROYED=500,t.SCORE_ENEMY_DESTROYED=3e3,t.SCORE_NOT_DESTROYED=50,t.SCORE_COMBO=1e3,t}();t.Settings=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(t,e,i){void 0===i&&(i=null),this._newFunction=null,this._count=0,this._pool=[],this._canGrow=!0,this._maxPoolSize=0,this._classType=t,this._newFunction=i;for(var s=0;e>s;s++){var a=this.newItem();this._pool[this._count++]=a}}return t.prototype.createItem=function(){return 0===this._count?this._canGrow?this.newItem():null:this._pool[--this._count]},t.prototype.destroyItem=function(t){this._pool[this._count++]=t},Object.defineProperty(t.prototype,"newFunction",{set:function(t){this._newFunction=t},enumerable:!0,configurable:!0}),t.prototype.newItem=function(){return null!==this._newFunction?this._newFunction():new this._classType},Object.defineProperty(t.prototype,"canGrow",{set:function(t){this._canGrow=t},enumerable:!0,configurable:!0}),t}();t.Pool=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(){}return t.BALL_LOST=0,t.BALL_STICKY=1,t.BALL_STICKY_HIT=2,t.BOMB_EXPLOSION=3,t.BORDER_HIT_1=4,t.BORDER_HIT_2=5,t.BORDER_HIT_3=6,t.BRICK_DAMAGED_1=7,t.BRICK_DAMAGED_2=8,t.BRICK_DAMAGED_3=9,t.BRICK_DESTROYED_1=10,t.CANNON_EXPLOSION=11,t.CANNON_FIRE=12,t.CANNON_OFF=13,t.CANNON_ON=14,t.CLICK=15,t.FIRE=16,t.FREEZE=17,t.GAME_OVER=18,t.IMPACT=19,t.LIFE=20,t.PADDLE_ENLARGE=21,t.PADDLE_HIT_1=22,t.PADDLE_HIT_2=23,t.PADDLE_HIT_3=24,t.PADDLE_SHRINK=25,t.POWERBALL=26,t.SPLIT_BALL=27,t.SWOOSH=28,t.TICK=29,t.UNBREAKABLE_HIT_1=30,t.UNBREAKABLE_HIT_2=31,t.ENEMY_EXPLOSION=32,t.ENEMY_BORDER_HIT_1=33,t.ENEMY_BORDER_HIT_2=34,t.ENEMY_BORDER_HIT_3=35,t.ENEMY_BRICK_DAMAGED_1=36,t.ENEMY_BRICK_DAMAGED_2=37,t.ENEMY_BRICK_DAMAGED_3=38,t.ENEMY_UNBREAKABLE_HIT_1=39,t.ENEMY_UNBREAKABLE_HIT_2=40,t.SOUND_NAMES=["ball_lost","ball_sticky","ball_sticky_hit","bomb_explosion","border_hit_1","border_hit_2","border_hit_3","brick_damaged_1","brick_damaged_2","brick_damaged_3","brick_destroyed_1","cannon_explosion","cannon_fire","cannon_off","cannon_on","click","fire","freeze","game_over","impact","life","paddle_enlarge","paddle_hit_1","paddle_hit_2","paddle_hit_3","paddle_shrink","powerball","split_ball","swoosh","tick","unbreakable_hit_1","unbreakable_hit_2","enemy_explosion","enemy_border_hit_1","enemy_border_hit_2","enemy_border_hit_3","enemy_brick_damaged_1","enemy_brick_damaged_2","enemy_brick_damaged_3","enemy_unbreakable_hit_1","enemy_unbreakable_hit_2"],t}();t.Sfx=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function e(t,i){this.maxVelocity=e.MAX_VELOCITY,this._velocity=new Phaser.Point(0,0),this._angularVelocity=0,this._friction=0,this._angularDrag=0,this._gravity=0,this._alpha=1,this._scaleChange=0,this._alphaChange=0,this._game=t}return Object.defineProperty(e.prototype,"visual",{get:function(){return this._visual},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"on",{set:function(t){this._on=t,this._visual.exists=t,this._visual.visible=t},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var t=this._visual.parent;null!==t&&(t instanceof Phaser.Group?t.remove(this._visual):t.removeChild(this._visual),t=null)},e.prototype.bringToTop=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.bringToTop(this._visual)},e.prototype.sendToBack=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.sendToBack(this._visual)},Object.defineProperty(e.prototype,"textureKey",{set:function(t){this._textureKey=t},enumerable:!0,configurable:!0}),e.prototype.setScaleChange=function(t,e){void 0===e&&(e=0),this._scaleChangeType=t,this._scaleChange=e},Object.defineProperty(e.prototype,"alpha",{set:function(t){this._alpha=t,this._visual.alpha=Phaser.Math.clamp(t,0,1)},enumerable:!0,configurable:!0}),e.prototype.setAlphaChange=function(t,e){void 0===e&&(e=0),this._alphaChangeType=t,this._alphaChange=e},e.prototype.setPhysics=function(t,e,i,s,a,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===o&&(o=0),this._velocity.setTo(t,e),this._angularVelocity=i,this._friction=s,this._angularDrag=a,this._gravity=o,this._simplePhysics=0===o&&0===s&&0===a},e.prototype.setFrame=function(t){},e.prototype.onEmit=function(t){t.add(this._visual)},e.prototype.onKill=function(t){},e.prototype.update=function(e){void 0===e&&(e=!0);var i=this._game.time.physicsElapsed;if(this.lifetime>0&&(this.lifetime-=i)<=0)return!1;if((0!==this._velocity.x||0!==this._velocity.y)&&(this._visual.x+=this._velocity.x*i,this._visual.y+=this._velocity.y*i),0!==this._angularVelocity&&(this._visual.angle+=this._angularVelocity*i),this._simplePhysics||(this._velocity.x+=-this._friction*this._velocity.x*i,this._velocity.y+=(this._gravity-this._friction*this._velocity.y)*i,this._angularVelocity+=-this._angularDrag*this._angularVelocity*i),!e)return!0;if(this._scaleChangeType!=t.eParameterChangeType.NO_CHANGE)switch(this._scaleChangeType){case t.eParameterChangeType.IN_TIME:(this._visual.scale.x+=this._scaleChange*i)<0&&(this._visual.scale.x=0,this._scaleChange<0&&(this._scaleChangeType=t.eParameterChangeType.NO_CHANGE)),(this._visual.scale.y+=this._scaleChange*i)<0&&(this._visual.scale.y=0,this._scaleChange<0&&(this._scaleChangeType=t.eParameterChangeType.NO_CHANGE))}if(this._alphaChangeType!=t.eParameterChangeType.NO_CHANGE)switch(this._alphaChangeType){case t.eParameterChangeType.IN_TIME:this._alpha+=this._alphaChange*i,this._alpha<0?(this._visual.alpha=0,this._alphaChange<0&&(this._alphaChangeType=t.eParameterChangeType.NO_CHANGE)):this._alpha>1?(this._visual.alpha=1,this._alphaChange>0&&(this._alphaChangeType=t.eParameterChangeType.NO_CHANGE)):this._visual.alpha=this._alpha}return!0},e.MAX_VELOCITY=1e3,e}();t.Particle=e}(Shards||(Shards={}));var Shards;!function(t){var e;!function(t){t[t.NONE=0]="NONE",t[t.FLOW=1]="FLOW",t[t.EXPLODE=2]="EXPLODE"}(e||(e={})),function(t){t[t.NO_CHANGE=0]="NO_CHANGE",t[t.IN_TIME=1]="IN_TIME"}(t.eParameterChangeType||(t.eParameterChangeType={}));var i=t.eParameterChangeType,s=function(s){function a(o,n,r,h){s.call(this,o,null),this._maxParticles=a.MAX_PARTICELES,this.emitPoint=new Phaser.Point(0,0),this.area=new Phaser.Point(0,0),this.emitObject=null,this.gravity=100,this.particleClass=t.SpriteParticle,this.particleBringToTop=!1,this.particleSendToBack=!1,this.frequency=100,this.minLifetime=1,this.maxLifetime=2,this.minParticleScale=1,this.maxParticleScale=1,this.scaleChange=0,this.scaleChangeType=i.NO_CHANGE,this.minAngle=0,this.maxAngle=360,this.minParticleSpeed=new Phaser.Point(-100,-100),this.maxParticleSpeed=new Phaser.Point(100,100),this.particleFriction=0,this.minAngularSpeed=-360,this.maxAngularSpeed=360,this.angularDrag=0,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaChange=0,this.alphaChangeType=i.NO_CHANGE,this.forceEmit=!1,this._on=!1,this._mode=e.NONE,this._flowQuantity=0,this._flowTotal=0,this._flowCounter=0,this._particlesPool=[],this._counterPool=0,this._particlesUsed=[],this._counterUsed=0,this._timer=0,this._frames=null,this._emitPoint=new Phaser.Point(0,0),this._minParticleScale=new Phaser.Point(1,1),this._maxParticleScale=new Phaser.Point(1,1),this.position.setTo(n,r),this._maxParticles=h}return __extends(a,s),a.prototype.clear=function(){this.gravity=0,this.setXSpeed(0,0),this.setYSpeed(0,0),this.setAngularSpeed(0)},a.prototype.update=function(){if(this._on&&this.game.time.time>=this._timer&&(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,this._mode===e.FLOW))if(-1!==this._flowTotal&&this._flowCounter>=this._flowTotal)this.on=!1;else for(var t=Math.max(1,this._flowQuantity),i=0;t>i&&!(this.emitParticle(this.forceEmit)&&(this._flowCounter++,-1!==this._flowTotal&&this._flowCounter>=this._flowTotal));i++);for(var i=this._counterUsed-1;i>=0;i--){var s=this._particlesUsed[i];s.update()||(s.on=!1,s.remove(),s.onKill(this),this._particlesUsed[i]=this._particlesUsed[--this._counterUsed],this._particlesPool[this._counterPool++]=s)}},a.prototype.makeParticles=function(t,e,i,s){(void 0===i||i>this._maxParticles)&&(i=this._maxParticles),void 0!==e&&(this._frames=e);for(var a=0;i>a;a++){var o=new this.particleClass(this.game,s);o.textureKey=t,o.onCreate(this),o.on=!1,this._particlesPool[this._counterPool++]=o}},Object.defineProperty(a.prototype,"on",{set:function(t){this._on=t,this.exists=t,this.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"lifetime",{set:function(t){this.minLifetime=this.maxLifetime=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"count",{get:function(){return this._counterUsed},enumerable:!0,configurable:!0}),a.prototype.explode=function(t,i,s){this._mode=e.EXPLODE,this.on=!0,this.emitParticles(t,i,s)},a.prototype.flow=function(t,i,s,a,o,n){this._mode=e.FLOW,this.on=!0,(void 0===i||0===i)&&(i=1),void 0===s&&(s=-1),void 0===a&&(a=!0),i>this._maxParticles&&(i=this._maxParticles),this.frequency=t,this._flowCounter=0,this._flowQuantity=i,this._flowTotal=s,a&&(this.emitParticles(i,o,n),this._flowCounter+=i,this._timer=this.game.time.time+t*this.game.time.slowMotion)},a.prototype.stopFlow=function(){this._mode=e.NONE},a.prototype.killAllParticles=function(t){for(void 0===t&&(t=!0);this._counterUsed>0;){var e=this._particlesUsed[--this._counterUsed];e.remove(),t||e.onKill(this),this._particlesPool[this._counterPool++]=e}},a.prototype.emitParticles=function(t,e,i){for(var s=0;t>s;s++){var a=this.emitParticle(this.forceEmit);if(null===a)break;void 0!==e&&null!==e&&e.call(i,a)}},a.prototype.emitParticle=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),0===this._counterPool){if(!t)return null;var s=this._particlesUsed[0];this._particlesUsed[0]=this._particlesUsed[--this._counterUsed],s.remove(),s.onKill(this),this._particlesPool[this._counterPool++]=s}var a=this._particlesPool[--this._counterPool];if(this._particlesUsed[this._counterUsed++]=a,a.on=!0,this.randomEmitPoint(this._emitPoint),a.visual.position.set(this._emitPoint.x,this._emitPoint.y),a.visual.angle=0,e)a.lifetime=-1,a.visual.scale.set(1,1),a.setScaleChange(i.NO_CHANGE),a.visual.angle=0,a.alpha=1,a.setAlphaChange(i.NO_CHANGE),a.setPhysics();else{if(a.lifetime=this.game.rnd.realInRange(this.minLifetime,this.maxLifetime),1!==this.minParticleScale||1!==this.maxParticleScale){var o=this.game.rnd.realInRange(this.minParticleScale,this.maxParticleScale);a.visual.scale.set(o,o)}else this._minParticleScale.x!==this._maxParticleScale.x||this._minParticleScale.y!==this._maxParticleScale.y?a.visual.scale.set(this.game.rnd.realInRange(this._minParticleScale.x,this._maxParticleScale.x),this.game.rnd.realInRange(this._minParticleScale.y,this._maxParticleScale.y)):a.visual.scale.set(1,1);a.setScaleChange(this.scaleChangeType,this.scaleChange),a.visual.angle=this.minAngle===this.maxAngle?this.minAngle:this.game.rnd.realInRange(this.minAngle,this.maxAngle),a.alpha=this.game.rnd.realInRange(this.minParticleAlpha,this.maxParticleAlpha),a.setAlphaChange(this.alphaChangeType,this.alphaChange),a.setPhysics(this.game.rnd.realInRange(this.minParticleSpeed.x,this.maxParticleSpeed.x),this.game.rnd.realInRange(this.minParticleSpeed.y,this.maxParticleSpeed.y),this.game.rnd.realInRange(this.minAngularSpeed,this.maxAngularSpeed),this.particleFriction,this.angularDrag,this.gravity),null!==this._frames&&a.setFrame(this.randomFrame())}return a.onEmit(this),this.particleBringToTop?a.bringToTop():this.particleSendToBack&&a.sendToBack(),a},a.prototype.destroy=function(){t.ParticlesManager.instance.remove(this),s.prototype.destroy.call(this,!0,!1)},a.prototype.randomFrame=function(){var t=null;return null!==this._frames&&(t=Array.isArray(this._frames)?"string"==typeof this._frames[0]?this.game.rnd.pick(this._frames):this.game.rnd.pick(this._frames):this._frames),t},a.prototype.randomEmitPoint=function(t){return this.area instanceof Phaser.Point?t.setTo(0,0):this.area.random(t),t.x+=this.emitPoint.x,t.y+=this.emitPoint.y,null!==this.emitObject&&(t.x+=this.emitObject.x,t.y+=this.emitObject.y),t},a.prototype.setXSpeed=function(t,e){t=t||0,e=e||0,this.minParticleSpeed.x=t,this.maxParticleSpeed.x=e},a.prototype.setYSpeed=function(t,e){t=t||0,e=e||0,this.minParticleSpeed.y=t,this.maxParticleSpeed.y=e},a.prototype.setAngularSpeed=function(t,e){t=t||0,
e=e||0,this.minAngularSpeed=t,this.maxAngularSpeed=e},a.prototype.setAlpha=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this.minParticleAlpha=t,this.maxParticleAlpha=e},a.prototype.setAlphaChange=function(t,e,s){switch(void 0===e&&(e=0),void 0===s&&(s=0),this.alphaChangeType=t,t){case i.NO_CHANGE:this.alphaChange=0;break;case i.IN_TIME:0===s&&(s=1),this.alphaChange=e/s}},a.prototype.setScale=function(t,e,i,s){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===s&&(s=1),this._minParticleScale.setTo(t,i),this._maxParticleScale.setTo(e,s)},a.prototype.setScaleChange=function(t,e,s){switch(void 0===e&&(e=0),void 0===s&&(s=0),this.scaleChangeType=t,t){case i.NO_CHANGE:this.scaleChange=0;break;case i.IN_TIME:0===s&&(s=1),this.scaleChange=e/s}},a.prototype.setAngle=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.minAngle=t,this.maxAngle=e},a.prototype.emitAt=function(t,e){this.emitPoint.setTo(t,e)},a.prototype.emitAtObject=function(t){t.center?this.emitPoint.setTo(t.center.x,t.center.y):this.emitPoint.setTo(t.x,t.y)},a.MAX_PARTICELES=16,a}(Phaser.Group);t.ParticlesEmitter=s}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(){this._emitters=[],this._emittersCount=0}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this._emitters[this._emittersCount++]=t},t.prototype.remove=function(t){for(var e=this._emittersCount-1;e>=0&&this._emitters[e]!==t;e--);-1!==e&&(this._emitters[e]=this._emitters[--this._emittersCount])},t.prototype.update=function(){for(var t=0;t<this._emittersCount;t++){var e=this._emitters[t];e.exists&&e.update()}},t._instance=null,t}();t.ParticlesManager=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.setFrame=function(t){var e=this._visual;"string"==typeof t?e.frameName=t:e.frame=t},e.prototype.onCreate=function(t){var e=new Phaser.Sprite(this._game,0,0,this._textureKey);e.anchor.setTo(.5,.5),this._visual=e},e}(t.Particle);t.SpriteParticle=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),(void 0===i||null!==i)&&(this._anims=i[0])}return __extends(e,t),e.prototype.onCreate=function(e){t.prototype.onCreate.call(this,e);for(var i=this._visual,s=0;s<this._anims.length;s++){var a=this._anims[s];i.animations.add(a.name,a.frames,a.frameRate,a.loop);!a.loop&&a.killOnComplete&&(a.killOnComplete=!0)}},e.prototype.setAnim=function(t){var e=this._visual;e.animations.play(t)},e.prototype.setRandomAnim=function(){var t=(this._visual,this._anims[this._game.rnd.integerInRange(0,this._anims.length-1)].name);this.setAnim(t)},e}(t.SpriteParticle);t.AnimatedParticle=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(){}return t.SHARDS_PARTICLES=[{name:"shards1",frameRate:22,loop:!0,killOnComplete:!1,frames:["Shards_0","Shards_1","Shards_2","Shards_3","Shards_4","Shards_5","Shards_6","Shards_7","Shards_8","Shards_9","Shards_10","Shards_11","Shards_12","Shards_13","Shards_14","Shards_15","Shards_16","Shards_17","Shards_18","Shards_19"]},{name:"shards2",frameRate:22,loop:!0,killOnComplete:!1,frames:["Shards_20","Shards_21","Shards_22","Shards_23","Shards_24","Shards_25","Shards_26","Shards_27","Shards_28","Shards_29","Shards_30","Shards_31","Shards_32","Shards_33","Shards_34","Shards_35","Shards_36","Shards_37","Shards_38","Shards_39"]},{name:"shards3",frameRate:22,loop:!0,killOnComplete:!1,frames:["Shards_40","Shards_41","Shards_42","Shards_43","Shards_44","Shards_45","Shards_46","Shards_47","Shards_48","Shards_49","Shards_50","Shards_51","Shards_52","Shards_53","Shards_54","Shards_55","Shards_56","Shards_57","Shards_58","Shards_59"]}],t.EXPLOSIONS=[{name:"bigExplosion",frameRate:14,loop:!1,killOnComplete:!0,frames:["EXPLOSION_0","EXPLOSION_1","EXPLOSION_2","EXPLOSION_3","EXPLOSION_4","EXPLOSION_5","EXPLOSION_6","EXPLOSION_7","EXPLOSION_8"]},{name:"smallExplosion",frameRate:33,loop:!1,killOnComplete:!0,frames:["GUN_EXPLO_0","GUN_EXPLO_1","GUN_EXPLO_2","GUN_EXPLO_3","GUN_EXPLO_4","GUN_EXPLO_5","GUN_EXPLO_6","GUN_EXPLO_7","GUN_EXPLO_8","GUN_EXPLO_9","GUN_EXPLO_10","GUN_EXPLO_11","GUN_EXPLO_12","GUN_EXPLO_13"]},{name:"muzzle",frameRate:33,loop:!1,killOnComplete:!0,frames:["MUZZLE_0","MUZZLE_1","MUZZLE_2","MUZZLE_3","MUZZLE_4","MUZZLE_5"]}],t}();t.Animations=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a,o,n,r){e.call(this,s,a,o,n),this._text=r,this.scaleOnOver.set(i.SCALE,i.SCALE),t.Global.LOW?this.setHitArea(new Phaser.Rectangle(.4*i.HIT_AREA_OFFSET,.4*i.HIT_AREA_OFFSET,.4*i.HIT_AREA_WIDTH,.4*i.HIT_AREA_HEIGHT)):this.setHitArea(new Phaser.Rectangle(i.HIT_AREA_OFFSET,i.HIT_AREA_OFFSET,i.HIT_AREA_WIDTH,i.HIT_AREA_HEIGHT))}return __extends(i,e),i.prototype.overAction=function(){this._text.scale.copyFrom(this._button.scale)},i.prototype.outAction=function(){this._text.scale.copyFrom(this._button.scale)},i.HIT_AREA_OFFSET=-60,i.HIT_AREA_HEIGHT=120,i.HIT_AREA_WIDTH=350,i.SCALE=1.1,i}(UI.Button);t.ButtonWithText=e;var i=function(e){function i(s,a,o,n,r,h){e.call(this,s,a,o,n,r),this._text=h,this.scaleOnOver.set(i.SCALE,i.SCALE),t.Global.LOW?this.setHitArea(new Phaser.Rectangle(.4*i.HIT_AREA_OFFSET,.4*i.HIT_AREA_OFFSET,.4*i.HIT_AREA_WIDTH,.4*i.HIT_AREA_HEIGHT)):this.setHitArea(new Phaser.Rectangle(i.HIT_AREA_OFFSET,i.HIT_AREA_OFFSET,i.HIT_AREA_WIDTH,i.HIT_AREA_HEIGHT))}return __extends(i,e),i.prototype.overAction=function(){this._text.scale.copyFrom(this._button.scale)},i.prototype.outAction=function(){this._text.scale.copyFrom(this._button.scale)},i.HIT_AREA_OFFSET=-60,i.HIT_AREA_HEIGHT=120,i.HIT_AREA_WIDTH=350,i.SCALE=1.1,i}(UI.Toggle);t.ToggleWithText=i}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(i,s,a){t.call(this,i,s,a,"Flag_"+s),this.scaleOnOver.set(e.SCALE,e.SCALE)}return __extends(e,t),Object.defineProperty(e.prototype,"glow",{set:function(t){null!==t&&(this.add(t),this.bringToTop(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonName",{get:function(){return this._button.name},enumerable:!0,configurable:!0}),e.prototype.setFlag=function(t){var e="Flag_"+t;this._button.setFrames(e,e,e,e)},e.SCALE=1.1,e}(UI.Button);t.FlagButton=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s){e.call(this,s,null),this._backAdjustment=new Phaser.Point;var a=t.Global.LOW?.4:1;this._backText=new Phaser.BitmapText(s,0,0,"FontBack","",i.COMBO_TEXT_SIZE*a),this._backText.anchor.set(.5,.5),this.add(this._backText),this._glow=new Phaser.Sprite(s,0,0,"Game","GLOW"),this._glow.anchor.set(.5,.5),this.add(this._glow),this._frontText=new Phaser.BitmapText(s,0,0,"FontFore","",i.COMBO_TEXT_SIZE*a),this._frontText.anchor.set(.5,.5),this.add(this._frontText)}return __extends(i,e),i.prototype.init=function(t,e,s){var a="COMBO X"+s;this._backText.text=a,this._frontText.text=a,this._time=0;var o=this._frontText.textWidth;this._glow.position.set(t,e),this._glow.width=o<<1,this._glow.height=o>>1,this._glow.alpha=0,o*=.7215,t=Phaser.Math.clamp(t,-this.game.width/2+o,this.game.width/2-o),this._frontText.position.set(t,e),this._frontText.scale.set(.5,.5),this._frontText.alpha=0,this._backText.scale.set(1,1),this._backText.position.set(t+this.game.width/8,e),this._backAdjustment.set(t-this.game.width/8,e-this.game.height/80),this._backAdjustment.subtract(this._backText.position.x,this._backText.position.y),this._backAdjustment.divide(i.DURATION,i.DURATION)},i.prototype.tick=function(t){if((this._time+=t)>i.DURATION)return!1;var e=Math.sin(Phaser.Math.degToRad(180*this._time/i.DURATION));this._frontText.alpha=Math.min(1,1.3*e);var s=i.DURATION/2,a=this._time<s?.5+this._time/s*.5:1+(this._time-s)/s*.443;return this._frontText.scale.set(a,a),this._glow.position.copyFrom(this._frontText.position),this._glow.alpha=.5*this._frontText.alpha,this._backText.alpha=this._frontText.alpha/2,a=1+.314*this._time/i.DURATION,this._backText.scale.set(a,a),this._backText.position.add(this._backAdjustment.x*t,this._backAdjustment.y*t),!0},i.COMBO_TEXT_SIZE=44,i.DURATION=1,i}(Phaser.Group);t.Combo=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function e(t,e){this._game=t,this._board=e;var i=e.topParticlesGroup;this._shardExplosion=this.createShardsExplosion(),i.add(this._shardExplosion),this._shardsParticles=this.createShardsParticles(),i.add(this._shardsParticles),this._explosions=this.createExplosions(),i.add(this._explosions),this._general=this.createGeneral(),i.add(this._general)}return e.prototype.clear=function(){this._shardExplosion.killAllParticles(),this._shardsParticles.killAllParticles(),this._explosions.killAllParticles(),this._general.killAllParticles()},e.prototype.createShardsExplosion=function(){var i=new t.ParticlesEmitter(this._game,0,0,e.SHARDS_EXPLOSION_MAX);return i.clear(),i.setAlpha(1.28,1.28),i.makeParticles("Game","EXPLOSION_SHARDS"),i},e.prototype.shardsExplosion=function(e,i,s,a){this._shardExplosion.emitAt(e,i);var o=this._shardExplosion.emitParticle();null!==o&&(a?(o.visual.scale.set(.3*s,.3*s),o.setScaleChange(t.eParameterChangeType.IN_TIME,.8),o.setAlphaChange(t.eParameterChangeType.IN_TIME,-1.28),o.lifetime=1):(o.visual.scale.set(.2*s,.2*s),o.setScaleChange(t.eParameterChangeType.IN_TIME,1),o.setAlphaChange(t.eParameterChangeType.IN_TIME,-2.6),o.lifetime=.5))},e.prototype.createShardsParticles=function(){var i=new t.ParticlesEmitter(this._game,0,0,e.SHARDS_PARTICLES_MAX);return i.clear(),i.particleClass=t.AnimatedParticle,i.lifetime=2,i.setAlpha(2,2),i.setAlphaChange(t.eParameterChangeType.IN_TIME,-1.8,2),i.makeParticles("Game",null,e.SHARDS_PARTICLES_MAX,[t.Animations.SHARDS_PARTICLES]),i},e.prototype.shardsParticles=function(e,i,s,a,o,n){var r=this._game,h=o-a,l=a+r.rnd.integerInRange(0,h-1);t.Global.NO_ANIMS&&(l=Math.floor(l/2));for(var _=l;_>0;_--){var c=r.rnd.integerInRange(0,359),d=n*(8+r.rnd.integerInRange(0,23))*s,u=Math.cos(Phaser.Math.degToRad(c)),p=Math.sin(Phaser.Math.degToRad(c));this._shardsParticles.emitAt(e+n*u,i+n*p);var g=this._shardsParticles.emitParticle();null!==g&&(g.setPhysics(u*d,p*d),g.visual.scale.set(s,s),g.setRandomAnim())}},e.prototype.createExplosions=function(){var i=new t.ParticlesEmitter(this._game,0,0,e.EXPLOSIONS_MAX);return i.clear(),i.particleClass=t.AnimatedParticle,i.setAlpha(1,1),i.setScale(1,1),i.makeParticles("Game",null,e.EXPLOSIONS_MAX,[t.Animations.EXPLOSIONS]),i},e.prototype.muzzle=function(t,e){this._explosions.emitAt(t,e);var i=this._explosions.emitParticle();null!==i&&(i.lifetime=.25,i.visual.angle=0,i.setAnim("muzzle"))},e.prototype.smallExplosion=function(e,i){this._explosions.emitAt(e,i);var s=this._explosions.emitParticle();null!==s&&(s.lifetime=.45,s.setAlphaChange(t.eParameterChangeType.IN_TIME,-.35),s.setAnim("smallExplosion"))},e.prototype.bigExplosion=function(e,i){this._explosions.emitAt(e,i);var s=this._explosions.emitParticle();null!==s&&(s.lifetime=.7,s.visual.scale.set(2,2),s.alpha=2,s.setAlphaChange(t.eParameterChangeType.IN_TIME,-3),s.setAnim("bigExplosion"))},e.prototype.createGeneral=function(){var i=new t.ParticlesEmitter(this._game,0,0,e.GENERAL_MAX);return i.clear(),i.setAlpha(1,1),i.setScale(1,1),i.setAngle(0,0),i.makeParticles("Game"),i},e.prototype.bonus=function(e,i,s,a,o){this._general.emitAt(e,i);var n=this._general.emitParticle();null!==n&&(n.lifetime=1,n.setFrame(s),n.setPhysics(3*(e-a),3*(i-o),360*(e>a?1:-1)),n.setAlphaChange(t.eParameterChangeType.IN_TIME,-1),n.setScaleChange(t.eParameterChangeType.IN_TIME,4))},e.prototype.shockWave=function(e,i,s,a){this._general.emitAt(e,i);var o=this._general.emitParticle();null!==o&&(o.lifetime=.3,o.setFrame("SHOCKWAVE"),a?(o.visual.scale.set(s,s),o.setScaleChange(t.eParameterChangeType.IN_TIME,(-s+1)/.3),o.alpha=0,o.setAlphaChange(t.eParameterChangeType.IN_TIME,3.4)):(o.setScaleChange(t.eParameterChangeType.IN_TIME,s),o.setAlphaChange(t.eParameterChangeType.IN_TIME,-3.4)))},e.prototype.newBall=function(e,i){this._general.emitAt(e,i);var s=this._general.emitParticle();null!==s&&(s.lifetime=1,s.setFrame("BALL_NORMAL"),s.setScaleChange(t.eParameterChangeType.IN_TIME,4),s.setAlphaChange(t.eParameterChangeType.IN_TIME,-1))},e.prototype.numParticle=function(e,i,s){this._general.emitAt(e,i);var a=this._general.emitParticle();null!==a&&(a.lifetime=1.5,a.setFrame("FONT_YELLOW_"+s),a.visual.scale.set(.1,.1),a.setScaleChange(t.eParameterChangeType.IN_TIME,4),a.alpha=2,a.setAlphaChange(t.eParameterChangeType.IN_TIME,-1.5))},e.SHARDS_EXPLOSION_MAX=8,e.SHARDS_PARTICLES_MAX=48,e.EXPLOSIONS_MAX=16,e.GENERAL_MAX=16,e}();t.Emitters=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(e,i,s){t.call(this,e,0,0,i,s),this.onFadeFinished=new Phaser.Signal,this._fadeRunning=!1,this.width=e.width,this.height=e.height,this.anchor.setTo(.5,.5),this.exists=!1,this.visible=!1}return __extends(e,t),Object.defineProperty(e.prototype,"fade",{set:function(t){this.alpha=t,this.visible=t>0},enumerable:!0,configurable:!0}),e.prototype.isRunning=function(){return this._fadeRunning},e.prototype.fadeIn=function(t,i){if(void 0===t&&(t=e.FADE_TIME_IN),void 0===i&&(i=0),!this._fadeRunning){this.alpha=1,this.exists=!0,this.bringToTop(),this._fadeRunning=!0;var s=this.game.add.tween(this);s.to({alpha:0},t,Phaser.Easing.Sinusoidal.In,!0,i),s.onComplete.addOnce(function(){this.exist=!1,this.visible=!1,this._fadeRunning=!1,this.onFadeFinished.dispatch(!0)},this)}},e.prototype.fadeOut=function(t,i){if(void 0===t&&(t=e.FADE_TIME_OUT),void 0===i&&(i=0),!this._fadeRunning){this.alpha=0,this.exists=!0,this.visible=!0,this.bringToTop(),this._fadeRunning=!0;var s=this.game.add.tween(this);s.to({alpha:1},t,Phaser.Easing.Sinusoidal.Out,!0,i),s.onComplete.addOnce(function(){this.exist=!1,this._fadeRunning=!1,this.onFadeFinished.dispatch(!1)},this)}},e.FADE_TIME_IN=250,e.FADE_TIME_OUT=250,e}(Phaser.Sprite);t.Fader=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a,o){e.call(this,s,a);var n=t.Global.GAME_WIDTH,r=t.Global.LOW?.4:1;this._scoreY=-s.height/2+i.Y_OFFSET*r,this._board=o,this._livesText=new Phaser.BitmapText(s,0,0,"FontFore","",i.FONT_LIFE_SIZE*r),this._livesText.anchor.set(0,.5),this.add(this._livesText),this._xText=new Phaser.BitmapText(s,0,0,"FontFore","X",i.FONT_X_SIZE*r),this._xText.anchor.set(0,.5),this.add(this._xText),this._ball=new Phaser.Sprite(s,0,0,"Game","BALL_NORMAL"),this._ball.anchor.set(.5,.5),this.add(this._ball),this.lives=0;var h=s.cache.getFrameByName("Game","PAUSE");this._pauseButton=new UI.Button(s,"Pause","Game","PAUSE"),this._pauseButton.setHitArea(new Phaser.Circle(0,0,150*r)),this._pauseButton.offsetOnDown.set(0,3),this._pauseButton.scaleOnOver.set(1.1,1.1),this._pauseButton.onClick.add(o.onPause,o),this._pauseButton.position.set(n/2-i.X_OFFSET*r-h.width/2,this._scoreY),this.add(this._pauseButton),this._score=this._scoreBase=this._currentScore=0,this._scoreTime=0,this._scoreText=new Phaser.BitmapText(s,n/2-i.X_OFFSET*r-1.4*h.width,this._scoreY,"FontFore","0000000000",i.FONT_LIFE_SIZE*r),this._scoreText.anchor.set(1,.5),this.add(this._scoreText);var l=s.add.group(this),_=new t.AnchoredSprite(s,0,0,"Game","TROPHY_GLOW");_.scale.set(1.8,1.8),this._glow=_,l.add(_);var c=new t.AnchoredSprite(s,0,0,"Game","TROPHY");l.add(c),this._trophyTweenAlpha=s.add.tween(l).to({alpha:1},t.Settings.BEST_ANIM_TIME,Phaser.Easing.Linear.None,!1),this._trophyTweenScale=s.add.tween(l.scale).to({x:1,y:1},t.Settings.BEST_ANIM_TIME,Phaser.Easing.Linear.None,!1),this._glowTweenRotate=s.add.tween(_).to({angle:0},t.Settings.BEST_ANIM_TIME,Phaser.Easing.Linear.None,!1),l.position.set(0,this._scoreY),l.visible=!1,this._trophyGroup=l}return __extends(i,e),Object.defineProperty(i.prototype,"ball",{get:function(){return this._ball},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lives",{set:function(e){this._livesText.text=""+e;var s=t.Global.GAME_WIDTH,a=t.Global.LOW?.4:1,o=-s/2+i.X_OFFSET*a;this._livesText.position.set(o,this._scoreY),o+=this._livesText.textWidth,this._xText.position.set(o,this._scoreY+7*a),o+=this._xText.textWidth,this._ball.position.set(o+.65*t.Settings.BALL_DIAMETER,this._scoreY)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"score",{set:function(t){this._score=t,this._scoreBase=this._currentScore,this._scoreTime=i.SCORE_TIME},enumerable:!0,configurable:!0}),i.prototype.changeImmediately=function(){this._scoreTime=0,this._scoreText.text=Utils.StringUtils.padNumber(this._score,10)},i.prototype.update=function(){if(this._scoreTime>0){this._scoreTime=Math.max(0,this._scoreTime-this.game.time.physicsElapsed);var t=1-this._scoreTime/i.SCORE_TIME;this._currentScore=Math.floor(Phaser.Math.linear(this._scoreBase,this._score,t)),this._scoreText.text=Utils.StringUtils.padNumber(this._currentScore,10)}},i.prototype.makeTrophyVisible=function(){this._trophyGroup.visible=!0},i.prototype.onNewHiScore=function(){Utils.AudioUtils.playSound(t.Sfx.SWOOSH),this._glow.angle=-90,this._trophyGroup.scale.set(t.Settings.BEST_ANIM_TROPHY_SCALE,t.Settings.BEST_ANIM_TROPHY_SCALE),this._trophyGroup.alpha=0,this._trophyGroup.visible=!0,this._trophyTweenAlpha.start(),this._trophyTweenScale.start(),this._glowTweenRotate.start()},i.FONT_LIFE_SIZE=36,i.FONT_X_SIZE=22,i.Y_OFFSET=38,i.X_OFFSET=20,i.SCORE_TIME=1,i}(Phaser.Group);t.GUI=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a){e.call(this,s),this._level=a;var o=t.Global.levelStats[a],n=t.Global.LOW?.4:1;this._glassHeight=s.cache.getFrameByName("GUI","LEVEL_GLASS").height,this._glassWidth=s.cache.getFrameByName("GUI","LEVEL_GLASS").width,this._bg=s.add.sprite(0,this._glassHeight/2,"GUI","LEVEL_GLASS",this),this._bg.anchor.set(.5,.5),(o.unlocked||t.Global.unlockLevels)&&(this._bg.inputEnabled=!0);var r;r=o.unlocked||t.Global.unlockLevels?s.cache.getFrameByName("GUI","LEVEL_ICONS").index+a:"LEVEL_LOCKED",s.add.sprite(-this._glassWidth/2+i.ICON_OFFSET_X*n,i.ICON_OFFSET_Y*n,"GUI",r,this),(o.unlocked||t.Global.unlockLevels)&&(s.add.bitmapText(-this._glassWidth/2+i.TEXT_OFFSET*n,i.LEVEL_NAME_OFFSET*n,"Font",Utils.TextUtils.getText("TXT_LEVEL_"+a),i.TEXT_SIZE*n,this),s.add.bitmapText(-this._glassWidth/2+i.TEXT_OFFSET*n,i.BEST_TIME_OFFSET*n,"Font",Utils.TextUtils.getText("TXT_BEST_TIME")+Utils.StringUtils.formatTime(o.time,1,2),i.TEXT_SIZE*n,this));for(var h=0;3>h;h++){var l=s.add.sprite(-this._glassWidth/2+i.STARS_OFFSET_X*n+h*i.STARS_STEP*n,i.STARS_OFFSET_Y*n,"GUI",(o.unlocked||t.Global.unlockLevels)&&h<o.stars?"LEVEL_STAR_ACHIEVED":"STAR_EMPTY",this);l.anchor.set(.5,.5)}}return __extends(i,e),Object.defineProperty(i.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),i.prototype.addInputCallback=function(t,e){this._bg.events.onInputUp.add(t,e),this._bg.events.onInputOver.add(function(){this._bg.scale.x=1.02,this._bg.scale.y=1.05},this),this._bg.events.onInputOut.add(this.unscale,this)},i.prototype.unscale=function(){this._bg.scale.x=1,this._bg.scale.y=1},i.prototype.clearInput=function(){for(var t=0;2>t;t++){var e=this._bg.input._pointerData[t];e.id=t,e.x=0,e.y=0,e.isDown=!1,e.isUp=!1,e.isOver=!1,e.isOut=!1,e.timeOver=0,e.timeOut=0,e.timeDown=0,e.timeUp=0,e.downDuration=0,e.isDragged=!1}},i.ICON_OFFSET_X=9,i.ICON_OFFSET_Y=6,i.TEXT_SIZE=36,i.TEXT_OFFSET=135,i.LEVEL_NAME_OFFSET=19,i.BEST_TIME_OFFSET=56,i.STARS_OFFSET_X=523,i.STARS_OFFSET_Y=55,i.STARS_STEP=80,i}(Phaser.Group);t.IconLevel=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a,o){e.call(this,s,a);var n=t.Global.LOW?.4:1;this._board=o;var r=new UI.Button(s,"Cancel","GUI","BUTTON_CANCEL");r.position.set(-i.BUTTON_OFFSET*n,0),r.scaleOnOver.set(i.SCALE,i.SCALE),r.onClick.add(o.parent.onExit,o.parent),this.add(r),this._buttonExit=r;var h=new UI.Button(s,"Continue","GUI","BUTTON_CONTINUE");h.position.set(i.BUTTON_OFFSET*n,0),h.scaleOnOver.set(i.SCALE,i.SCALE),h.onClick.add(o.onUnpause,o),this.add(h),this._buttonContinue=h;var l=-60*n,_=120*n,c=new UI.Toggle(s,"Music","GUI","ICON_MUSIC_OFF","ICON_MUSIC_ON");c.changeOnDown=!1,c.position.set(-i.TOGGLE_OFFSET*n,0),c.scaleOnOver.set(i.SCALE,i.SCALE),c.setHitArea(new Phaser.Rectangle(l,l,_,_)),c.onClick.add(function(e){t.Global.musicOn=e.toggled,t.Global.musicOn?this._board.parent.playMusic():Utils.AudioUtils.stopMusic()},this),c.toggled=t.Global.musicOn,this.add(c),this._toggleMusic=c;var d=new UI.Toggle(s,"Sound","GUI","ICON_SOUND_OFF","ICON_SOUND_ON");if(d.changeOnDown=!1,d.position.set(i.TOGGLE_OFFSET*n,0),d.scaleOnOver.set(i.SCALE,i.SCALE),d.setHitArea(new PIXI.Rectangle(l,l,_,_)),d.onClick.add(function(e){t.Global.soundOn=e.toggled},this),d.toggled=t.Global.soundOn,this.add(d),this._toggleSound=d,t.Global.fullscreenOption){var u=new UI.Toggle(s,"FullScreen","GUI","FULLSCREEN_OFF","FULLSCREEN_ON");u.position.set(340*n,-s.height/2+60*n),u.scaleOnOver.set(1.1,1.1),u.onClick.add(function(t){Utils.FullscreenUtils.changeFullscreen()},this),u.toggled=Utils.FullscreenUtils.isFullscreen(),this.add(u),this._toggleFullscreen=u}if(5===t.Global.sponsor.id){var p=this.game.add.button(0,0,"Logo",function(){Utils.AudioUtils.playSound(t.Sfx.CLICK),window.open("http://www.addictinggames.com","_blank")},this);p.position.set(0,.4*-this.game.height),p.anchor.setTo(.5,.5),p.scale.setTo(.75*n,.75*n),this.add(p)}}return __extends(i,e),i.prototype.onFullscreenChange=function(e){t.Global.fullscreenOption&&(this._toggleFullscreen.toggled=e)},i.BUTTON_OFFSET=250,i.TOGGLE_OFFSET=80,i.SCALE=1.1,i}(Phaser.Group);t.InGameMenu=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(){this.unlocked=!1,this.time=0,this.stars=0}return t}();t.LevelStats=e}(Shards||(Shards={}));var Shards;!function(t){!function(t){t[t.OBJECT_BRICK=1]="OBJECT_BRICK",t[t.OBJECT_BALL=2]="OBJECT_BALL",t[t.OBJECT_PADDLE=4]="OBJECT_PADDLE",t[t.OBJECT_ENEMY=8]="OBJECT_ENEMY",t[t.OBJECT_MISSILE=16]="OBJECT_MISSILE",t[t.OBJECT_BORDER=32]="OBJECT_BORDER",t[t.OBJECT_BOTTOM_BORDER=64]="OBJECT_BOTTOM_BORDER",t[t.OBJECT_BONUS=128]="OBJECT_BONUS"}(t.eObjectType||(t.eObjectType={}));t.eObjectType}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function t(){}return t.prototype.clearStat=function(){this.combosValue=0,this.paddleHits=0,this.totalHitpoints=0,this.bricksToBreak=0,this.clearEmptyHits(),this.bricksWinCount=0,this.bricksUnbreakable=0},t.prototype.clearEmptyHits=function(){this.emptyHits=0,this.noHitTime=0,this.emptyHitCounter=0},t}();t.BoardStats=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(e,i,s,a,o){t.call(this,e,i,s,a),void 0!==o&&this.setAnchoredFrame(o)}return __extends(e,t),e.prototype.setAnchoredFrame=function(t){if("string"==typeof this.key){var e=null;"string"==typeof t?(this.frameName=t,e=this.game.cache.getFrameByName(this.key,t)):(this.frame=t,e=this.game.cache.getFrameByIndex(this.key,t)),void 0!==e.anchorX&&void 0!==e.anchorY&&this.anchor.setTo(e.anchorX,e.anchorY)}},e}(Phaser.Sprite);t.AnchoredSprite=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),(void 0===i||null!==i)&&(this._parent=i[0])}return __extends(e,t),e.prototype.onEmit=function(t){this._parent.add(this._visual)},e}(t.SpriteParticle);t.OtherParentParticle=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function e(){this.onNewHiScore=new Phaser.Signal,this._score=0,this._hiScore=0,this._newBest=!1,this.clear()}return e.prototype.clear=function(){this._hiScore=t.Global.hiScore,this._score=0,this._newBest=!1},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},set:function(e){this._score=e,this._newBest=e>=t.Global.hiScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hiScore",{get:function(){return this._hiScore},enumerable:!0,configurable:!0}),e.prototype.addScore=function(t){this._score+=Math.floor(t),this.isNewHiScore()&&(this._hiScore=this._score,this._newBest||(this._newBest=!0,this.onNewHiScore.dispatch()))},e.prototype.isNewHiScore=function(){return this._score>this._hiScore},e}();t.Score=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a,o,n,r){e.call(this,s),this._scale=1,t.Global.LOW&&(this._scale=.4),this._text=new Phaser.BitmapText(s,i.TEXT_OFFSET*this._scale,0,"Font",Utils.TextUtils.getText(r),i.TEXT_SIZE*this._scale),this._text.anchor.set(0,.5),this.add(this._text),this._toogle=new UI.Toggle(s,"difficulty_"+a,"GUI",o,n),this._toogle.difficulty=a,this._toogle.scaleOnOver.set(1.1,1.1),this.add(this._toogle),t.Global.difficulty===a&&(this._toogle.toggled=!0)}return __extends(i,e),Object.defineProperty(i.prototype,"toggle",{get:function(){return this._toogle},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"iconWidth",{get:function(){return i.TEXT_OFFSET*this._scale+this._text.textWidth},enumerable:!0,configurable:!0}),i.TEXT_OFFSET=65,i.TEXT_SIZE=36,i}(Phaser.Group);t.IconSpeed=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(t,i,s,a,o,n){e.call(this,t,s,a,o,n),this._shadow=null,this._board=i}return __extends(i,e),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shadow",{get:function(){return this._shadow},set:function(t){this._shadow=t},enumerable:!0,configurable:!0}),i.prototype.updateShadowPosition=function(){null!==this._shadow&&this._shadow.visible&&(this._shadow.position.set(this.position.x+t.Settings.SHADOW_OFFSET_X,this.position.y+t.Settings.SHADOW_OFFSET_Y),this._type===t.eObjectType.OBJECT_PADDLE?(this._shadow.scale.copyFrom(this.scale),this._shadow.angle=this.angle):this._type===t.eObjectType.OBJECT_ENEMY&&(this._shadow.angle=this.angle))},i.prototype.setActive=function(e){this.visible=e,this.exists=e;var i=this.body;i.data.SetActive(e),null!==this._shadow&&(e?(this._type===t.eObjectType.OBJECT_ENEMY?this._board.bricksGroup.add(this._shadow):this._board.shadowsGroup.add(this._shadow),this.updateShadowPosition()):this._type===t.eObjectType.OBJECT_ENEMY?this._board.bricksGroup.remove(this._shadow):this._board.shadowsGroup.remove(this._shadow))},i.prototype.setPosition=function(t,e){var i=this.body;i.x=t,i.y=e},i.prototype.setVelocity=function(t,e){var i=this.body;i.velocity.x=t,i.velocity.y=e},i.prototype.getVelocity=function(t){var e=this.body;return t.x=e.velocity.x,t.y=e.velocity.y,t},i.prototype.setAngle=function(t){var e=this.body;e.angle=0},i}(t.AnchoredSprite);t.SpriteWithShadow=e;var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.postUpdate=function(){t.prototype.postUpdate.call(this),this.updateShadowPosition()},e}(e);t.SpriteWithUpdatableShadow=i}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(i,s,a,o,n,r,h){e.call(this,i,s,a,o,"Game","BRICK_NORMAL"),this.id=0,this._type=t.eObjectType.OBJECT_BRICK,this.shadow=new t.AnchoredSprite(i,0,0,"Game"),this.set(h),this.scale.set(n,n),i.physics.box2d.enable(this);var l=this.body,_=this.game.cache.getFrameByName("Game","BRICK_NORMAL");l.setRectangle(_.width*n,_.height*n),l.angle=360-r,l["static"]=!0,l.data.SetUserData(this),l.setCollisionCategory(t.eObjectType.OBJECT_BRICK),l.setCollisionMask(t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_ENEMY+t.eObjectType.OBJECT_MISSILE),l.setCategoryContactCallback(t.eObjectType.OBJECT_BALL,this.onCollisionBall,this),this._shadow.angle=360-r,this._shadow.scale.set(n,n),this.setActive(!0)}return __extends(i,e),Object.defineProperty(i.prototype,"toBeDestroyed",{get:function(){return this._toBeDestroyed},set:function(t){this._toBeDestroyed=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"unbreakable",{get:function(){return this._unbreakable},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"canShine",{get:function(){return!this._unbreakable&&this._hitPoints===this._hitPointsMax},enumerable:!0,configurable:!0}),i.prototype.set=function(t){this._brickType=t&i.MASK_TYPE,this._unbreakable=(t&i.MASK_UNBREAKABLE)>0,this.hitPoints=(t&i.MASK_HP)>>8,this._toBeDestroyed=!1,this._colored=(t&i.MASK_COLORED)>0,this._unbreakable||this._board.addTotalHitPoints(this._hitPoints),this._colored,this.setFrameImage()},Object.defineProperty(i.prototype,"hitPoints",{set:function(t){this._hitPointsMax=t,this._hitPoints=t},enumerable:!0,configurable:!0}),i.prototype.hit=function(e){if(!this._toBeDestroyed){var i=this._board;return this._unbreakable?(i.addEmptyHit(),Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.UNBREAKABLE_HIT_1,t.Sfx.UNBREAKABLE_HIT_2)),!1):(i.clearEmptyHit(),this._hitPoints-=e,this._toBeDestroyed=this._hitPoints<=0,this._toBeDestroyed||(i.shardsExplosion(this.x,this.y,this.scale.x,!1),i.addScore(t.Settings.SCORE_NOT_DESTROYED),this.setFrameImage()),this._toBeDestroyed)}},i.prototype.setFrameImage=function(){var t=this._brickType,e=this.game.cache.getFrameByName("Game","BRICK_SHADOW").index;if(this._unbreakable)t+=i.UNBREAKABLE_BASE;else{var s=i.kBrickPhases[this._hitPointsMax-1][this._hitPointsMax-this._hitPoints];t=5*t+s+i.NORMAL_BASE,e+=i.kBrickPhases[this._hitPointsMax-1][this._hitPointsMax-this._hitPoints]}this.frame=t,this._shadow.setAnchoredFrame(e),this.updateShadowPosition()},i.prototype.onCollisionBall=function(t,e,i,s,a,o){if(a){var n=e.sprite;n.setHit(o),this.hit(1)?n.addComboEvent(1):n.clearComboStates()}},i.MASK_COLORED=2048,i.MASK_UNBREAKABLE=4096,i.MASK_DARK=8192,i.MASK_HP=1792,i.MASK_ANGLE_BIT=32768,i.MASK_TYPE=255,i.kBrickPhases=[[0,0,0,0,0],[0,4,0,0,0],[0,3,4,0,0],[0,2,3,4,0],[0,1,2,3,4]],i}(t.SpriteWithShadow);t.Brick=e}(Shards||(Shards={}));var Shards;!function(t){!function(t){t[t.NO_CANNON=0]="NO_CANNON",t[t.ON=1]="ON",t[t.ON_RUNNING=2]="ON_RUNNING",t[t.OFF=3]="OFF",t[t.ACTIVE=4]="ACTIVE"}(t.eCannonState||(t.eCannonState={}));var e=t.eCannonState,i=function(i){function s(e,s,a,o){i.call(this,e,s,a,o,"Game","PADDLE"),this._scaledData=[],this._overlayTime=0,this._cannonTime=0;var n=t.Global.LOW?.4:1;this._type=t.eObjectType.OBJECT_PADDLE,e.physics.box2d.enable(this),this._currentScale=t.Settings.PADDLE_SIZE_NORMAL,this._targetScale=this._currentScale,this.setSize(this._currentScale),this._overlayOut=new t.AnchoredSprite(e,0,0,"Game"),this._overlayOut.visible=!1,this.addChild(this._overlayOut),this._overlayIn=new t.AnchoredSprite(e,0,0,"Game"),this._overlayIn.visible=!1,this.addChild(this._overlayIn);var r=new t.AnchoredSprite(e,0,0,"Game");r.anchor.set(.5,1),r.position.set(-t.Settings.CANNON_OFFSET,15*n),r.animations.add("cannon_on",t.Settings.CANNON_ON_ANIMATION,20),r.animations.add("cannon_off",t.Settings.CANNON_OFF_ANIMATION,20),r.visible=!1,this.addChild(r),this._leftCannon=r,r=new t.AnchoredSprite(e,0,0,"Game"),r.anchor.set(.5,1),r.position.set(t.Settings.CANNON_OFFSET,15*n),r.animations.add("cannon_on",t.Settings.CANNON_ON_ANIMATION,20),r.animations.add("cannon_off",t.Settings.CANNON_OFF_ANIMATION,20),r.visible=!1,this.addChild(r),this._rightCannon=r,this.shadow=new t.AnchoredSprite(e,0,0,"Game","PADDLE_SHADOW"),this.setActive(!0)}return __extends(s,i),Object.defineProperty(s.prototype,"cannonReady",{get:function(){return this._cannonOn&&this._cannonState===e.ACTIVE},enumerable:!0,configurable:!0}),s.prototype.setSize=function(e,i){if(void 0===i&&(i=!0),this.scale.set(e,1),i){for(var a=t.Global.LOW?.4:1,o=0;o<s.PADDLE_DATA.length;o+=2)this._scaledData[o]=s.PADDLE_DATA[o]*e*a,this._scaledData[o+1]=s.PADDLE_DATA[o+1]*a;var n=this.body;n.setPolygon(this._scaledData),n.mass=10,n.friction=.4,n.restitution=0,n.fixedRotation=!0,n.setCollisionCategory(t.eObjectType.OBJECT_PADDLE),n.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_ENEMY+t.eObjectType.OBJECT_BONUS)}},s.prototype.updateScale=function(e){if(this._currentScale!==this._targetScale){var i=this._currentScale;this._currentScale<this._targetScale?this._currentScale=Math.min(this._currentScale+t.Settings.PADDLE_CHANGE_SPEED*e,this._targetScale):this._currentScale=Math.max(this._currentScale-t.Settings.PADDLE_CHANGE_SPEED*e,this._targetScale);
var s=Math.floor(10*i)-Math.floor(10*this._currentScale)!==0||this._currentScale===this._targetScale;this.setSize(this._currentScale,s)}},s.prototype.tick=function(i){if(this.updateOverlay(i),this._cannonOn){var s=this._leftCannon.animations.currentAnim.isFinished;switch(this._cannonState){case e.ON_RUNNING:return void(s&&(this._cannonState=e.ACTIVE));case e.ACTIVE:return void((this._cannonTime-=i)<=0&&(this._cannonState=e.OFF,this._leftCannon.animations.play("cannon_off"),this._rightCannon.animations.play("cannon_off"),Utils.AudioUtils.playSound(t.Sfx.CANNON_OFF)));case e.OFF:return void(s&&this.cancelCannon());case e.ON:case e.NO_CANNON:}}this.updateScale(i),this._currentScale===this._targetScale&&this._cannonOn&&this._cannonState===e.ON&&(this._cannonState=e.ON_RUNNING)},s.prototype.setNormalSize=function(){this.setScale(t.Settings.PADDLE_SIZE_NORMAL)},s.prototype.shrink=function(){this._targetScale!==t.Settings.PADDLE_SIZE_SMALL&&(this._targetScale===t.Settings.PADDLE_SIZE_NORMAL?this.setScale(t.Settings.PADDLE_SIZE_SMALL):this.setScale(t.Settings.PADDLE_SIZE_NORMAL))},s.prototype.enlarge=function(){this._targetScale!==t.Settings.PADDLE_SIZE_BIG&&(this._targetScale===t.Settings.PADDLE_SIZE_SMALL?this.setScale(t.Settings.PADDLE_SIZE_NORMAL):this.setScale(t.Settings.PADDLE_SIZE_BIG))},s.prototype.setCannon=function(i){i?(this.setNormalSize(),this._cannonOn||(this._cannonOn=!0,this._cannonState=e.ON,this._leftCannon.visible=!0,this._leftCannon.animations.play("cannon_on"),this._rightCannon.visible=!0,this._rightCannon.animations.play("cannon_on"),Utils.AudioUtils.playSound(t.Sfx.CANNON_ON)),this._cannonTime=t.Settings.CANNON_DURATION):this._cannonTime=0},s.prototype.cancelCannon=function(){this._cannonState=e.NO_CANNON,this._cannonOn=!1,this._leftCannon.visible=!1,this._rightCannon.visible=!1,this._cannonTime=0},Object.defineProperty(s.prototype,"cannonTime",{get:function(){return this._cannonTime},enumerable:!0,configurable:!0}),s.prototype.setScale=function(t){this._cannonOn&&(this._cannonTime=0,this._cannonState===e.ON&&(this._cannonOn=!1)),this._targetScale!==t&&(this._targetScale=t)},s.prototype.isCannonReady=function(){return this._cannonOn&&this._cannonState===e.ACTIVE},s.prototype.updateOverlay=function(e){var i=null;this._board.isFastTime()?i="PADDLE_FIRE":this._board.isSlowTime()?i="PADDLE_FROST":this._board.isStickTime()?i="PADDLE_STICKY":this._board.isPowerTime()&&(i="PADDLE_POWER");var s=null===i?0:this.game.cache.getFrameByName("Game",i).index;if(s!==this._overlayIn.frame){this._overlayTime=t.Settings.PADDLE_OVERLAY_TIME;var a=this._overlayIn.frame;this._overlayOut.setAnchoredFrame(a),this._overlayOut.visible=0!==a,this._overlayIn.setAnchoredFrame(s),this._overlayIn.visible=0!==s}if(this._overlayTime>0){this._overlayTime=Math.max(this._overlayTime-e,0);var o=this._overlayTime/t.Settings.PADDLE_OVERLAY_TIME;this._overlayOut.visible&&(this._overlayOut.alpha=o),this._overlayIn.visible&&(this._overlayIn.alpha=1-o),0===this._overlayTime&&(this._overlayOut.visible=!1)}},s.PADDLE_DATA=[0,0,-82,0,-79,-11,-68,-20,-42,-29,-23,-32,0,-32,23,-32,42,-29,68,-20,79,-11,82,0],s}(t.SpriteWithUpdatableShadow);t.Paddle=i}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a){e.call(this,s,a,500,0,"Game","BALL_NORMAL"),this._stickPosition=new Phaser.Point,this._lastVelocity=new Phaser.Point,this._lastPosition=new Phaser.Point,this._weldJoint=null,this._hitPoint=new Phaser.Point,this._comboQueue=[],this._pt=new Phaser.Point,this._type=t.eObjectType.OBJECT_BALL,s.physics.box2d.enable(this);var o=this.body;if(o.setCircle(t.Settings.BALL_DIAMETER/2),o.mass=.47,o.friction=0,o.restitution=1,o.bullet=!0,o.setCollisionCategory(t.eObjectType.OBJECT_BALL),o.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_PADDLE+t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_BRICK+t.eObjectType.OBJECT_ENEMY+t.eObjectType.OBJECT_BOTTOM_BORDER),o.setCategoryContactCallback(t.eObjectType.OBJECT_BORDER,this.onCollisionBorder,this),o.setCategoryContactCallback(t.eObjectType.OBJECT_BOTTOM_BORDER,this.onCollisionBottomBorder,this),o.setCategoryContactCallback(t.eObjectType.OBJECT_PADDLE,this.onCollisionPaddle,this),o.setCategoryContactCallback(t.eObjectType.OBJECT_BALL,this.onCollisionBall,this),o.setCategoryPresolveCallback(t.eObjectType.OBJECT_BRICK,this.onPresolveBrick,this),o.setCategoryPresolveCallback(t.eObjectType.OBJECT_ENEMY,this.onPresolveBrick,this),this.setActive(!1),!t.Global.NO_ANIMS){var n=.5*this._board.speedCoef,r=new t.ParticlesEmitter(s,0,0,i.BOTTOM_PARTICLES_MAX);r.clear(),r.particleClass=t.OtherParentParticle,r.lifetime=n,r.setScaleChange(t.eParameterChangeType.IN_TIME,-.9,1),r.setAlpha(.5,.5),r.setAlphaChange(t.eParameterChangeType.IN_TIME,-1,1),r.makeParticles("Game","BALL_PTC_NORMAL",i.BOTTOM_PARTICLES_MAX,[this._board.ballLowParticlesGroup]),this.addChild(r),this._bottomEmitter=r,r=new t.ParticlesEmitter(s,0,0,i.BOTTOM_PARTICLES_MAX),r.clear(),r.particleClass=t.OtherParentParticle,r.lifetime=n,r.setAngle(0,360),r.makeParticles("Game",null,i.BOTTOM_PARTICLES_MAX,[this._board.ballTopParticlesGroup]),this.addChild(r),this._topEmitter=r}this._nextParticleTime=0,this.shadow=new t.AnchoredSprite(s,0,0,"Game","BALL_SHADOW"),this.clearComboStates()}return __extends(i,e),Object.defineProperty(i.prototype,"sticked",{get:function(){return this._sticked},enumerable:!0,configurable:!0}),i.prototype.setStickPosition=function(t,e){this._stickPosition.set(t,e)},Object.defineProperty(i.prototype,"dead",{get:function(){return this._dead},set:function(t){this._dead=t},enumerable:!0,configurable:!0}),i.prototype.clear=function(){null!==this._weldJoint&&(this.game.physics.box2d.world.DestroyJoint(this._weldJoint),this._weldJoint=null),this.dead=!1,this._doStick=!1,this._sticked=!1,this._hitOccured=!1;var e=this.body;this._lastPosition.set(e.x,e.y),t.Global.NO_ANIMS||(this._bottomEmitter.killAllParticles(),this._topEmitter.killAllParticles())},i.prototype.setSticked=function(e){if(this._lastVelocity.set(0,0),this._lastVelocityCounter=0,!e||!this._sticked){var i=this.body;if(e){i.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_PADDLE+t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_BRICK),i.setZeroVelocity(),i.setZeroRotation(),i.angle=0,i.x=this._stickPosition.x,i.y=this._stickPosition.y,null!==this._weldJoint&&(this.game.physics.box2d.world.DestroyJoint(this._weldJoint),this._weldJoint=null);var s=this._board.paddle;this._weldJoint=this.game.physics.box2d.weldJoint(s,this,i.x-s.body.x,i.y-s.body.y,0,0)}else i.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_PADDLE+t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_BRICK+t.eObjectType.OBJECT_ENEMY+t.eObjectType.OBJECT_BOTTOM_BORDER),null!==this._weldJoint&&(this.game.physics.box2d.world.DestroyJoint(this._weldJoint),this._weldJoint=null);this._sticked=e,e||this._lastPosition.set(this.x,this.y)}},i.prototype.tick=function(e){var i=this._board;this.game;this.processComboQueue(e),this._doStick&&(this.setSticked(!0),this._doStick=!1);var s=i.speed;i.isSlowTime()?s*=t.Settings.SPEED_SLOW_RATE:i.isFastTime()&&(s*=t.Settings.SPEED_FAST_RATE);var a=s*s,o=this.getVelocity(this._pt).getMagnitudeSq();if(!this._sticked&&Math.abs(o-a)>2&&(0===this._pt.x&&0===this._pt.y&&this._pt.set(1,1),this._pt.setMagnitude(s),this.setVelocity(this._pt.x,this._pt.y)),t.Global.NO_ANIMS||this.tickParticles(e),this._hitOccured&&!this._sticked){var n=!1,r=this.getVelocity(this._pt),h=Math.abs(r.x),l=Math.abs(r.y),_=Math.abs(this._lastVelocity.x),c=Math.abs(this._lastVelocity.y),d=Math.abs(h-_),u=Math.abs(l-c);if(.05>d&&.05>u?++this._lastVelocityCounter>10&&(this._lastVelocityCounter=0,0===this.game.rnd.integerInRange(0,1)?r.x*=2:r.y*=2,n=!0,this._lastVelocity.set(0,0)):(this._lastVelocity.copyFrom(r),this._lastVelocityCounter=0),r.normalize(),Math.abs(r.x)<.1){_=r.x;var p=Phaser.Math.sign(_);0===p&&(p=0==this.game.rnd.integerInRange(0,1)?-1:1),r.x=Math.sin(Phaser.Math.degToRad(15))*p,n=!0}else if(Math.abs(r.y)<.1){c=r.y;var p=Phaser.Math.sign(c);0===p&&(p=0==this.game.rnd.integerInRange(0,1)?-1:1),r.y=Math.sin(Phaser.Math.degToRad(15))*p,n=!0}n&&this.setVelocity(r.x,r.y)}this._hitOccured=!1},i.prototype.tickParticles=function(t){this._bottomEmitter.update(),this._topEmitter.update(),this.trailParticle(t),this._hitOccured&&this.hitParticle()},i.prototype.trailParticle=function(e){var i=this._board.activeBonus,s=t.Settings.BALL_DIAMETER/4;if(!this._sticked){var a=this._pt;if(a.set(this.x,this.y),a.subtract(this._lastPosition.x,this._lastPosition.y),a.getMagnitudeSq()<s*s)return;var o=Math.floor(a.getMagnitude()/s);a.setMagnitude(s);for(var n=0;o>n;n++)if(this._lastPosition.add(a.x,a.y),i!==t.eBonusType.POWER&&(this._bottomEmitter.emitAt(this._lastPosition.x,this._lastPosition.y),this._bottomEmitter.emitParticle()),i!==t.eBonusType.NONE&&(this._nextParticleTime-=e)<=0){this._topEmitter.emitAt(this._lastPosition.x,this._lastPosition.y);var r=this._topEmitter.emitParticle();if(null!==r)switch(i){case t.eBonusType.FAST:this._nextParticleTime=.04*this._board.speedCoef,r.setFrame("BALL_PTC_FAST"),r.lifetime=.4*this._board.speedCoef;var h=t.Settings.BALL_DIAMETER>>3;r.visual.position.x+=this.game.rnd.integerInRange(-h,h),r.visual.position.y+=this.game.rnd.integerInRange(-h,h),r.setScaleChange(t.eParameterChangeType.IN_TIME,-.9),r.alpha=.5+this.game.rnd.realInRange(0,.5),r.setAlphaChange(t.eParameterChangeType.IN_TIME,-2);break;case t.eBonusType.SLOW:this._nextParticleTime=.18*this._board.speedCoef,r.setFrame("BALL_PTC_SLOW"),r.lifetime=1*this._board.speedCoef;var h=t.Settings.BALL_DIAMETER>>2;r.visual.position.x+=this.game.rnd.integerInRange(-h,h),r.visual.position.y+=this.game.rnd.integerInRange(-h,h),r.setScaleChange(t.eParameterChangeType.IN_TIME,-1);break;case t.eBonusType.POWER:this._nextParticleTime=.08*this._board.speedCoef,r.setFrame("BALL_PTC_POWER"),r.lifetime=.4*this._board.speedCoef,r.setScaleChange(t.eParameterChangeType.IN_TIME,-.9),r.setAlphaChange(t.eParameterChangeType.IN_TIME,-2);break;case t.eBonusType.STICKY:this._nextParticleTime=.04*this._board.speedCoef,r.setFrame("BALL_PTC_STICKY"),r.lifetime=.4*this._board.speedCoef;var h=t.Settings.BALL_DIAMETER>>2;r.visual.position.x+=this.game.rnd.integerInRange(-h,h),r.visual.position.y+=this.game.rnd.integerInRange(-h,h),r.setScaleChange(t.eParameterChangeType.IN_TIME,-2),r.setAlphaChange(t.eParameterChangeType.IN_TIME,-2)}}}},i.prototype.hitParticle=function(){switch(this._topEmitter.emitAt(this._hitPoint.x,this._hitPoint.y),this._board.activeBonus){case t.eBonusType.SLOW:for(var e=0;e<this.game.rnd.integerInRange(3,6);e++){var i=this._topEmitter.emitParticle();if(null!==i){i.setFrame("HIT_PARTICLE_ICE");var s=i.visual.rotation;i.setPhysics(120*Math.cos(s),120*Math.sin(s),0,.5),i.lifetime=2,i.setScaleChange(t.eParameterChangeType.NO_CHANGE),i.setAlphaChange(t.eParameterChangeType.IN_TIME,-.5)}}break;case t.eBonusType.FAST:for(var e=0;e<this.game.rnd.integerInRange(4,7);e++){var i=this._topEmitter.emitParticle();if(null!==i){i.setFrame("HIT_PARTICLE_FIRE");var s=i.visual.rotation;i.setPhysics(240*Math.cos(s),240*Math.sin(s),0,.7),i.lifetime=1,i.setScaleChange(t.eParameterChangeType.NO_CHANGE),i.setAlphaChange(t.eParameterChangeType.IN_TIME,-.5)}}break;case t.eBonusType.STICKY:this._topEmitter.emitAt(this._hitPoint.x+this.game.rnd.integerInRange(t.Settings.BALL_DIAMETER,t.Settings.BALL_DIAMETER)/2,this._hitPoint.y+this.game.rnd.integerInRange(t.Settings.BALL_DIAMETER,t.Settings.BALL_DIAMETER)/2);for(var e=0;3>e;e++){var i=this._topEmitter.emitParticle();if(null!==i){i.setFrame("BALL_PTC_STICKY"),i.lifetime=2.5;var a=.5+this.game.rnd.realInRange(.5,1);i.visual.scale.set(a,a),i.setScaleChange(t.eParameterChangeType.IN_TIME,-.2),i.setAlphaChange(t.eParameterChangeType.IN_TIME,-.5)}}break;case t.eBonusType.POWER:var i=this._topEmitter.emitParticle();null!==i&&(i.setFrame("BALL_PTC_POWER"),i.lifetime=1,i.setScaleChange(t.eParameterChangeType.IN_TIME,1),i.setAlphaChange(t.eParameterChangeType.IN_TIME,-1))}},i.prototype.onCollisionBorder=function(e,i,s,a,o,n){o&&(this.setHit(n),this._board.addEmptyHit(),this.addComboEvent(2),Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.BORDER_HIT_1,t.Sfx.BORDER_HIT_3)))},i.prototype.onCollisionBottomBorder=function(t,e,i,s,a,o){a&&(this.setHit(o),this.dead=!0)},i.prototype.onCollisionPaddle=function(e,i,s,a,o,n){o&&(this.setHit(n),this._board.addPaddleHit(),this.clearComboStates(),!this._sticked&&this._board.isStickTime()?(e.velocity.y>0&&e.y+t.Settings.BALL_DIAMETER/2<i.y&&(this._doStick=!0,this._stickPosition.set(e.x,e.y)),Utils.AudioUtils.playSound(t.Sfx.BALL_STICKY_HIT)):Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.PADDLE_HIT_1,t.Sfx.PADDLE_HIT_3)))},i.prototype.onCollisionBall=function(e,i,s,a,o,n){o&&(this.setHit(n),Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.PADDLE_HIT_1,t.Sfx.PADDLE_HIT_3)))},i.prototype.onPresolveBrick=function(e,i,s,a,o,n){if(this._board.isPowerTime()){var r=i.sprite;(r.type===t.eObjectType.OBJECT_BRICK&&!i.sprite.unbreakable||r.type===t.eObjectType.OBJECT_ENEMY)&&o.SetEnabled(!1)}},i.prototype.setHit=function(t){this._hitOccured=!0,this._board.calcContactPoint(t,this._hitPoint)},i.prototype.clearComboStates=function(){this._comboState=0,this._expectedEvent=0,this._comboQueueCtr=0,this._comboCtr=0},i.prototype.addComboEvent=function(t){this._comboQueueCtr>=i.MAX_COMBO_EVENTS||(1==t&&this._board.isPowerTime()&&(t=3),this._comboQueue[this._comboQueueCtr++]=t)},i.prototype.setComboState=function(e,i,s){void 0===s&&(s=4),this._comboState!==e&&0!==e&&(this._comboTimeout=t.Settings.COMBO_TIMEOUT),this._comboState=e,this._comboCtr=i,4!==s&&(this._expectedEvent=s)},i.prototype.increaseComboCounter=function(){if(++this._comboCtr,this._comboTimeout=t.Settings.COMBO_TIMEOUT,this._comboCtr>=3&&(2===this._comboState||3===this._comboState)||this._comboCtr>=4&&4===this._comboState){var e=this._board.getFreeCombo();null!==e&&e.init(this.x,this.y,this._comboCtr),this._board.adjustComboValue(this._comboCtr-2)}},i.prototype.processComboQueue=function(t){this._comboTimeout>0&&(this._comboTimeout-=t)<0&&this.setComboState(0,0);for(var e=0;e<this._comboQueueCtr;e++){var i=this._comboQueue[e];switch(this._comboState){case 0:3===i?this.setComboState(4,1,3):1===i?this.setComboState(1,1):this.setComboState(0,0);break;case 1:3===i?this.setComboState(4,1,3):1===i?(this.setComboState(2,this._comboCtr,1),this.increaseComboCounter()):this.setComboState(3,this._comboCtr,1);break;case 2:1===i?this.increaseComboCounter():2===i?this.setComboState(0,0):3===i&&this.setComboState(4,1,3);break;case 3:i===this._expectedEvent?1===this._expectedEvent?(this.increaseComboCounter(),this._expectedEvent=2):this._expectedEvent=1:2===i?this.setComboState(0,0):1===i?this.setComboState(2,2,1):3===i&&this.setComboState(4,1,3);break;case 4:2===i?this.setComboState(0,0):1===i?this.setComboState(1,1):this.increaseComboCounter()}}this._comboQueueCtr=0},i.BOTTOM_PARTICLES_MAX=32,i.TOP_PARTICLES_MAX=32,i.MAX_COMBO_EVENTS=12,i}(t.SpriteWithUpdatableShadow);t.Ball=e}(Shards||(Shards={}));var Shards;!function(t){!function(t){t[t.NONE=0]="NONE",t[t.LIFE=1]="LIFE",t[t.BOMB=2]="BOMB",t[t.CANNON=3]="CANNON",t[t.ENLARGE=4]="ENLARGE",t[t.FAST=5]="FAST",t[t.POWER=6]="POWER",t[t.SHRINK=7]="SHRINK",t[t.SLOW=8]="SLOW",t[t.STICKY=9]="STICKY",t[t.TRIPLE=10]="TRIPLE"}(t.eBonusType||(t.eBonusType={}));var e=t.eBonusType,i=function(i){function s(e,a){i.call(this,e,a,500,0,"Game");var o=t.Global.LOW?.4:1;this._type=t.eObjectType.OBJECT_BONUS,this._typeSprite=new Phaser.Sprite(e,0,0,"Game"),this._typeSprite.anchor.set(.5,.5),this._typeSprite.visible=!1,this.addChild(this._typeSprite),this.animations.add("bonus",s.ANIM_BONUS,8,!0),this.animations.add("bomb",s.ANIM_BOMB,12,!0),e.physics.box2d.enable(this,!1);var n=this.body;n.setCircle(25*o),n.mass=1,n.friction=0,n.restitution=1,n.sensor=!0,n.setCollisionCategory(t.eObjectType.OBJECT_BONUS),n.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_BOTTOM_BORDER+t.eObjectType.OBJECT_PADDLE),n.setCategoryContactCallback(t.eObjectType.OBJECT_BOTTOM_BORDER,this.onCollision,this),n.setCategoryContactCallback(t.eObjectType.OBJECT_PADDLE,this.onCollision,this),this.setActive(!1),this.shadow=new t.AnchoredSprite(e,0,0,"Game","BONUS_SHADOW")}return __extends(s,i),Object.defineProperty(s.prototype,"toBeDestroyed",{get:function(){return this._toBeDestroyed},set:function(t){this._toBeDestroyed=t,this.shadow=null},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"activate",{get:function(){return this._activate},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bonusType",{get:function(){return this._bonusType},set:function(t){this._bonusType=t,this._toBeDestroyed=!1,this._activate=!1;var i=s.FRAMES[this._bonusType];t===e.BOMB?(this._typeSprite.visible=!1,this.animations.play("bomb")):(this._typeSprite.visible=!0,this._typeSprite.frameName=i,this.animations.play("bonus")),this._shadow.setAnchoredFrame(this.game.cache.getFrameByName("Game",i).index+13)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"typeFrame",{get:function(){return this._typeSprite.frameName},enumerable:!0,configurable:!0}),s.prototype.onCollision=function(t,e,i,s,a,o){a&&(null===e.sprite?this._toBeDestroyed=!0:this._activate=!0)},s.FRAMES=["","BONUS_1UP","BONUS_BOMB_0","BONUS_CANNON","BONUS_ENLARGE","BONUS_FAST","BONUS_POWER","BONUS_SHRINK","BONUS_SLOW","BONUS_STICKY","BONUS_TRIPLE"],s.ANIM_BONUS=["BONUS_0","BONUS_1","BONUS_2","BONUS_3","BONUS_4","BONUS_5","BONUS_6","BONUS_7"],s.ANIM_BOMB=["BONUS_BOMB_0","BONUS_BOMB_1","BONUS_BOMB_2","BONUS_BOMB_3","BONUS_BOMB_2","BONUS_BOMB_1","BONUS_BOMB_0"],s}(t.SpriteWithUpdatableShadow);t.Bonus=i}(Shards||(Shards={}));var Shards;!function(t){!function(t){t[t.BLOCKER=0]="BLOCKER",t[t.PASSER=1]="PASSER",t[t.MIXED=2]="MIXED"}(t.eHiveType||(t.eHiveType={}));t.eHiveType;!function(t){t[t.HIVE=0]="HIVE",t[t.PASSER=1]="PASSER",t[t.BLOCKER=2]="BLOCKER"}(t.eEnemyType||(t.eEnemyType={}));var e=t.eEnemyType,i=function(i){function s(e,s){i.call(this,e,s,500,0,"Game","PADDLE"),this._hitPoint=new Phaser.Point,this._pt=new Phaser.Point,this._b2Vec1=new box2d.b2Vec2,this._b2Vec2=new box2d.b2Vec2,this._type=t.eObjectType.OBJECT_ENEMY,e.physics.box2d.enable(this);var a=this.body;this.shadow=new t.AnchoredSprite(e,0,0,"Game"),a.setCategoryContactCallback(t.eObjectType.OBJECT_BORDER,this.onCollisionBorder,this),a.setCategoryContactCallback(t.eObjectType.OBJECT_BALL,this.onCollisionBallMissile,this),a.setCategoryContactCallback(t.eObjectType.OBJECT_PADDLE,this.onCollisionPaddle,this),a.setCategoryContactCallback(t.eObjectType.OBJECT_BRICK,this.onCollisionBrick,this),a.setCategoryContactCallback(t.eObjectType.OBJECT_MISSILE,this.onCollisionBallMissile,this),a.setCategoryPresolveCallback(t.eObjectType.OBJECT_BRICK,this.onPresolveBrick,this),this.setActive(!1)}return __extends(s,i),s.claerHives=function(){s._hivesCount=0,s._hivesScale=0,s._enemiesCount=0},Object.defineProperty(s.prototype,"toBeDestroyed",{get:function(){return this._toBeDestroyed},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"enemyScale",{get:function(){return this._scale},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"hiveType",{get:function(){return this._hiveType},enumerable:!0,configurable:!0}),s.prototype.init=function(i,s,a,o,n){var r=this.game.cache.getFrameByName("Game","ENEMY_HIVE").index+o,h=this.game.cache.getFrameByIndex("Game",r).width*a;this.frame=r,this.scale.set(a,a),this._shadow.scale.set(a,a),o===e.HIVE&&(h*=.8);var l=this.body;if(l.setCircle(h/2),l.mass=h/t.Settings.PTM/2*(h/t.Settings.PTM/2)*Math.PI*5,l.friction=0,l.restitution=1,l["static"]=o===e.HIVE,this.setPosition(i,s),this.setVelocity(0,0),l.setCollisionCategory(t.eObjectType.OBJECT_ENEMY),l.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_BOTTOM_BORDER+t.eObjectType.OBJECT_PADDLE+t.eObjectType.OBJECT_BRICK+t.eObjectType.OBJECT_MISSILE),o===e.HIVE?this._shadow.visible=!1:o===e.PASSER?this._shadow.setAnchoredFrame("ENEMY_SHADOW_PASSER"):this._shadow.setAnchoredFrame("ENEMY_SHADOW_BLOCKER"),this.set(o,a,n),o!==e.HIVE){this._shadow.visible=!0;var _=t.Settings.ENEMY_SPEED_NORMAL*l.mass,c=this.game.rnd.integerInRange(0,359),d=Math.cos(Phaser.Math.degToRad(c)),u=Math.sin(Phaser.Math.degToRad(c));l.data.ApplyLinearImpulse(new box2d.b2Vec2(-d*_,-u*_),new box2d.b2Vec2(-l.x/t.Settings.PTM,-l.y/t.Settings.PTM)),l.data.SetAngularVelocity((0===this.game.rnd.integerInRange(0,1)?-1:1)*t.Settings.ENEMY_SPEED_NORMAL)}this.setActive(!0)},s.prototype.tick=function(i){if(this._lives<=0)return this._enemyType===e.HIVE?(--s._hivesCount,(s._hivesScale-=this._scale)<0&&(s._hivesScale=0)):--s._enemiesCount,this._board.shardsExplosion(this.x,this.y,1,!0),Utils.AudioUtils.playSound(t.Sfx.ENEMY_EXPLOSION),Utils.AudioUtils.playSound(t.Sfx.ENEMY_EXPLOSION),this._enemyType===e.HIVE,this._board.shardsParticles(this.x,this.y,1.5*this._scale,8,12,this.width*this._scale/8),this._board.shockWave(this.x,this.y,8*this._scale),this._toBeDestroyed=!0,!1;var a=!1;if(this._enemyType===e.HIVE){var o=s._enemiesCount<2*s._hivesScale+.5&&s._enemiesCount+s._hivesCount<t.Settings.ENEMY_MAX;a=o&&this.updateHive(i)}else this.updateMoving(i);return a},s.prototype.set=function(i,a,o){switch(this._enemyType=i,this._hiveType=o,this._scale=a,this._toBeDestroyed=!1,this._collision=!1,this._rage=0,this._rageTime=0,i){case e.HIVE:this._lives=5.5*this._scale,this._timeToSpawn=this.game.rnd.realInRange(t.Settings.ENEMY_TIME_TO_SPAWN_MIN,t.Settings.ENEMY_TIME_TO_SPAWN_MIN+t.Settings.ENEMY_TIME_TO_SPAWN_RANGE)*this._scale,++s._hivesCount,s._hivesScale+=1/this._scale;break;case e.PASSER:this._lives=3.5*this._scale,++s._enemiesCount;break;case e.BLOCKER:this._lives=2.5*this._scale,++s._enemiesCount}this._lives<1&&(this._lives=1),i!==e.HIVE&&(this._timeToChangeDir=this.game.rnd.realInRange(t.Settings.ENEMY_TIME_TO_CHANGE_DIR_MIN,4*t.Settings.ENEMY_TIME_TO_CHANGE_DIR_MIN))},s.prototype.updateHive=function(e){return(this._timeToSpawn-=e)<=0?(this._timeToSpawn=this.game.rnd.realInRange(t.Settings.ENEMY_TIME_TO_SPAWN_MIN,t.Settings.ENEMY_TIME_TO_SPAWN_MIN+t.Settings.ENEMY_TIME_TO_SPAWN_RANGE)*this._scale,!0):!1},s.prototype.updateMoving=function(i){var s=this._rageTime>0;this._collision&&(this._collision=!1,this._rageTime<=0&&(this._rage+=t.Settings.ENEMY_RAGE_ADD)),this._rage>0&&(this._rage-=1.5*i),s&&(this._rageTime-=i,this._rageTime<=0&&this.setVelocity(this.game.rnd.realInRange(-1,1),this.game.rnd.realInRange(-1,1))),this._rage>t.Settings.ENEMY_RAGE_LIMIT&&(this._rageTime=t.Settings.ENEMY_RAGE_TIME,this._rage=0);var a=t.Settings.ENEMY_SPEED_NORMAL;s&&(a=t.Settings.ENEMY_SPEED_RAGE);var o=this.getVelocity(this._pt);o.divide(-t.Settings.PTM,-t.Settings.PTM);var n=this.body;if(o.getMagnitudeSq()<a*a){var r=this.game.cache.getFrameByIndex("Game",this.frame).width;r=r/2/t.Settings.PTM;var h=Math.abs(a-o.getMagnitude())+.01;h*=n.data.GetMass(),o.multiply(h,h);var l=this._b2Vec2;l.SetXY(o.x,o.y);var _=this._b2Vec1;_.SetXY(this.game.rnd.realInRange(-r,r),this.game.rnd.realInRange(-r,r)),n.data.ApplyLinearImpulse(l,n.data.GetWorldPoint(_,_));var c=Phaser.Math.sign(n.angularVelocity);0===c&&(c=0===this.game.rnd.integerInRange(0,1)?-1:1),n.angularVelocity=a*c}if(this._enemyType!==e.HIVE&&(this._timeToChangeDir-=i)<0){this._timeToChangeDir=this.game.rnd.realInRange(t.Settings.ENEMY_TIME_TO_CHANGE_DIR_MIN,4*t.Settings.ENEMY_TIME_TO_CHANGE_DIR_MIN);var d=this.getVelocity(this._pt);switch(this.game.rnd.integerInRange(0,3)){case 0:d.x=-d.x;break;case 1:d.y=-d.y;break;case 2:var u=d.x;d.x=d.y,d.y=u;break;case 3:var p=this._b2Vec1;p.SetXY(d.x,d.y),p.SelfRotateDegrees(this.game.rnd.integerInRange(0,359)),d.x=p.x,d.y=p.y}this.setVelocity(d.x,d.y)}},s.prototype.onCollisionBorder=function(e,i,s,a,o,n){o&&(Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.ENEMY_BORDER_HIT_1,t.Sfx.ENEMY_BORDER_HIT_3)),this._collision=!0)},s.prototype.onCollisionBrick=function(i,s,a,o,n,r){n&&(s.sprite.unbreakable?(Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.ENEMY_UNBREAKABLE_HIT_1,t.Sfx.ENEMY_UNBREAKABLE_HIT_2)),this._collision=!0):this._enemyType===e.BLOCKER?(this._collision=!0,Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.ENEMY_BRICK_DAMAGED_1,t.Sfx.ENEMY_BRICK_DAMAGED_3))):this._enemyType===e.PASSER&&(this._hitPoint=this._board.calcContactPoint(r,this._hitPoint)))},s.prototype.onCollisionPaddle=function(e,i,s,a,o,n){o&&(this._lives-=10)>0&&Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.ENEMY_UNBREAKABLE_HIT_1,t.Sfx.ENEMY_UNBREAKABLE_HIT_2))},s.prototype.onCollisionBallMissile=function(e,i,s,a,o,n){o&&(this._board.shardsExplosion(this.x,this.y,this._scale,!1),(this._lives-=1)>0&&Utils.AudioUtils.playSound(this.game.rnd.integerInRange(t.Sfx.ENEMY_UNBREAKABLE_HIT_1,t.Sfx.ENEMY_UNBREAKABLE_HIT_2)))},s.prototype.onPresolveBrick=function(t,i,s,a,o,n){this._enemyType!==e.PASSER||i.sprite.unbreakable||o.SetEnabled(!1)},s}(t.SpriteWithUpdatableShadow);t.Enemy=i}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(i,s){e.call(this,i,s,500,0,"Game","LASER"),this._hitPoint=new Phaser.Point,this._type=t.eObjectType.OBJECT_MISSILE,i.physics.box2d.enable(this);var a=this.body;a.setRectangle(10,70),a.mass=.2,a.friction=0,a.restitution=0,a.fixedRotation=!0,a.setCollisionCategory(t.eObjectType.OBJECT_MISSILE),a.setCollisionMask(t.eObjectType.OBJECT_BORDER+t.eObjectType.OBJECT_BRICK+t.eObjectType.OBJECT_ENEMY),a.setCategoryContactCallback(t.eObjectType.OBJECT_BORDER,this.onCollision,this),a.setCategoryContactCallback(t.eObjectType.OBJECT_BRICK,this.onCollision,this),a.setCategoryContactCallback(t.eObjectType.OBJECT_ENEMY,this.onCollision,this),this.shadow=new t.AnchoredSprite(i,0,0,"Game","LASER_SHADOW"),this.setActive(!1)}return __extends(i,e),Object.defineProperty(i.prototype,"toBeDestroyed",{get:function(){return this._toBeDestroyed},set:function(t){this._toBeDestroyed=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hitPoint",{get:function(){return this._hitPoint},enumerable:!0,configurable:!0}),i.prototype.onCollision=function(e,i,s,a,o,n){if(o&&(this._hitPoint.set(this.position.x,this.position.y-35),this._toBeDestroyed=!0,null!==i.sprite)){var r=i.sprite;r.type===t.eObjectType.OBJECT_BRICK&&r.hit(1)}},i}(t.SpriteWithUpdatableShadow);t.Missile=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(){function e(e,i){this._boardStats=new t.BoardStats,this._paddleJoint=null,this._pt=new Phaser.Point,this._worldManifold=new box2d.b2WorldManifold,this._game=e,this._parent=i,this._paused=!1,this.setSpeed(),this._prerendered=new Phaser.RenderTexture(e,e.width,e.height);var s=new Phaser.Image(e,0,0,this._prerendered,0);s.anchor.setTo(.5,.5),e.world.add(s),this.createLayers();var a=this;this._ballsPool=new t.Pool(t.Ball,t.Settings.BALLS_MAX,function(){return new t.Ball(e,a)}),this._ballsPool.canGrow=!1,this._balls=[],this._ballsCount=0,this._missilesPool=new t.Pool(t.Missile,t.Settings.MISSILE_MAX,function(){return new t.Missile(e,a)}),this._missilesPool.canGrow=!1,this._missiles=[],this._missilesCount=0,this._combosPool=new t.Pool(t.Combo,t.Settings.COMBOS_MAX,function(){return new t.Combo(e)}),this._combosPool.canGrow=!1,this._combos=[],this._combosCount=0,this._enemiesPool=new t.Pool(t.Enemy,t.Settings.ENEMY_MAX,function(){return new t.Enemy(e,a)}),this._enemies=[],this._enemiesCount=0,t.Enemy.claerHives(),this._bonusesPool=new t.Pool(t.Bonus,t.Settings.BONUSES_MAX,function(){return new t.Bonus(e,a)}),this._bonusesPool.canGrow=!1,this._bonuses=[],this._bonusesCount=0,this._activeBallBonus=t.eBonusType.NONE,this._activeBallBonusTime=0,this._lifeBonusAlreadySpawned=!1,this._paddleY=Math.floor(e.height/2-e.height*t.Settings.PADDLE_HEIGHT_LEVEL);var o=new t.Paddle(e,this,0,this._paddleY),n=this._gameLayer.getIndex(this._topParticlesGroup);this._gameLayer.addAt(o,n),this._paddle=o,this._bricks=[],this._bricksCount=0,this._score=new t.Score,this._score.onNewHiScore.add(this._gui.onNewHiScore,this._gui),this._emitters=new t.Emitters(e,this),this._title=new t.Title(e,this._combosGroup)}return Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inGameMenu",{get:function(){return this._menuLayer},enumerable:!0,configurable:!0}),e.prototype.createLayers=function(){var e=this._game,i=new Phaser.Group(e,e.world);this._gameLayer=i,this._menuLayer=new t.InGameMenu(e,e.world,this),this._menuLayer.exists=!1,this._menuLayer.visible=!1,this._bonusText=new t.BonusText(e,i),this._shadowsGroup=new Phaser.Group(e,i),this._bricksGroup=new Phaser.Group(e,i),this._enemyGroup=new Phaser.Group(e,i),this._ballLowParticlesGroup=new Phaser.Group(e,i),this._ballsGroup=new Phaser.Group(e,i),this._ballTopParticlesGroup=new Phaser.Group(e,i),this._bonusGroup=new Phaser.Group(e,i),this._missilesGroup=new Phaser.Group(e,i),this._topParticlesGroup=new Phaser.Group(e,i),this._combosGroup=new Phaser.Group(e,i),this._statsGroup=new t.Stats(e,i,this._parent),this._ballArrow=new t.AnchoredSprite(e,0,0,"Game","START_ARROW"),this._ballArrow.visible=!1,this._ballShock=new t.AnchoredSprite(e,0,0,"Game","SHOCKWAVE"),this._ballShock.visible=!1,this._gui=new t.GUI(e,i,this)},e.prototype.destroy=function(){},Object.defineProperty(e.prototype,"paddle",{get:function(){return this._paddle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsGroup",{get:function(){return this._shadowsGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bricksGroup",{get:function(){return this._bricksGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ballLowParticlesGroup",{get:function(){return this._ballLowParticlesGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ballTopParticlesGroup",{get:function(){return this._ballTopParticlesGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topParticlesGroup",{get:function(){return this._topParticlesGroup},enumerable:!0,configurable:!0}),e.prototype.clearEntities=function(t){for(var e=this._ballsCount-1;e>=0;e--)this.removeBall(this._balls[e]);this._ballsCount=0;for(var e=this._bonusesCount-1;e>=0;e--)this.removeBonus(e);this._bonusesCount=0;for(var e=this._missilesCount-1;e>=0;e--)this.removeMissile(e);this._missilesCount=0;for(var e=this._combosCount-1;e>=0;e--)this.removeCombo(e);this._combosCount=0,null!==this._paddleJoint&&(this._game.physics.box2d.world.DestroyJoint(this._paddleJoint),this._paddleJoint=null)},e.prototype.loadLevel=function(e){this._level=e,this._state=0,this._lostState=0,this._lostTime=0,this._boardStats.clearStat();var i=this._game.cache.getFrameByName("Game","BRICK_NORMAL");t.Settings.SHADOW_OFFSET.set(i.width>>2,i.height>>1);var s=this._parent.levelsFile;s.setFile(e),this._bgIndex=s.readUint8()+1,this.setBG(this._bgIndex),this.loadBricks(s),this._brickShine=new t.AnchoredSprite(this._game,0,0,"Game","BRICK_SHINE_0"),this._brickShine.animations.add("shine",t.Settings.BRICK_SHINE,20).onComplete.add(function(){this._brickShine.visible=!1},this),this._brickShine.visible=!1,this.loadShardiens(s),this.createBorders(),this.paintBorders(),this.initPaddle(),this._title.init("LEVEL "+(e+1),t.Settings.TITLE_LEVEL),this._shineTime=this._game.rnd.realInRange(0,5),this._lastBrick=null,this._lastBrickTime=!1,this._lastBrickCounter=t.Settings.LAST_BRICK_TIME,this._gameTime=0,this._initialEffectTime=t.Settings.INITIAL_EFFECT_DURATION;var a=new Helper.GravityBounce(2,.3,!1);this._bounceTween=this._game.add.tween(this._game.world.scale).to({x:t.Settings.IMPACT_SCALE,y:t.Settings.IMPACT_SCALE},t.Settings.IMPACT_DURATION,function(t){return a.easing(t)},!1),Utils.AudioUtils.playSound(t.Sfx.FIRE);
},e.prototype.loadBricks=function(e){t.Brick.NORMAL_BASE=this._game.cache.getFrameByName("Game","BRICK_NORMAL").index,t.Brick.UNBREAKABLE_BASE=this._game.cache.getFrameByName("Game","BRICK_UNBREAKABLE").index;var i=e.readUint8();i>t.Settings.COLORED_BRICKS_MAX;for(var s=0;i>s;s++){e.readUint32(!0)}for(var a=e.readUint16(!0),o=t.Global.GAME_WIDTH,s=0;a>s;s++){var n=e.readInt16(!0)*o/800-o/2,r=e.readInt16(!0)*this._game.height/1280-this._game.height/2,h=e.readUint8()/100,l=e.readUint8(),_=e.readUint16(!0);_&t.Brick.MASK_ANGLE_BIT&&(l+=256);var c=new t.Brick(this._game,this,n,r,h,l,_);c.id=s,this._bricks[this._bricksCount++]=c,this._bricksGroup.add(c),_&t.Brick.MASK_UNBREAKABLE?++this._boardStats.bricksUnbreakable:++this._boardStats.bricksWinCount,this._boardStats.bricksToBreak=this._boardStats.bricksWinCount,this._bricksGroup.customSort(function(t,e){return e.id-t.id})}},e.prototype.removeBrick=function(t){this._bricksGroup.remove(t),t.setActive(!1)},e.prototype.loadShardiens=function(e){var i=t.Global.shardiensOn;if(e.hasNext())for(var s=e.readUint8(),a=t.Global.GAME_WIDTH,o=0;s>o;o++){var n=e.readUint8(),r=e.readInt16(!0)*a/800-a/2,h=e.readInt16(!0)*this._game.height/1280-this._game.height/2,l=e.readUint8()/100;i&&this.spawnEnemy(r,h,!0,n,l)}},e.prototype.createBorders=function(){var e=this._game,i=t.Global.GAME_WIDTH,s=t.Settings.BORDER_WIDTH,a=[],o=new Phaser.Physics.Box2D.Body(e,null,-i/2-50+s,0);o.setRectangle(100,e.height+200),a.push(o);var n=new Phaser.Physics.Box2D.Body(e,null,i/2+50-s,0);n.setRectangle(100,e.height+200),a.push(n);var r=new Phaser.Physics.Box2D.Body(e,null,0,-e.height/2-50+s);r.setRectangle(i+100,100),a.push(r);var h=new Phaser.Physics.Box2D.Body(e,null,0,e.height/2+100);h.setRectangle(i+100,100),a.push(h),this._bottomBorderBody=h;for(var l=0;l<a.length;l++){var _=a[l];_["static"]=!0,_.restitution=1,_.friction=0,_.setCollisionCategory(l<a.length-1?t.eObjectType.OBJECT_BORDER:t.eObjectType.OBJECT_BOTTOM_BORDER),_.setCollisionMask(t.eObjectType.OBJECT_PADDLE+t.eObjectType.OBJECT_BALL+t.eObjectType.OBJECT_ENEMY+t.eObjectType.OBJECT_MISSILE+t.eObjectType.OBJECT_BONUS)}},e.prototype.paintBorders=function(){for(var e=this._game,i=t.Global.GAME_WIDTH,s=new Phaser.Group(e,null),a=[],o=0;3>o;o++)a[o]=e.rnd.integer();for(var n=e.cache.getFrameByName("Game","BORDER_TOP_LEFT"),r=e.cache.getFrameByName("Game","BORDER_HORIZONTAL"),h=e.cache.getFrameByName("Game","BORDER_VERTICAL_LEFT"),l=-e.height/2,_=n.width-i/2,c=a[0];_<i/2-n.width;)s.add(new t.AnchoredSprite(e,_,l,"Game",0!==(7&c)?"BORDER_HORIZONTAL":"BORDER_HORIZONTAL2")),c>>=1,_+=r.width;l=-e.height/2+n.height;for(var d=a[1],u=a[2];l<e.height/2;)s.add(new t.AnchoredSprite(e,-i/2,l,"Game",0!==(7&d)?"BORDER_VERTICAL_LEFT":"BORDER_VERTICAL_LEFT2")),s.add(new t.AnchoredSprite(e,i/2,l,"Game",0!==(7&d)?"BORDER_VERTICAL_RIGHT":"BORDER_VERTICAL_RIGHT2")),d>>=1,u>>=1,l+=h.height;l=-e.height/2,s.add(new t.AnchoredSprite(e,-i/2,l,"Game","BORDER_TOP_LEFT")),s.add(new t.AnchoredSprite(e,i/2,l,"Game","BORDER_TOP_RIGHT")),this._prerendered.renderXY(s,this._prerendered.width/2,this._prerendered.height/2)},e.prototype.initPaddle=function(){var e=0,i=this._paddleY;this.resetPaddle(e,i,1);var s=this._game.cache.getFrameByName("Game","PADDLE").height/2+t.Settings.BALL_DIAMETER/2,a=this.createBall(e,i-s);null!==a&&(a.setStickPosition(e,i-s),a.setSticked(!0)),this._emitters.newBall(this._gui.ball.x,this._gui.ball.y),this._gui.lives=this._lives,this._paddleLastVelocityX=0,this._initialBallLaunch=!0,this._ballArrow.angle=-90,this._ballArrow.visible=0!==this._state,a.addChild(this._ballArrow)},e.prototype.createBall=function(t,e){var i=this._ballsPool.createItem();return null===i?null:(i.setPosition(t,e),i.setActive(!0),i.clear(),this._balls[this._ballsCount++]=i,this._ballsGroup.add(i),this.setBallsFrame(),i)},e.prototype.removeBall=function(t){this._ballsGroup.remove(t),t.setActive(!1),t.clear(),this._ballsPool.destroyItem(t);for(var e=0;e<this._ballsCount;e++)this._balls[e]===t&&(this._balls[e]=this._balls[--this._ballsCount],this._balls[this._ballsCount]=null)},e.prototype.resetPaddle=function(t,e,i){var s=this._game,a=this.paddle;a.setPosition(t,e),a.setAngle(0),a.setSize(i),a.cancelCannon(),null===this._paddleJoint&&(this._paddleJoint=s.physics.box2d.prismaticJoint(this._bottomBorderBody,a,1,0,0,-(this._bottomBorderBody.y-this._paddleY),0,0,0,0,!1,-1200,1200,!0));for(var o=0;o<this._ballsCount;o++)this._balls[o].setSticked(!1)},e.prototype.tick=function(t){switch(this._state){case 0:this._state=1;break;case 1:this._initialEffectTime>0?this.updateInitialEffect(t):(this._ballArrow.visible=!0,this._state=2);break;case 2:this._paused||this.tickPlay(t);break;case 4:this.tickStats(t)}},e.prototype.updateStartArrow=function(){var t=this._game.time.time;t=Math.floor(t/4),t%=240,t>120&&(t=120-(t-120)),this._ballArrow.angle=-90+(t-60)},e.prototype.tickPlay=function(e){this._gameTime+=e;var i=0!=this._lostState;if(this.updateBonusText(),this._ballArrow.visible&&this.updateStartArrow(),this.destroyBrokenBricks(),this._boardStats.bricksWinCount<=0&&!i)this._winTime=1,this._state=4,this.clearBonuses(),this.updateBonusText();else if(1===this._boardStats.bricksWinCount&&!this._lastBrickTime){this._lastBrickTime=!0,this._lastBrickCounter=t.Settings.LAST_BRICK_TIME,this._lastBrick=this._bricks[0];for(var s=0;s<this._bricksCount;s++)if(!this._bricks[s].unbreakable){this._lastBrick=this._bricks[s];break}}if(this._lastBrickTime&&this.updateCountDown(e),this.shineBrick(e),i){if((this._lostTime-=e)<=0)return this.clearEntities(this._lives<0),this._lives<0?(t.Global.hiScore=this._score.hiScore,Utils.StorageUtils.save(),this._state=3,void this._parent.onGameOver()):(this._lostState=0,this.initPaddle(),void this._boardStats.clearEmptyHits());if(1===this._lostState);else if(2===this._lostState&&(this._lostExplosionCounter-=e)<=0){this._lostExplosionCounter=this._game.rnd.realInRange(.2,.6);var a=30;this.setExplosion(this._paddle.x+this._game.rnd.integerInRange(-a,a),this._paddle.y+this._game.rnd.integerInRange(-a,a))}}this.updateAll(e),0===this._ballsCount&&!i&&this._boardStats.bricksWinCount>0&&(this._lostState=1,this.looseLife(),this._lives<0?(this._lostTime=t.Settings.LOST_TIME_TOTAL,this._parent.stopMusic(),Utils.AudioUtils.playSound(t.Sfx.GAME_OVER)):(this._lostTime=t.Settings.LOST_TIME_BALL,Utils.AudioUtils.playSound(t.Sfx.BALL_LOST)));for(var o=!1,s=0;s<this._ballsCount;s++)if(this._balls[s].sticked){o=!0;break}if(o||(this._boardStats.noHitTime+=e),(this._boardStats.emptyHits>t.Settings.EMPTY_HITS||this._boardStats.noHitTime>t.Settings.NO_HIT_TIME)&&(this._boardStats.emptyHits=0,this._boardStats.noHitTime=0,!o&&this._ballsCount<t.Settings.BALLS_MAX)){this._boardStats.emptyHitCounter=t.Settings.EMPTY_HIT_DURATION;var n=this._game.cache.getFrameByName("Game","PADDLE").height/2+t.Settings.BALL_DIAMETER/2;this._ballShock.visible=!0,this._ballShock.scale.set(10/this._paddle.scale.x,10),this._ballShock.position.y=-n,this._paddle.addChild(this._ballShock),Utils.AudioUtils.playSound(t.Sfx.SWOOSH),Utils.AudioUtils.playSound(t.Sfx.SWOOSH)}if(this._boardStats.emptyHitCounter>0){this._boardStats.emptyHitCounter-=e;var r=10*this._boardStats.emptyHitCounter/t.Settings.EMPTY_HIT_DURATION;if(this._ballShock.scale.set(r/this._paddle.scale.x,r),this._boardStats.emptyHitCounter<=0){this._boardStats.emptyHitCounter=0,this._ballShock.visible=!1,this._paddle.removeChild(this._ballShock);var n=this._game.cache.getFrameByName("Game","PADDLE").height/2+t.Settings.BALL_DIAMETER/2,h=this.createBall(this._paddle.x,this._paddle.y-n);null!==h&&(h.setStickPosition(this._paddle.x,this._paddle.y-n),h.setSticked(!0))}}},e.prototype.tickStats=function(e){var i=this._game.physics.box2d;if(this._winTime<t.Settings.WON_TIME){var s=60+240*(this._winTime-1);if(i.frameRate=1/s,this.updateAll(e/(s/60)),this._winTime+=e,this._winTime>=t.Settings.WON_TIME){i.pause();var a=this.calcStars(),o=Math.floor(this._gameTime);t.Global.hiScore=this._score.hiScore;var n=t.Global.levelStats[this._level];n.stars=Math.max(a,n.stars),n.time=0===n.time?o:Math.min(o,n.time),this._level+1<t.Global.LEVELS&&(t.Global.levelStats[this._level+1].unlocked=!0),Utils.StorageUtils.save(),this._statsGroup.show(a,o)}}},e.prototype.updateAll=function(t){this.updateBalls(t),this.updateBonuses(t),this.updateMissiles(t),this.updateEnemies(t),this.updateCombos(t),this.paddle.tick(t)},e.prototype.destroyBrokenBricks=function(){for(var e=this._bricksCount-1;e>=0;e--){var i=this._bricks[e];if(i.toBeDestroyed){this.removeBrick(i),this._bricks[e]=this._bricks[--this._bricksCount],this._bricks[this._bricksCount]=null,this.addScore(t.Settings.SCORE_DESTROYED),this._game.rnd.integerInRange(0,99)<t.Settings.PROBABILITY_BONUS&&this.spawnBonus(i.x,i.y);var s=i.scale.x;this.shardsExplosion(i.x,i.y,s,!0),this.shardsParticles(i.x,i.y,s,5,7,10),--this._boardStats.bricksWinCount}}},e.prototype.shineBrick=function(t){if(0!==this._bricksCount&&(this._shineTime-=t)<=0){if(this._shineTime=this._game.rnd.realInRange(0,5),this._brickShine.animations.currentAnim.isPlaying)return;var e=this._game.rnd.integerInRange(0,this._bricksCount-1),i=this._bricks[e];if(!i.canShine)return;var s=this._brickShine;i.addChild(s),s.position.set(0,3),s.play("shine"),s.visible=!0}},e.prototype.shardsExplosion=function(e,i,s,a){this._emitters.shardsExplosion(e,i,s,a),a?Utils.AudioUtils.playSound(t.Sfx.BRICK_DESTROYED_1):Utils.AudioUtils.playSound(this._game.rnd.integerInRange(t.Sfx.BRICK_DAMAGED_1,t.Sfx.BRICK_DAMAGED_3))},e.prototype.shardsParticles=function(t,e,i,s,a,o){this._emitters.shardsParticles(t,e,i,s,a,o)},e.prototype.spawnBonus=function(e,i){var s=this._game.rnd.integerInRange(t.eBonusType.LIFE,t.eBonusType.TRIPLE);if(s===t.eBonusType.LIFE){if(this._lifeBonusAlreadySpawned)return;this._lifeBonusAlreadySpawned=!0}if(!(s===t.eBonusType.TRIPLE&&this._ballsCount>=t.Settings.BALLS_MAX)){var a=this._bonusesPool.createItem();null!==a&&(a.setPosition(e,i),a.setActive(!0),a.bonusType=s,this._bonusGroup.add(a),this._bonuses[this._bonusesCount++]=a,a.setVelocity(0,320*(t.Global.LOW?.4:1)))}},e.prototype.spawnMissile=function(e){for(var i=t.Global.LOW?.4:1,s=-1;2>s;s+=2){var a=this._missilesPool.createItem();if(null===a)return;a.toBeDestroyed=!1,a.setActive(!0),this._missilesGroup.add(a),this._missiles[this._missilesCount++]=a,a.setPosition(e.x+t.Settings.CANNON_OFFSET*s,e.y-70),a.setVelocity(0,-640*i),this._emitters.muzzle(e.x-1+40*s*i,e.y-80*i),Utils.AudioUtils.playSound(t.Sfx.CANNON_FIRE)}},e.prototype.updatePaddlePosition=function(e){if(0!==this._lostState||this._paused)return void this._paddle.setVelocity(0,0);var i=this._game;if(e.y<-i.height/2*.8)return void this._paddle.setVelocity(0,0);var s=this._paddle.width/2,a=t.Global.GAME_WIDTH,o=a/2-t.Settings.BORDER_WIDTH-s-2;e.x=Phaser.Math.clamp(e.x,-o,o);var n=e.x-this._paddle.x,r=this._paddle.body;if(Math.abs(n)>5){var h=Math.min(Math.abs(n),200)/200,l=Helper.quintic(0,1,1,1,1,h)*a*3.5;l*=Phaser.Math.sign(n),r.x<-o&&0>l?l=0:r.x>o&&l>0&&(l=0),r.velocity.x=l}else r.velocity.x=0;this._paddleLastVelocityX=r.velocity.x},e.prototype.fireMissile=function(t){2===this._state&&this._paddle.cannonReady&&this.spawnMissile(this._paddle.position)},e.prototype.calcContactPoint=function(e,i){if(e.GetWorldManifold(this._worldManifold),this._worldManifold.points.length>0){var s=this._worldManifold.points[0];i.set(-s.x*t.Settings.PTM,-s.y*t.Settings.PTM)}return i},Object.defineProperty(e.prototype,"activeBonus",{get:function(){return this._activeBallBonus},enumerable:!0,configurable:!0}),e.prototype.isStickTime=function(){return this._activeBallBonus==t.eBonusType.STICKY&&this._activeBallBonusTime>0},e.prototype.isFastTime=function(){return this._activeBallBonus==t.eBonusType.FAST&&this._activeBallBonusTime>0},e.prototype.isSlowTime=function(){return this._activeBallBonus==t.eBonusType.SLOW&&this._activeBallBonusTime>0},e.prototype.isPowerTime=function(){return this._activeBallBonus==t.eBonusType.POWER&&this._activeBallBonusTime>0},e.prototype.clearBonuses=function(){this._activeBallBonus=t.eBonusType.NONE,this._activeBallBonusTime=0,this.paddle.cancelCannon()},e.prototype.updateCombos=function(t){for(var e=this._combosCount-1;e>=0;e--){var i=this._combos[e];i.tick(t)||this.removeCombo(e)}},e.prototype.removeCombo=function(t){var e=this._combos[t];this._combosGroup.remove(e),this._combos[t]=this._combos[--this._combosCount],this._combos[this._combosCount]=null,this._combosPool.destroyItem(e)},e.prototype.updateBalls=function(e){for(var i=this._ballsCount-1;i>=0;i--){var s=this._balls[i];s.dead?(this.shockWave(s.x,s.y,16),this.removeBall(s),Utils.AudioUtils.playSound(t.Sfx.BALL_LOST)):s.tick(e)}},e.prototype.updateBonuses=function(e){this._activeBallBonus!==t.eBonusType.NONE&&(this._activeBallBonusTime-=e)<=0&&(this._activeBallBonus===t.eBonusType.STICKY&&this.unstickBalls(),this.clearBonuses(),this.setBallsFrame());for(var i=this._bonusesCount-1;i>=0;i--){var s=this._bonuses[i];s.activate&&this.activateBonus(s),(s.activate||s.toBeDestroyed)&&this.removeBonus(i)}},e.prototype.updateBonusText=function(){var e=this._activeBallBonus;if(e===t.eBonusType.NONE&&this._paddle.cannonTime<=0)this._bonusText.visible&&(this._bonusText.visible=!1);else{var i=t.eBonusType.NONE,s=0;this._paddle.cannonTime>0?(i=t.eBonusType.CANNON,s=this._paddle.cannonTime/t.Settings.CANNON_DURATION):e===t.eBonusType.SLOW?(i=e,s=this._activeBallBonusTime/t.Settings.BONUS_SLOW_DURATION):e===t.eBonusType.STICKY?(i=e,s=this._activeBallBonusTime/t.Settings.BONUS_STICKY_DURATION):e===t.eBonusType.POWER?(i=e,s=this._activeBallBonusTime/t.Settings.BONUS_POWER_DURATION):e===t.eBonusType.FAST&&(i=e,s=this._activeBallBonusTime/t.Settings.BONUS_FAST_DURATION),i!==t.eBonusType.NONE&&(this._bonusText.visible=!0,this._bonusText.tick(i,s))}},e.prototype.removeBonus=function(t){var e=this._bonuses[t];e.setActive(!1),this._bonusGroup.remove(e),this._bonuses[t]=this._bonuses[--this._bonusesCount],this._bonuses[this._bonusesCount]=null,this._bonusesPool.destroyItem(e)},e.prototype.updateMissiles=function(e){for(var i=this._missilesCount-1;i>=0;i--){var s=this._missiles[i];if(s.toBeDestroyed){this.removeMissile(i);var a=s.hitPoint;this._emitters.smallExplosion(a.x,a.y),Utils.AudioUtils.playSound(t.Sfx.CANNON_EXPLOSION)}}},e.prototype.removeMissile=function(t){var e=this._missiles[t];e.setActive(!1),this._missilesGroup.remove(e),this._missiles[t]=this._missiles[--this._missilesCount],this._missiles[this._missilesCount]=null,this._missilesPool.destroyItem(e)},e.prototype.activateBonus=function(e){if(0===this._lostState&&2===this._state){switch(e.bonusType){case t.eBonusType.LIFE:this._lives<10&&(++this._lives,this._emitters.newBall(this._gui.ball.x,this._gui.ball.y),this._gui.lives=this._lives,Utils.AudioUtils.playSound(t.Sfx.LIFE));break;case t.eBonusType.BOMB:this.setExplosion(e.x,e.y);var i=this._paddle.body;i.fixedRotation=!1,this.unstickBalls(),this._game.physics.box2d.world.DestroyJoint(this._paddleJoint),this._paddleJoint=null;var s=this._pt;return s.set(this._paddle.x,this._paddle.y+10),s.subtract(e.x,e.y),s.setMagnitude(50),i.data.ApplyLinearImpulse(new box2d.b2Vec2(-s.x,-s.y),new box2d.b2Vec2(-e.x/t.Settings.PTM,-e.y/t.Settings.PTM)),s=this._paddle.getVelocity(s),s.getMagnitudeSq()>25e4&&(s.setMagnitude(500),this._paddle.setVelocity(s.x,s.y)),this._lostState=2,this._lostExplosionCounter=0,this.looseLife(),void(this._lives<0?(this._lostTime=t.Settings.LOST_TIME_TOTAL,this._parent.stopMusic(),Utils.AudioUtils.playSound(t.Sfx.GAME_OVER)):this._lostTime=t.Settings.LOST_TIME_BOMB);case t.eBonusType.TRIPLE:if(this._ballsCount>0&&this._ballsCount<t.Settings.BALLS_MAX){var a=t.Global.GAME_WIDTH,o=-a/2+t.Settings.BORDER_WIDTH+t.Settings.BALL_DIAMETER/2,n=-o,r=-this._game.height/2+t.Settings.BORDER_WIDTH+t.Settings.BALL_DIAMETER/2,h=this._balls[0],s=h.getVelocity(this._pt);s.setMagnitude(t.Settings.BALL_DIAMETER);for(var l=0;2>l;l++){s.rotate(0,0,120,!0);var _=h.x+s.x,c=h.y+s.y;o>_?_=o:_>n&&(_=n),r>c&&(c=r);var d=this.createBall(_,c);null!==d&&d.setVelocity(s.x,s.y)}Utils.AudioUtils.playSound(t.Sfx.SPLIT_BALL)}break;case t.eBonusType.FAST:this._activeBallBonus=e.bonusType,this._activeBallBonusTime=t.Settings.BONUS_FAST_DURATION,this.unstickBalls(),Utils.AudioUtils.playSound(t.Sfx.FIRE);break;case t.eBonusType.POWER:this._activeBallBonus=e.bonusType,this._activeBallBonusTime=t.Settings.BONUS_POWER_DURATION,this.unstickBalls(),Utils.AudioUtils.playSound(t.Sfx.POWERBALL);break;case t.eBonusType.SLOW:this._activeBallBonus=e.bonusType,this._activeBallBonusTime=t.Settings.BONUS_SLOW_DURATION,this.unstickBalls(),Utils.AudioUtils.playSound(t.Sfx.FREEZE);break;case t.eBonusType.STICKY:this._paddle.isCannonReady()&&this._paddle.setCannon(!1),this._activeBallBonus=e.bonusType,this._activeBallBonusTime=t.Settings.BONUS_STICKY_DURATION,Utils.AudioUtils.playSound(t.Sfx.BALL_STICKY);break;case t.eBonusType.CANNON:this._activeBallBonus==t.eBonusType.STICKY&&(this._activeBallBonus=t.eBonusType.NONE),this._paddle.setCannon(!0),this.unstickBalls();break;case t.eBonusType.SHRINK:this._paddle.shrink(),Utils.AudioUtils.playSound(t.Sfx.PADDLE_SHRINK);break;case t.eBonusType.ENLARGE:this._paddle.enlarge(),Utils.AudioUtils.playSound(t.Sfx.PADDLE_ENLARGE)}this._emitters.bonus(e.x,e.y,e.typeFrame,this._paddle.x,this._paddle.y),this.setBallsFrame()}},e.prototype.setBallsFrame=function(){var e="BALL_NORMAL",i=this._activeBallBonus;i===t.eBonusType.SLOW?e="BALL_SLOW":i===t.eBonusType.FAST?e="BALL_FAST":i===t.eBonusType.STICKY?e="BALL_STICKY":i===t.eBonusType.POWER&&(e="BALL_POWER");for(var s=0;s<this._ballsCount;s++)this._balls[s].frameName=e},e.prototype.setExplosion=function(e,i){this._emitters.bigExplosion(e,i),this.shockWave(e,i,12),Utils.AudioUtils.playSound(t.Sfx.BOMB_EXPLOSION)},e.prototype.getFreeCombo=function(){var t=this._combosPool.createItem();return null!==t&&(this._combos[this._combosCount++]=t,this._combosGroup.add(t)),t},e.prototype.looseLife=function(){--this._lives<0&&this._title.init("GAME OVER",t.Settings.TITLE_GAMEOVER),this.clearBonuses(),this.updateBonusText()},e.prototype.setLives=function(t){this._lives=t,this._gui.lives=t},e.prototype.shockWave=function(t,e,i,s){void 0===s&&(s=!1),this._emitters.shockWave(t,e,i,s)},e.prototype.unstickBalls=function(){if(2===this._state&&!this._paused){for(var e=this._pt,i=0;i<this._ballsCount;i++){var s=this._balls[i];if(s.children.length>0&&(s.removeChild(this._ballArrow),this._ballArrow.visible=!1),s.sticked)if(s.setSticked(!1),this._initialBallLaunch){var a=Phaser.Math.degToRad(this._ballArrow.angle);s.setVelocity(Math.cos(a)*this._speed,Math.sin(a)*this._speed)}else e.copyFrom(s.position),e.subtract(this._paddle.x,this._paddle.y),e.x+=Phaser.Math.clamp(this._paddleLastVelocityX,-t.Settings.PTM,t.Settings.PTM),e.normalize(),s.setVelocity(e.x,e.y)}this._initialBallLaunch=!1}},e.prototype.updateCountDown=function(e){if(!(this._boardStats.bricksWinCount<=0)){var i=Math.floor(this._lastBrickCounter/3);if(this._lastBrickCounter-=e,this._lastBrickCounter<=0)this._lastBrick.toBeDestroyed=!0;else{var s=Math.floor(this._lastBrickCounter/3);i-s>0&&(this._emitters.numParticle(this._lastBrick.x,this._lastBrick.y,i),Utils.AudioUtils.playSound(t.Sfx.TICK))}}},e.prototype.adjustComboValue=function(e){this._boardStats.combosValue+=e,this.addScore(e*t.Settings.SCORE_COMBO)},e.prototype.addPaddleHit=function(){++this._boardStats.paddleHits,this._boardStats.emptyHits=0},e.prototype.addEmptyHit=function(){++this._boardStats.emptyHits},e.prototype.clearEmptyHit=function(){this._boardStats.emptyHits=0,this._boardStats.noHitTime=0},e.prototype.addTotalHitPoints=function(t){this._boardStats.totalHitpoints+=t},e.prototype.calcStars=function(){var t=0;this._lastBrickCounter>0&&++t;var e=this._boardStats.totalHitpoints/(2*this._boardStats.paddleHits),i=4*this._boardStats.combosValue/this._boardStats.bricksToBreak,s=e+i;return s>2&&(s=2),t=Math.round(t+s)},e.prototype.setBG=function(e){var i=new Phaser.Image(this._game,0,0,"Bg");i.anchor.set(.5,.5),i.width=i.width*(t.Global.LOW?.4:1),i.height=this._game.height,this._prerendered.renderXY(i,this._prerendered.width/2,this._prerendered.height/2);for(var s=this._game.cache.getFrameByName("GUI","Board"),a=new Phaser.Group(this._game,null),o=t.Global.GAME_WIDTH,n=this._prerendered.width/2,r=n-o/2,h=0;h<this._game.height;){var l=new Phaser.Sprite(this._game,n-o/2,h,"GUI","Board");l.anchor.x=1;var _=new Phaser.Sprite(this._game,n+o/2,h,"GUI","Board");_.anchor.x=1,_.scale.x=-1,a.add(l),a.add(_),r>s.width&&(l.width=r,_.width=r),h+=s.height}this._prerendered.renderXY(a,0,0)},Object.defineProperty(e.prototype,"lives",{get:function(){return this._lives},enumerable:!0,configurable:!0}),e.prototype.clearScore=function(){this._score.clear()},Object.defineProperty(e.prototype,"score",{get:function(){return this._score.score},set:function(e){this._score.score=e,this._gui.score=e,this._gui.changeImmediately(),e>=t.Global.hiScore&&this._gui.makeTrophyVisible()},enumerable:!0,configurable:!0}),e.prototype.addScore=function(t){this._score.addScore(t),this._gui.score=this._score.score},e.prototype.setSpeed=function(){var e=t.Global.difficulty;this._speed=t.Settings.SPEED_NORMAL_SLOW_GAME+e*t.Settings.SPEED_INCREMENT,this._speedCoef=t.Settings.SPEED_NORMAL_SLOW_GAME/this._speed},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speedCoef",{get:function(){return this._speedCoef},enumerable:!0,configurable:!0}),e.prototype.updateEnemies=function(e){for(var i=this._enemiesCount-1;i>=0;i--){var s=this._enemies[i];s.toBeDestroyed?(this.addScore(t.Settings.SCORE_ENEMY_DESTROYED*s.enemyScale),s.setActive(!1),this._enemyGroup.remove(s),this._enemies[i]=this._enemies[--this._enemiesCount],this._enemies[this._enemiesCount]=null,this._enemiesPool.destroyItem(s)):s.tick(e)&&this.spawnEnemy(s.x,s.y,!1,s.hiveType,s.enemyScale)}},e.prototype.spawnEnemy=function(e,i,s,a,o){var n=this._enemiesPool.createItem();if(null!==n){var r;if(s)r=t.eEnemyType.HIVE;else switch(o=this._game.rnd.realInRange(-.15,.15)+o,a){case 0:r=t.eEnemyType.BLOCKER;break;case 1:r=t.eEnemyType.PASSER;break;default:r=this._game.rnd.integerInRange(t.eEnemyType.BLOCKER,t.eEnemyType.PASSER)}n.init(e,i,o,r,a),r!==t.eEnemyType.HIVE&&(this.shockWave(e,i,4,!0),Utils.AudioUtils.playSound(t.Sfx.SWOOSH)),this._enemies[this._enemiesCount++]=n,this._enemyGroup.add(n)}},e.prototype.updateInitialEffect=function(e){if((this._initialEffectTime-=e)<=0){this._initialEffectTime=0;for(var i=0;4>i;i++)Utils.AudioUtils.playSound(t.Sfx.BOMB_EXPLOSION);this._bounceTween.start()}var s=1-this._initialEffectTime/t.Settings.INITIAL_EFFECT_DURATION,a=Phaser.Math.linear(t.Settings.INITIAL_EFFECT_SCALE,1,s),o=a*a;this._bricksGroup.scale.set(a,a),this._bricksGroup.alpha=1/a,this._shadowsGroup.scale.set(o,o),this._shadowsGroup.alpha=1/o},e.prototype.onPause=function(t){if(!this._paused&&2===this._state){this._state=5;var e=this._game.physics.box2d;e.pause(),this._gameLayer.exists=!1,this._gameLayer.visible=!1,this._menuLayer.exists=!0,this._menuLayer.visible=!0,this._paused=!0}},e.prototype.onUnpause=function(t){if(this._paused||5!==this._state){Utils.StorageUtils.save(),this._state=2;var e=this._game.physics.box2d;e.resume(),this._gameLayer.exists=!0,this._gameLayer.visible=!0,this._menuLayer.exists=!1,this._menuLayer.visible=!1,this._paused=!1}},e}();t.Board=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a,o){e.call(this,s,a,o,"GUI","STAR_GREY"),this.onStarComplete=new Phaser.Signal,this._star=new t.AnchoredSprite(s,0,0,"GUI","STAR_GOLD"),this.addChild(this._star),this._moveTween=s.add.tween(this).to({x:this.position.x,alpha:1},i.MOVE_TIME,Phaser.Easing.Sinusoidal.In,!1),this._starTween=s.add.tween(this._star).to({angle:0,alpha:1},i.STAR_TIME,Phaser.Easing.Linear.None,!1),this._starTween.onComplete.add(function(){Utils.AudioUtils.playSound(t.Sfx.IMPACT),this.onStarComplete.dispatch()},this),this._starTweenScale=s.add.tween(this._star.scale).to({x:1,y:1},i.STAR_TIME,Phaser.Easing.Linear.None,!1)}return __extends(i,e),i.prototype.move=function(t){this.position.x=t,this.alpha=0,this._star.scale.set(5,5),this._star.angle=90,this._star.alpha=0,this._star.visible=!1,this._moveTween.start()},i.prototype.star=function(){this._star.visible=!0,this._starTweenScale.start(),this._starTween.start(),Utils.AudioUtils.playSound(t.Sfx.SWOOSH)},i.MOVE_TIME=1e3,i.STAR_TIME=500,i}(t.AnchoredSprite);t.StarSlot=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a,o){e.call(this,s,a),this._starSlots=[],this._state=0;var n=t.Global.LOW?.4:1,r=Helper.NineImage.create(s,i.GLASS_WIDTH*n,i.GLASS_HEIGHT*n,"GUI","GLASS",80*n,60*n,80*n,60*n,!1);this._glass=new Phaser.Sprite(s,0,0,r),this._glass.anchor.set(.5,.5),this.add(this._glass),this._glassTween=s.add.tween(this._glass.scale).to({x:1,y:1},i.GLASS_DURATION,Phaser.Easing.Sinusoidal.In,!1),this._glassTween.onComplete.add(this.showTime,this),this._glassTweenAngle=s.add.tween(this._glass).to({angle:0},i.GLASS_DURATION,Phaser.Easing.Linear.None,!1);var h=new UI.Button(s,"Cancel","GUI","BUTTON_CANCEL");h.position.set(-i.BUTTON_X*n,i.BUTTON_Y*n),h.scaleOnOver.set(i.SCALE,i.SCALE),h.onClick.add(o.onExit,o),this.add(h),this._buttonCancel=h;var l=new UI.Button(s,"next","GUI","BUTTON_CONTINUE");l.position.set(i.BUTTON_X*n,i.BUTTON_Y*n),l.scaleOnOver.set(i.SCALE,i.SCALE),l.onClick.add(o.onNext,o),this.add(l),this._buttonNext=l,this._clock=new t.AnchoredSprite(s,i.CLOCK_X*n,i.CLOCK_Y*n,"GUI","CLOCK"),this.add(this._clock),this._timeText=new Phaser.BitmapText(s,i.TIME_X*n,i.TIME_Y*n,"FontFore","00:00",44*n),this._timeText.anchor.set(0,.5),this.add(this._timeText);for(var _=0;3>_;_++){var c=new t.StarSlot(s,(_-1)*i.STAR_X*n,0);c.onStarComplete.add(this.showStar,this),this._starSlots[_]=c,this.add(c)}this.exists=!1,this.visible=!1}return __extends(i,e),i.prototype.update=function(){switch(this._state){case 1:var e=Math.floor(10*this._currentTime);this._currentTime+=this.game.time.physicsElapsed,this._currentTime=Math.min(this._currentTime,i.TIME_DURATION),Math.floor(10*this._currentTime)-e>0&&Utils.AudioUtils.playSound(t.Sfx.TICK);var s=Math.floor(this._time*this._currentTime/i.TIME_DURATION);s!==this._prevTime&&(this._prevTime=s,this._timeText.text=Utils.StringUtils.padNumber(Math.floor(s/60),2)+":"+Utils.StringUtils.padNumber(s%60,2)),this._currentTime>=i.TIME_DURATION&&(this._state=2,this.showStar())}},i.prototype.show=function(e,s){this._time=s,this._prevTime=0,this._currentTime=0,this._stars=e,this._currentStar=0,this._state=0,this.exists=!0,this.visible=!0,this._buttonCancel.visible=!1,this._buttonNext.visible=!1,this._clock.visible=!1,this._timeText.visible=!1,this._glass.scale.set(0,0),this._glass.angle=65;for(var a=0;3>a;a++){var o=this._starSlots[a];o.move(.6*-i.GLASS_WIDTH)}this._glassTweenAngle.start(),this._glassTween.start(),t.Global.sponsor.sdk.levelUp()},i.prototype.showTime=function(){this._clock.visible=!0,this._timeText.visible=!0,this._state=1},i.prototype.showStar=function(){this._currentStar<this._stars?this._starSlots[this._currentStar++].star():(this._state=3,this.showButtons())},i.prototype.showButtons=function(){this._buttonCancel.visible=!0,this._buttonNext.visible=!0},i.GLASS_WIDTH=400,i.GLASS_HEIGHT=384,i.BUTTON_X=130,i.BUTTON_Y=105,i.CLOCK_X=-120,i.CLOCK_Y=-160,i.TIME_X=-16,i.TIME_Y=-105,i.STAR_X=95,i.SCALE=1.1,i.GLASS_DURATION=1e3,i.TIME_DURATION=1,i}(Phaser.Group);t.Stats=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(s,a){e.call(this,s,a);var o=t.Global.LOW?.4:1;this._backText=new Phaser.BitmapText(s,0,0,"FontBack","",i.BACK_TEXT_SIZE*o),this._backText.anchor.set(.5,.5),this.add(this._backText),this._foreText=new Phaser.BitmapText(s,0,0,"FontFore","",i.FRONT_TEXT_SIZE*o),this._foreText.anchor.set(.5,.5),this.add(this._foreText),this.exists=!1}return __extends(i,e),i.prototype.init=function(t,e){this._backText.text=t,this._foreText.text=t,this._timeMax=e,this._time=e,this._backText.alpha=0,this._foreText.alpha=0,this.exists=this.visible=!0},i.prototype.preUpdate=function(){var s=e.prototype.preUpdate.call(this);if(!s)return!1;if((this._time-=this.game.time.physicsElapsed)<=0)return this.exists=this.visible=!1,!1;var a=this._time/this._timeMax,o=2*(a-.5),n=t.Global.LOW?.4:1;this._foreText.x=i.FRONT_OFFSET*o*n,this._backText.x=i.BACK_OFFSET*o*n;var r=Math.sin(Math.PI*(1-a));return this._foreText.alpha=Math.min(1.3*r,1),this._backText.alpha=r/2,!0},i.BACK_TEXT_SIZE=88,i.FRONT_TEXT_SIZE=66,i.BACK_OFFSET=200,i.FRONT_OFFSET=100,i}(Phaser.Group);t.Title=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(t){function e(e){t.call(this,e,0,0,"Game"),this.alpha=.6,this._cropRect=new Phaser.Rectangle(0,0,0,0),this._topChar=new Phaser.Sprite(e,0,0,"Game"),this._topChar.alpha=.9,this._topChar.crop(this._cropRect,!1),this.addChild(this._topChar)}return __extends(e,t),e.prototype.setChar=function(t){var e=t-65,i=this.game.cache.getFrameByName("Game","FONT_GREY_A").index;this.frame=i+e;var s=this.game.cache.getFrameByName("Game","FONT_YELLOW_A").index,a=this.game.cache.getFrameByIndex("Game",s+e);return this._origFrame=a,this._topChar.frame=s+e,this._cropRect.width=a.width,this.setPercent(1),this.width+3},e.prototype.setPercent=function(t){var e=this._origFrame.height,i=e*t;this._topChar.y=e-i,this._cropRect.y=e-i,this._cropRect.height=i,this._topChar.updateCrop()},e}(Phaser.Sprite);t.BonusChar=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(i,s){e.call(this,i,s),this._chars=[];for(var a=0;12>a;a++)this._chars[a]=new t.BonusChar(i),this.add(this._chars[a]);this.hideChars(),this._currentBonus=t.eBonusType.NONE,this.visible=!1,this.y=i.height/2*.33}return __extends(i,e),i.prototype.hideChars=function(){for(var t=0;12>t;t++)this._chars[t].visible=!1},i.prototype.getTextForBonus=function(e){switch(e){case t.eBonusType.CANNON:return i.LASER_CANNON;case t.eBonusType.SLOW:return i.SLOW_BALL;case t.eBonusType.FAST:return i.FAST_BALL;case t.eBonusType.STICKY:return i.STICKY_BALL;case t.eBonusType.POWER:return i.POWERBALL}return null},i.prototype.setText=function(t){var e=this.getTextForBonus(t);if(null!==e.length){this.hideChars();for(var i=0,s=0,a=0;a<e.length;a++){var o=e.charCodeAt(a);if(32!==o){var n=this._chars[s++];n.position.x=i,i+=n.setChar(o),n.visible=!0}else i+=18}this._length=s,this.x=-i/2}},i.prototype.tick=function(t,e){t!==this._currentBonus&&(this.setText(t),this._currentBonus=t);for(var i=0;i<this._length;i++)this._chars[i].setPercent(e)},i.SLOW_BALL="SLOW BALL",i.FAST_BALL="FAST BALL",i.POWERBALL="POWERBALL",i.STICKY_BALL="STICKY BALL",i.LASER_CANNON="LASER CANNON",i}(Phaser.Group);t.BonusText=e}(Shards||(Shards={}));var Utils;!function(t){var e=function(){function t(){}return t.setSounds=function(e,i){void 0===i&&(i=null),t._sfx=e,t._sfxIds=i},t.addSound=function(e,i){t._sfxs[e]=i},t.playSound=function(e){var i;i="number"==typeof e?t._sfxIds[e]:e,Shards.Global.soundOn&&(null!==t._sfx?t._sfx.play(i):void 0!==t._sfxs[i]&&t._sfxs[i].play())},Object.defineProperty(t,"currentMusic",{get:function(){return t._currentMusic},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMusicPlaying",{get:function(){if(null===this._currentMusic||0===this._currentMusic.length)return!1;var e=t._music[t._currentMusic];return e.isPlaying},enumerable:!0,configurable:!0}),t.addMusic=function(e,i){t._music[e]=i},t.playMusic=function(e,i,s){if(void 0===i&&(i=!0),void 0===s&&(s=!1),(t._currentMusic!==e||s)&&(null!==t._currentMusic&&t._currentMusic.length>0&&t.stopMusic(),e in t._music&&Shards.Global.musicOn)){t._currentMusic=e;var a=t._music[e];a.loop=i,a.play(),i||a.onStop.addOnce(function(){t.onFinished.dispatch(e)},this)}},t.stopMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.stop(),t._currentMusic=""}},t.pauseMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){
var e=t._music[t._currentMusic];e.isPlaying&&e.pause()}},t.resumeMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.paused&&e.resume()}},t._sfx=null,t._sfxs={},t._music={},t._currentMusic="",t.onFinished=new Phaser.Signal,t}();t.AudioUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.supported=function(){var t=Shards.Global.game;return t.scale.compatibility.supportsFullScreen},t.isFullscreen=function(){return Shards.Global.game.scale.isFullScreen},t.changeFullscreen=function(){var t=Shards.Global.game,e=t.scale.isFullScreen;e?t.scale.stopFullScreen():t.scale.startFullScreen(!1,!1)},t}();t.FullscreenUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.ChangeAnimationPhaserJSONData=function(t){Phaser.AnimationParser.myCallback=t,Phaser.AnimationParser.JSONData=function(t,e){if(e.frames){for(var i=new Phaser.FrameData,s=e.frames,a=0;a<s.length;a++){var o=i.addFrame(new Phaser.Frame(a,s[a].frame.x,s[a].frame.y,s[a].frame.w,s[a].frame.h,s[a].filename));s[a].trimmed&&o.setTrim(s[a].trimmed,s[a].sourceSize.w,s[a].sourceSize.h,s[a].spriteSourceSize.x,s[a].spriteSourceSize.y,s[a].spriteSourceSize.w,s[a].spriteSourceSize.h),Phaser.AnimationParser.myCallback(o,s[a])}return i}}},t.AdjustTweenFunctions=function(){Phaser.TweenManager.prototype.removeFromUpdateQueue=function(t){var e=this._tweens.indexOf(t);-1!==e?this._tweens.splice(e,1):(e=this._add.indexOf(t),-1!==e&&this._add.splice(e,1))},Phaser.Tween.prototype.stopAndRemoveFromUpdateQueue=function(t){var e=this,i=e.stop(t);return e.manager.removeFromUpdateQueue(e),e.pendingDelete=!1,i}},t.AddBitmapFontAddMethod=function(){Phaser.Cache.prototype.addBitmapFontFromImage=function(t,e,i,s,a,o,n){var r=this.getImage(i,!0),h={url:e,data:r.data,font:null,base:r.base};void 0===o&&(o=0),void 0===n&&(n=0),"json"===a?h.font=Phaser.LoaderParser.jsonBitmapFont(s,h.base,o,n):h.font=Phaser.LoaderParser.xmlBitmapFont(s,h.base,o,n),this._cache.bitmapFont[t]=h,this._resolveURL(e,h)}},t}();t.PhaserUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t}();t.ScreenMetrics=e,function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE"}(t.eOrientation||(t.eOrientation={}));var i=t.eOrientation,s=function(){function t(){}return t.calculateScreenMetrics=function(t,s,a,o,n,r){void 0===a&&(a=i.LANDSCAPE);var h,l;if(h=window.innerWidth,l=window.innerHeight,(l>h&&a===i.LANDSCAPE||h>l&&a===i.PORTRAIT)&&!o){var _=h;h=l,l=_}("undefined"==typeof n||"undefined"==typeof r)&&(a===i.LANDSCAPE?(n=Math.round(1024*t/960),r=Math.round(720*s/600)):(n=Math.round(720*t/600),r=Math.round(1024*s/960)));var c=t/s,d=h/l,u=0,p=0,g=0,m=0;d>c?(m=s,g=2*Math.ceil(m*d/2),g=Math.min(g,n),u=(g-t)/2,p=0):(g=t,m=2*Math.ceil(g/d/2),m=Math.min(m,r),u=0,p=(m-s)/2);var S=(h+.01)/g,T=(l+.01)/m;return o&&a===i.LANDSCAPE&&(S=T),this.screenMetrics=new e,this.screenMetrics.windowWidth=h,this.screenMetrics.windowHeight=l,this.screenMetrics.defaultGameWidth=t,this.screenMetrics.defaultGameHeight=s,this.screenMetrics.maxGameWidth=n,this.screenMetrics.maxGameHeight=r,this.screenMetrics.gameWidth=g,this.screenMetrics.gameHeight=m,this.screenMetrics.scaleX=S,this.screenMetrics.scaleY=T,this.screenMetrics.offsetX=u,this.screenMetrics.offsetY=p,this.screenMetrics},t}();t.ScreenUtils=s}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){this.levelStats=[]}return t}(),i=function(){function t(){}return t.save=function(){var i=new e;i.musicOn=Shards.Global.musicOn,i.soundOn=Shards.Global.soundOn,i.currentLanguage=Shards.Global.currentLanguage,i.shardiensOn=Shards.Global.shardiensOn,i.lastLoadedLevel=Shards.Global.lastLoadedLevel,i.difficulty=Shards.Global.difficulty,i.hiScore=Shards.Global.hiScore,i.levelStats=Shards.Global.levelStats;var s=t.getLocalStorage();if(null!==s){var a=JSON.stringify(i);s.setItem("shards_save",a)}var o=Shards.Global.sponsor;1===o.id&&o.sdk.saveUserData(i)},t.load=function(){var e=null,i=Shards.Global.sponsor;if(1===i.id&&(e=i.sdk.loadUserData()),null===e||void 0===e){var s=t.getLocalStorage();if(null===s)return!1;e=JSON.parse(s.getItem("shards_save"))}return null===e||void 0===e?!1:(Shards.Global.musicOn=e.musicOn,Shards.Global.soundOn=e.soundOn,Shards.Global.currentLanguage=e.currentLanguage,Shards.Global.shardiensOn=e.shardiensOn,Shards.Global.lastLoadedLevel=e.lastLoadedLevel,Shards.Global.difficulty=e.difficulty,Shards.Global.hiScore=e.hiScore,Shards.Global.levelStats=e.levelStats,!0)},t.getLocalStorage=function(){try{if(2===Shards.Global.sponsor.id){var t=window.famobi?window.famobi:{};if(t.localStorage)return t.localStorage}if("localStorage"in window&&null!==window.localStorage)return localStorage}catch(e){return null}return null},t}();t.StorageUtils=i}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.padNumber=function(t,e,i){void 0===i&&(i="0");var s=t+"";return s.length>=e?s:new Array(e-s.length+1).join(i)+s},t.addSpacingToNumber=function(t,e){return void 0===e&&(e=" "),(""+t).replace(/\B(?=(\d{3})+(?!\d))/g,e)},t.formatTime=function(e,i,s,a){void 0===s&&(s=-1),void 0===a&&(a=":"),e=Math.floor(e);var o=!1,n="";if(e>3600||0===i){var r=Math.floor(e/3600);n+=(-1!==s?t.padNumber(r,s):r)+a,e%=3600,o=!0}if(o===!0||e>60||1===i){var h=Math.floor(e/60);n+=(-1!==s?t.padNumber(h,s):h)+a,e%=60,o=!0}var l=e;return n+=-1!==s?t.padNumber(l,s):l},t}();t.StringUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.isAndroidStockBrowser=function(){var t=navigator.userAgent,e=/Android/.test(t),i=/Chrome/.test(t);return e&&!i},t}();t.SystemUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.setTexts=function(e){t._texts=e},t.getText=function(e,i){if(2===Shards.Global.sponsor.id&&"function"==typeof window.famobi.__){var s=window.famobi.__(e);return"undefined"==typeof s?"undefined":s}if(null===t._texts)return"Texts not set";var a=t._texts;if(void 0===a[e])return"";void 0===i&&(i=Shards.Global.currentLanguage);var o=a[e][i];return void 0===o&&(Shards.Global.currentLanguage="en",o=a[e][Shards.Global.currentLanguage]),o},t.game=null,t._texts=null,t}();t.TextUtils=e}(Utils||(Utils={}));var Shards;!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.prototype.init=function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!1;var e=this.screenDims();if(this.game.device.desktop){this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setMinMax(.25*this.game.width,.25*this.game.height,2.5*this.game.width,2.5*this.game.height),this.scale.setUserScale(e.scaleX,e.scaleY),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setResizeCallback(this.gameResized,this);var i=document.getElementById("body").style;i.backgroundImage="url('assets/pattern.png')",i.backgroundRepeat="repeat",this.game.canvas.style.boxShadow="0 0 40px black"}else this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setUserScale(e.scaleX,e.scaleY),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.forceOrientation(!1,!0),this.scale.setResizeCallback(this.gameResized,this),this.scale.onOrientationChange.add(this.orientationChange,this);this.orientationChange(this.scale,"",!0),Utils.FullscreenUtils.supported&&(this.scale.onFullScreenChange.add(this.onFullscreenChange,this),this.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL);var s=this;if(2===t.Global.sponsor.id&&"function"==typeof window.famobi.onOrientationChange&&(window.famobi.onOrientationChange(function(){s.orientationChange_Famobi()}),this.orientationChange_Famobi()),this.game.device.android){var a=navigator.userAgent,o=parseFloat(a.slice(a.indexOf("Android")+8));(4.3>=o||Phaser.Device.isAndroidStockBrowser)&&(t.Global.NO_ANIMS=!0,t.Global.MAX_MUSIC=1)}},i.prototype.preload=function(){var e="assets/"+t.Global.assetsPath;this.load.atlas("Splash",e+"Splash.png",e+"Splash.json"),this.load.xml("SplashFontData",e+"SplashFont.xml")},i.prototype.create=function(){this.cache.addBitmapFontFromImage("SplashFont",null,"Splash",this.cache.getXML("SplashFontData"),"xml"),t.Global.correctOrientation?"undefined"==typeof t.Global.sponsor.logo?this.game.state.start("Preloader",!0,!1):3===t.Global.sponsor.id?(this.game.state.add("Logo",t.Logo),this.game.state.start("Logo",!0,!1)):5===t.Global.sponsor.id&&(this.game.state.add("Logo2",t.Logo2),this.game.state.start("Logo2",!0,!1)):(this.game.state.add("OrientationWait",t.OrientationWait),this.game.state.start("OrientationWait"))},i.prototype.screenDims=function(){return this.game.device.desktop?Utils.ScreenUtils.calculateScreenMetrics(t.Global.GAME_WIDTH,t.Global.GAME_HEIGHT,Utils.eOrientation.LANDSCAPE,this.game.device.desktop,t.Global.MAX_GAME_WIDTH_DESKTOP,t.Global.MAX_GAME_HEIGHT_DESKTOP):Utils.ScreenUtils.calculateScreenMetrics(t.Global.GAME_WIDTH,t.Global.GAME_HEIGHT,Utils.eOrientation.PORTRAIT,this.game.device.desktop,t.Global.MAX_GAME_WIDTH_MOBILE,t.Global.MAX_GAME_HEIGHT_MOBILE)},i.prototype.gameResized=function(t,e){t.incorrectOrientation||this.time.events.add(200,function(){var t=Utils.ScreenUtils.screenMetrics,e=t.scaleX,i=t.scaleY;if(t=this.screenDims(),t.gameWidth!==this.game.width||t.gameHeight!==this.game.height||Math.abs(t.scaleX-e)>.001||Math.abs(t.scaleY-i)>.001){this.scale.setGameSize(t.gameWidth,t.gameHeight),this.scale.setUserScale(t.scaleX,t.scaleY);var s=this.game.state.getCurrentState();this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width/2,this.game.height/2),this.camera.focusOnXY(0,0),"function"==typeof s.onResize&&s.onResize(this.game.width,this.game.height)}},this)},i.prototype.orientationChange_Famobi=function(){var e=window.famobi.getOrientation();t.Global.correctOrientation=this.game.device.desktop&&"landscape"===e||!this.game.device.desktop&&"portrait"===e,t.Global.correctOrientation?this.leaveIncorrectOrientation():this.enterIncorrectOrientation()},i.prototype.orientationChange=function(e,i,s){(2!==t.Global.sponsor.id||"function"!=typeof window.famobi.onOrientationChange)&&(t.Global.correctOrientation=this.game.device.desktop?e.isLandscape:e.isPortrait,t.Global.correctOrientation?this.leaveIncorrectOrientation():this.enterIncorrectOrientation())},i.prototype.enterIncorrectOrientation=function(){t.Global.correctOrientation=!1,document.getElementById("orientation").style.display="block";var e=this.game.state.getCurrentState();e===this.game.state.states.Play&&e.pause()},i.prototype.leaveIncorrectOrientation=function(){t.Global.correctOrientation=!0,document.getElementById("orientation").style.display="none"},i.prototype.onFullscreenChange=function(t){t.isFullScreen;var e=this.game.state.getCurrentState();"function"==typeof e.onFullscreenChange&&e.onFullscreenChange(t.isFullScreen)},i}(Phaser.State);t.Boot=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this),this._sprHelp=[],this._txtBonus=[],this._btnLangs=[],this._txtLangs=[],this._showCongrats=!1,t.Global.LOW&&(i.TEXT_SIZE*=.4,i.PARTICLES_MAX=20,i.HEADLINE_ROW*=.4,i.HEADLINE_ROW_SETTINGS*=.4,i.CREDITS_ROW*=.4,i.HELP_ROW*=.4,i.LANG_ROW*=.4,i.FLAG_X*=.4,i.FLAG_Y*=.4,i.BUTTON_DIM*=.4)}return __extends(i,e),Object.defineProperty(i.prototype,"congrats",{set:function(t){this._showCongrats=!0},enumerable:!0,configurable:!0}),i.prototype.onResize=function(t,e){this._bg.width=t,this._bg.height=e},i.prototype.onFullscreenChange=function(e){t.Global.fullscreenOption&&(this._tglFullScreen.toggled=e)},i.prototype.create=function(){this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width,this.game.height),this.camera.focusOnXY(0,0),t.Global.LOW&&(this.time.desiredFps=60);var e=this.add.image(0,0,"Title",0,this.world);e.anchor.set(.5,.5),e.width=this.game.width,e.height=this.game.height,this._bg=e,this._rimX=t.Global.GAME_WIDTH/40,this._rimY=t.Global.GAME_HEIGHT/40,this._buttonsSpace=i.BUTTON_DIM/3,this._greyBG=this.add.sprite(0,-this.game.height/2,"GUI","GRADIENT",this.world),this._greyBG.width=(.5-i.MENU_GRAY_START_RATIO)*this.game.width,this._greyBG.height=this.game.height;var s=80*(t.Global.LOW?.4:1),a=60*(t.Global.LOW?.4:1),o=Helper.NineImage.create(this.game,this.game.width-2*this._rimX,this.game.height-3*this._rimY,"GUI","GLASS",s,a,s,a,!1);if(this._glass=new Phaser.Sprite(this.game,0,0,o),this.world.add(this._glass),this._layerMain=new Phaser.Group(this.game,this.world),this._layerOptions=new Phaser.Group(this.game,this.world),this._layerHelp=new Phaser.Group(this.game,this.world),this._layerCredits=new Phaser.Group(this.game,this.world),this._layerCongrats=new Phaser.Group(this.game,this.world),this._layerLangs=new Phaser.Group(this.game,this.world),this._sprLogo=new t.AnchoredSprite(this.game,0,0,"GUI","LOGO"),this._layerMain.add(this._sprLogo),this._txtPlay=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_BUTTON_PLAY"),i.TEXT_SIZE,this._layerMain),this._txtPlay.anchor.set(0,.5),this._btnPlay=new t.ButtonWithText(this.game,"Play","GUI","ICON_PLAY",this._txtPlay),this._btnPlay.onClick.add(function(){this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,5,!0)},this),this._layerMain.add(this._btnPlay),this._txtHelp=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_BUTTON_HELP"),i.TEXT_SIZE,this._layerMain),this._txtHelp.anchor.set(0,.5),this._btnHelp=new t.ButtonWithText(this.game,"Help","GUI","ICON_HELP",this._txtHelp),this._btnHelp.onClick.add(function(){this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,4)},this),this._layerMain.add(this._btnHelp),this._txtOptions=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_BUTTON_SETTINGS"),i.TEXT_SIZE,this._layerMain),this._txtOptions.anchor.set(0,.5),this._btnOptions=new t.ButtonWithText(this.game,"Options","GUI","ICON_SETTINGS",this._txtOptions),this._btnOptions.onClick.add(function(){this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,2)},this),this._layerMain.add(this._btnOptions),this._txtCredits=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_BUTTON_ABOUT"),i.TEXT_SIZE,this._layerMain),this._txtCredits.anchor.set(0,.5),this._btnCredits=new t.ButtonWithText(this.game,"Credits","GUI","ICON_ABOUT",this._txtCredits),this._btnCredits.onClick.add(function(){this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,3)},this),this._layerMain.add(this._btnCredits),t.Global.showLanguages&&(this._btnCurrentLang=new t.FlagButton(this.game,t.Global.currentLanguage,"GUI"),this._btnCurrentLang.onClick.add(function(){this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,7)},this),this._layerMain.add(this._btnCurrentLang)),this._txtHiScore=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_HISCORE")+Utils.StringUtils.padNumber(t.Global.hiScore,10),i.TEXT_SIZE,this._layerMain),this._txtHiScore.anchor.set(.5,.5),"undefined"!=typeof t.Global.sponsor.soundcontrolls&&(this._tglMMusic=new UI.Toggle(this.game,"Music","GUI","ICON_MUSIC_OFF","ICON_MUSIC_ON"),this._tglMMusic.scale.set(.6,.6),this._tglMMusic.scaleOnOver.set(1.1,1.1),this._tglMMusic.toggled=t.Global.musicOn,this._tglMMusic.onClick.add(function(e){t.Global.musicOn=e.toggled,t.Global.musicOn?Utils.AudioUtils.playMusic("MainMusic",!0):Utils.AudioUtils.stopMusic(),Utils.StorageUtils.save()},this),this._layerMain.add(this._tglMMusic),this._tglMSound=new UI.Toggle(this.game,"Sound","GUI","ICON_SOUND_OFF","ICON_SOUND_ON"),this._tglMSound.scale.set(.6,.6),this._tglMSound.scaleOnOver.set(1.1,1.1),this._tglMSound.toggled=t.Global.soundOn,this._tglMSound.onClick.add(function(e){t.Global.soundOn=e.toggled,Utils.StorageUtils.save()},this),this._layerMain.add(this._tglMSound)),t.Global.fullscreenOption&&(this._tglFullScreen=new UI.Toggle(this.game,"FullScreen","GUI","FULLSCREEN_OFF","FULLSCREEN_ON"),this._tglFullScreen.scaleOnOver.set(1.1,1.1),this._tglFullScreen.onClick.add(function(t){Utils.FullscreenUtils.changeFullscreen()},this),this._tglFullScreen.toggled=Utils.FullscreenUtils.isFullscreen(),this._layerMain.add(this._tglFullScreen)),2===t.Global.sponsor.id||5===t.Global.sponsor.id){var n;2===t.Global.sponsor.id?n=this.game.add.button(0,0,"MoreGames",function(){Utils.AudioUtils.playSound(t.Sfx.CLICK),t.Global.sponsor.sdk.moreGamesLink()},this):5===t.Global.sponsor.id&&(n=this.game.add.button(0,0,"Logo",function(){Utils.AudioUtils.playSound(t.Sfx.CLICK),window.open("http://www.addictinggames.com","_blank")},this)),n.anchor.setTo(0,1);var r=t.Global.LOW?.4:1;n.scale.setTo(.35*r,.35*r),this._layerMain.add(n),this._moreGames=n}this._txtMusic=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_TOGGLE_MUSIC"),i.TEXT_SIZE,this._layerOptions),this._txtMusic.anchor.set(0,.5),this._tglMusic=new t.ToggleWithText(this.game,"Music","GUI","ICON_MUSIC_OFF","ICON_MUSIC_ON",this._txtMusic),this._tglMusic.toggled=t.Global.musicOn,this._tglMusic.onClick.add(function(e){t.Global.musicOn=e.toggled,t.Global.musicOn?Utils.AudioUtils.playMusic("MainMusic",!0):Utils.AudioUtils.stopMusic()},this),this._layerOptions.add(this._tglMusic),this._txtSound=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_TOGGLE_SOUND"),i.TEXT_SIZE,this._layerOptions),this._txtSound.anchor.set(0,.5),this._tglSound=new t.ToggleWithText(this.game,"Sound","GUI","ICON_SOUND_OFF","ICON_SOUND_ON",this._txtSound),this._tglSound.toggled=t.Global.soundOn,this._tglSound.onClick.add(function(e){t.Global.soundOn=e.toggled},this),this._layerOptions.add(this._tglSound),this._txtShardiens=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_TOGGLE_SHARDIENS"),i.TEXT_SIZE,this._layerOptions),this._txtShardiens.anchor.set(0,.5),this._tglShardiens=new t.ToggleWithText(this.game,"Shardiens","GUI","SHARDIENS_OFF","SHARDIENS_ON",this._txtShardiens),this._tglShardiens.toggled=t.Global.shardiensOn,this._tglShardiens.onClick.add(function(e){t.Global.shardiensOn=e.toggled},this),this._layerOptions.add(this._tglShardiens),this._txtOptionBack=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_BUTTON_BACK"),i.TEXT_SIZE,this._layerOptions),this._txtOptionBack.anchor.set(0,.5),this._btnOptionBack=new t.ButtonWithText(this.game,"OptionBack","GUI","ICON_CANCEL",this._txtOptionBack),this._btnOptionBack.onClick.add(function(){Utils.StorageUtils.save(),this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,1)},this),this._layerOptions.add(this._btnOptionBack);var h=Helper.TextWrapper.wrapText(this.game,Utils.TextUtils.getText("TXT_CREDITS"),this.game.width-4*this._rimX,this.game.height,"Font",i.TEXT_SIZE);this._txtAbout=new Phaser.BitmapText(this.game,0,0,"Font",h[0],i.TEXT_SIZE),this._layerCredits.add(this._txtAbout),this._logos=new Phaser.Group(this.game,this._layerCredits);var l=t.Global.LOW?.4:1;this.add.sprite(20*l,40*l,"GUI","BOX2D",this._logos),this.add.sprite(-20*l,0*l,"GUI","PHASER",this._logos).anchor.set(1,0);for(var _=this.game.width-4*this._rimX-60*(t.Global.LOW?.4:1),c=0;10>c;c++){this._sprHelp[c]=new t.AnchoredSprite(this.game,0,0,"GUI","BONUS_"+c),this._layerHelp.add(this._sprHelp[c]),this._sprHelp[c].anchor.y=.5;var d=Helper.TextWrapper.wrapText(this.game,Utils.TextUtils.getText("TXT_HELP_"+c),_,1e3,"Font",i.TEXT_SIZE);this._txtBonus[c]=this.add.bitmapText(0,0,"Font",d[0],i.TEXT_SIZE,this._layerHelp),this._txtBonus[c].anchor.y=.5}var u=Helper.TextWrapper.wrapText(this.game,Utils.TextUtils.getText("TXT_CONGRATS"),this.game.width-4*this._rimX,this.game.height,"Font",i.TEXT_SIZE);this._txtCongrats=new Phaser.BitmapText(this.game,0,0,"Font",u[0],i.TEXT_SIZE,"center"),this._layerCongrats.add(this._txtCongrats),this._txtCongrats.anchor.set(.5,0),this._sprGlow=this.add.sprite(0,0,"GUI","Glow",this._layerLangs),this._sprGlow.anchor.set(.5,.5),this._sprGlow.position.set(2,10),this._sprGlow.scale.set(4,4),this.add.tween(this._sprGlow).to({angle:360},12e3,Phaser.Easing.Linear.None,!0,0,-1);for(var p=t.Global.supportedLanguages,c=0;c<p.length;c++){var g=new t.FlagButton(this.game,p[c],"GUI");this._layerLangs.add(g),g.onClick.add(this.onChangeLanguage,this),p[c]===t.Global.currentLanguage&&(g.glow=this._sprGlow),this._btnLangs[c]=g,2!==t.Global.sponsor.id&&(this._txtLangs[c]=this.add.bitmapText(0,0,"Font",Utils.TextUtils.getText("TXT_LANGS",p[c]),i.TEXT_SIZE,this._layerLangs),this._txtLangs[c].anchor.y=.5)}this._btnBack=new UI.Button(this.game,"Back","GUI","ICON_CANCEL"),this._btnBack.scaleOnOver.set(1.1,1.1),this._btnBack.onClick.add(function(){this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!0,i.HEADLINE_ROW,1)},this),this.world.add(this._btnBack),this._fader=new t.Fader(this.game,"GUI","WHITE"),this._fader.onFadeFinished.add(this.faderFinished,this),this.world.add(this._fader);var m=new t.ParticlesEmitter(this.game,0,0,i.PARTICLES_MAX);m.clear(),m.particleClass=t.AnimatedParticle,m.lifetime=2,m.setAlpha(2,2),m.setAlphaChange(t.eParameterChangeType.IN_TIME,-1.8,2),m.makeParticles("GUI",null,i.PARTICLES_MAX,[t.Animations.SHARDS_PARTICLES]),this._emitter=m,this.world.add(this._emitter),this._time=0,this._parabolicTimerTime=0,this._animationReversed=!0,this._time=0,this._parabolicAddBrightness=0,this._showEffect=!0,this._showCongrats?(this._showCongrats=!1,this._state=6,this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.CREDITS_ROW,-1)):(this._state=1,this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.HEADLINE_ROW,-1,!0)),this._fader.fadeIn(),Utils.AudioUtils.stopMusic(),Utils.AudioUtils.playMusic("MainMusic",!0)},i.prototype.onChangeLanguage=function(e){e.glow=this._sprGlow,t.Global.currentLanguage=e.buttonName,this._btnCurrentLang.setFlag(e.buttonName),this._txtPlay.text=Utils.TextUtils.getText("TXT_BUTTON_PLAY"),this._txtHelp.text=Utils.TextUtils.getText("TXT_BUTTON_HELP"),this._txtOptions.text=Utils.TextUtils.getText("TXT_BUTTON_SETTINGS"),this._txtCredits.text=Utils.TextUtils.getText("TXT_BUTTON_ABOUT"),this._txtHiScore.text=Utils.TextUtils.getText("TXT_HISCORE")+Utils.StringUtils.padNumber(t.Global.hiScore,10),this._txtMusic.text=Utils.TextUtils.getText("TXT_TOGGLE_MUSIC"),this._txtSound.text=Utils.TextUtils.getText("TXT_TOGGLE_SOUND"),this._txtShardiens.text=Utils.TextUtils.getText("TXT_TOGGLE_SHARDIENS"),this._txtOptionBack.text=Utils.TextUtils.getText("TXT_BUTTON_BACK");var s=Helper.TextWrapper.wrapText(this.game,Utils.TextUtils.getText("TXT_CREDITS"),this.game.width-4*this._rimX,this.game.height,"Font",i.TEXT_SIZE);this._txtAbout.text=s[0];for(var a=0;a<this._txtBonus.length;a++){var o=Helper.TextWrapper.wrapText(this.game,Utils.TextUtils.getText("TXT_HELP_"+a),this.game.width-4*this._rimX-60*(t.Global.LOW?.4:1),1e3,"Font",i.TEXT_SIZE);this._txtBonus[a].text=o[0]}var n=Helper.TextWrapper.wrapText(this.game,Utils.TextUtils.getText("TXT_CONGRATS"),this.game.width-4*this._rimX,this.game.height,"Font",i.TEXT_SIZE);this._txtCongrats.text=n[0],Utils.StorageUtils.save()},i.prototype.faderFinished=function(t){t||this.game.state.start("Levels",!0,!1)},i.prototype.update=function(){this.updateAnimation(this.game.time.physicsElapsed/1),this.updateScreen()},i.prototype.updateScreen=function(){var e,s,a,o=this.game.width,n=this.game.height,r=o/2,h=n/2,l=t.Global.LOW?.4:1;switch(this._state){case 1:s=n*i.MENU_TOP_RATIO-h,e=o*i.MENU_ICON_LEFT_RATIO;var _=o*i.MENU_TEXT_START_RATIO;this._greyBG.position.x=i.MENU_GRAY_START_RATIO*o+this.getAnimX(s-i.BUTTON_DIM,this._greyBG.width),this.paintGameTitle(),a=r+e+i.BUTTON_DIM;var c=s+(i.BUTTON_DIM+this._buttonsSpace);this._btnPlay.position.set(e-this.getAnimX(s,a),c),this._txtPlay.position.set(_+this.getAnimX(s,r-_),c),s+=i.BUTTON_DIM+this._buttonsSpace,c=s+(i.BUTTON_DIM+this._buttonsSpace),this._btnHelp.position.set(e-this.getAnimX(s,a),c),this._txtHelp.position.set(_+this.getAnimX(s,r-_),c),s+=i.BUTTON_DIM+this._buttonsSpace,c=s+(i.BUTTON_DIM+this._buttonsSpace),this._btnOptions.position.set(e-this.getAnimX(s,a),c),this._txtOptions.position.set(_+this.getAnimX(s,r-_),c),s+=i.BUTTON_DIM+this._buttonsSpace,c=s+(i.BUTTON_DIM+this._buttonsSpace),this._btnCredits.position.set(e-this.getAnimX(s,a),c),this._txtCredits.position.set(_+this.getAnimX(s,r-_),c),t.Global.showLanguages&&(s=-this.game.height/2+i.FLAG_X,e=-this.game.width/2+i.FLAG_Y,this._btnCurrentLang.position.set(e,s-this.getAnimX(.75*n,h))),"undefined"!=typeof t.Global.sponsor.soundcontrolls&&(s=-this.game.height/2+1.2*i.FLAG_X,e=this.game.width/2-1.2*i.FLAG_Y,this._tglMSound.position.set(e,s-this.getAnimX(.75*n,h)),e-=2*i.FLAG_Y,this._tglMMusic.position.set(e,s-this.getAnimX(.75*n,h))),t.Global.fullscreenOption&&(s=-this.game.height/2+1.2*i.FLAG_X,e=this.game.width/2-1.2*i.FLAG_Y,this._tglFullScreen.position.set(e,s-this.getAnimX(.75*n,h))),(2===t.Global.sponsor.id||5===t.Global.sponsor.id)&&(s=this.game.height/2-.3*i.FLAG_Y,e=-this.game.width/2+.3*i.FLAG_X,this._moreGames.position.set(e,s+this.getAnimX(s,h))),e=0,s=.89*n-h+this.getAnimX(n*i.MENU_TOP_RATIO,h);var d=this.time.time;e+=Math.sin(Phaser.Math.degToRad(d/32)%360)*(o/5),s-=Math.sin(Phaser.Math.degToRad(d/16)%360)*(n/80),this._txtHiScore.position.set(e,s);break;case 2:s=.2*n-h,e=o*i.MENU_ICON_LEFT_RATIO;var _=o*i.MENU_TEXT_START_RATIO;this._greyBG.position.x=i.MENU_GRAY_START_RATIO*o+this.getAnimX(s-i.BUTTON_DIM,this._greyBG.width),a=r+e+i.BUTTON_DIM;var c=s+(i.BUTTON_DIM+1.5*this._buttonsSpace);this._tglMusic.position.set(e-this.getAnimX(s,a),c),this._txtMusic.position.set(_+this.getAnimX(s,r-_),c),s+=i.BUTTON_DIM+1.5*this._buttonsSpace,c=s+(i.BUTTON_DIM+1.5*this._buttonsSpace),this._tglSound.position.set(e-this.getAnimX(s,a),c),this._txtSound.position.set(_+this.getAnimX(s,r-_),c),s+=i.BUTTON_DIM+1.5*this._buttonsSpace,c=s+(i.BUTTON_DIM+1.5*this._buttonsSpace),this._tglShardiens.position.set(e-this.getAnimX(s,a),c),this._txtShardiens.position.set(_+this.getAnimX(s,r-_),c),s+=i.BUTTON_DIM+1.5*this._buttonsSpace,c=s+(i.BUTTON_DIM+1.5*this._buttonsSpace),this._btnOptionBack.position.set(e-this.getAnimX(s,a),c),this._txtOptionBack.position.set(_+this.getAnimX(s,r-_),c);break;case 3:this.paintGlass(),s=4*this._rimY-h,this._txtAbout.position.set(2*this._rimX-r+this.getAnimX(i.CREDITS_ROW,o),s),s+=this._txtAbout.height+this._rimY,this._logos.position.set(0,s+this.getAnimX(s,n));break;case 6:this.paintGlass(),s=4*this._rimY-h,this._txtCongrats.position.set(0,s+this.getAnimX(i.CREDITS_ROW,n));break;case 4:this.paintGlass();var u=80*l;e=2*this._rimX-r,s=4*this._rimY-h;for(var p=e+60*l+this._rimX,g=0;10>g;g++)this._sprHelp[g].position.set(e-this.getAnimX(s,o),s),this._txtBonus[g].position.set(p+this.getAnimX(s,o),s),s+=Math.max(u,this._txtBonus[g].textHeight+this._rimX/2);break;case 7:this.paintGlass();for(var m=140*l,S=t.Global.supportedLanguages,T=-((S.length-1)*m)/2,g=0;g<S.length;g++)2!==t.Global.sponsor.id?(this._btnLangs[g].position.set(-80*l-this.getAnimX(T-100*l,o),T),this._txtLangs[g].position.set(50*l+this.getAnimX(T-100*l,o),T)):this._btnLangs[g].position.set(0-this.getAnimX(T-100*l,o),T),T+=m}},i.prototype.paintGlass=function(){var e=2*this._rimY-this.game.height/2;this._glass.position.set(this._rimX-this.game.width/2,e+this.getAnimX(e,this.game.height));var i=(this.animationRunning(),60*(t.Global.LOW?.4:1));this._btnBack.position.set(this.game.width/2-2*this._rimX-i,e-this.getAnimX(.25*-this.game.height,2*this._rimY+i))},i.prototype.parabolicTimerTick=function(t){this._parabolicTimerTime=Math.min(this._parabolicTimerTime+t,i.SHARDS_DURATION);var e=this._parabolicTimerTime/i.SHARDS_DURATION;return-4*e*e+4*e},i.prototype.paintGameTitle=function(){var e=!1,s=0,a=1,o=0,n=.2*this.game.height-this.game.height/2;if(this._showEffect){if(this._time>=1)if(this._parabolicTimerTime<i.SHARDS_DURATION){if(this._parabolicAddBrightness=this.parabolicTimerTick(this.game.time.physicsElapsed),this._parabolicTimerTime>i.SHARDS_DURATION/2&&(e=!0,s=1-this._parabolicAddBrightness,a+=1.5*this._parabolicAddBrightness),this._parabolicTimerTime>=i.SHARDS_DURATION){Utils.AudioUtils.playSound(t.Sfx.BRICK_DESTROYED_1),Utils.AudioUtils.playSound(t.Sfx.BRICK_DESTROYED_1),this._showEffect=!1;for(var r=0;r<i.PARTICLES_MAX;r++){var h=this.game.rnd.integerInRange(-this._sprLogo.width/2,this._sprLogo.width/2),l=this.game.rnd.integerInRange(-this._sprLogo.height/2,this._sprLogo.height/2),_=r>=i.PARTICLES_MAX-3;this._emitter.emitAt(o+h,n+l);var c=this._emitter.emitParticle();if(null!==c)if(_)l=0,h=(r-(i.PARTICLES_MAX-2))*(this._sprLogo.width/4),c.visual.position.set(o+h,n+l),c.lifetime=1.05,c.setFrame("SHARDS_EXPLOSION"),c.alpha=1.28,c.setAlphaChange(t.eParameterChangeType.IN_TIME,-1.28/1.05),c.visual.scale.set(1,1),c.setScaleChange(t.eParameterChangeType.IN_TIME,1);else{c.lifetime=1.5,c.setPhysics(3*h,3*l),c.setRandomAnim();var d=1+this.game.rnd.realInRange(0,2);c.visual.scale.set(d,d),c.setScaleChange(t.eParameterChangeType.IN_TIME,2),c.alpha=2,c.setAlphaChange(t.eParameterChangeType.IN_TIME,-2/1.5)}}}}else e=!0,s=1}else if(e=!0,this.animationRunning()){var u=i.ANIMATION_TIME/2;this._time>u&&(s=(this._time-u)/u)}else s=1;this._sprLogo.position.set(o,n),this._sprLogo.alpha=Phaser.Math.clamp(s,0,1),this._sprLogo.scale.set(a,a),this._fader.isRunning()||(this._fader.fade=this._parabolicAddBrightness)},i.prototype.getAnimX=function(t,e,i){void 0===i&&(i=!0),t+=this.game.height/2;var s=t/this.game.height;if(s*=this._originalAnimationTime-this._animationSinCycle,s=this._time<s?0:this._time>=s+this._animationSinCycle?1:(this._time-s)/this._animationSinCycle,i){var a=e-Math.sin(Phaser.Math.degToRad(90*s))*e;return a}var a=s*(-3*s+4);return a},i.prototype.animationRunning=function(){return!this._animationReversed&&this._time<this._totalAnimationTime||this._animationReversed&&this._time>0},i.prototype.setAnimation=function(e,i,s,a,o,n){if(void 0===n&&(n=!1),!this.animationRunning()){this._layerMain.visible=1===this._state,this._layerOptions.visible=2===this._state,this._layerCredits.visible=3===this._state,this._layerHelp.visible=4===this._state,this._layerCongrats.visible=6===this._state,this._layerLangs.visible=7===this._state,this._greyBG.visible=1===this._state||2===this._state,this._glass.visible=1!==this._state&&2!==this._state,this._btnBack.visible=this._glass.visible,a=this.game.height-a;var r=e-i,h=a/this.game.height;this._totalAnimationTime=r*h+i,this._originalAnimationTime=e,this._animationSinCycle=i,this._animationReversed=s,this._stateAfterAnim=o,this._doBrightening=n,"undefined"!=typeof t.Global.sponsor.soundcontrolls&&(this._tglMMusic.toggled=t.Global.musicOn,this._tglMSound.toggled=t.Global.soundOn),this._tglMusic.toggled=t.Global.musicOn,this._tglSound.toggled=t.Global.soundOn}},i.prototype.updateAnimation=function(t){var e=!1;if(!this._animationReversed&&this._time<this._totalAnimationTime?(this._time+=t,this._time>=this._totalAnimationTime&&(this._time=this._totalAnimationTime,e=!0)):this._animationReversed&&this._time>0&&(this._time-=t,this._time<=0&&(this._time=0,e=!0)),e&&-1!=this._stateAfterAnim)switch(this._state=this._stateAfterAnim,this._state){case 5:this._fader.fadeOut();break;case 2:this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.HEADLINE_ROW_SETTINGS,-1);break;case 4:this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.HELP_ROW,-1);break;case 3:this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.CREDITS_ROW,-1);break;case 1:this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.HEADLINE_ROW,-1);break;case 7:this.setAnimation(i.ANIMATION_TIME,i.ANIMATION_SIN_CYCLE,!1,i.LANG_ROW,-1)}},i.TEXT_SIZE=36,i.PARTICLES_MAX=30,i.SHARDS_DURATION=.2,i.ANIMATION_TIME=1.4,i.ANIMATION_SIN_CYCLE=.5,i.MENU_TOP_RATIO=.3,i.MENU_ICON_LEFT_RATIO=-.18,i.MENU_GRAY_START_RATIO=-.05,i.MENU_TEXT_START_RATIO=-.03,i.HEADLINE_ROW=-320,i.HEADLINE_ROW_SETTINGS=1280*.33-640,i.CREDITS_ROW=128,i.HELP_ROW=-320,i.LANG_ROW=128,i.FLAG_X=50,i.FLAG_Y=60,i.BUTTON_DIM=114,i}(Phaser.State);t.Menu=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this),this._level=0,this._newGame=!0,
this._lives=2,this._score=0,this._mousePosition=new Phaser.Point,Utils.AudioUtils.onFinished.add(this.onMusicFinished,this)}return __extends(i,e),i.prototype.onFullscreenChange=function(e){t.Global.fullscreenOption&&this._board.inGameMenu.onFullscreenChange(e)},Object.defineProperty(i.prototype,"level",{set:function(t){this._level=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"newGame",{set:function(t){this._newGame=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"levelsFile",{get:function(){return this._levelsFile},enumerable:!0,configurable:!0}),i.prototype.pause=function(){this._board.onPause(null)},i.prototype.create=function(){var e=this.cache.getBinary("LevelData");this._levelsFile=new t.BinaryFileReader(e),this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width,this.game.height),this.camera.focusOnXY(0,0),this.stage.backgroundColor=3158064,box2d.b2_velocityThreshold=0,this.game.physics.startSystem(Phaser.Physics.BOX2D);var i=this.game.physics.box2d;i.setPTMRatio(t.Settings.PTM),i.debugDraw.joints=!0,t.Global.LOW?(i.frameRate=1/30,this.time.desiredFps=30,this.game.forceSingleUpdate=!0):i.frameRate=1/60,i.resume(),this.game.input.onDown.add(this.dragStart,this),this.game.input.addMoveCallback(this.mouseMove,this),this.game.input.onUp.add(this.dragEnd,this),this._board=new t.Board(this.game,this),this._newGame?(this._board.setLives(2),this._board.clearScore(),this._newGame=!1):(this._board.setLives(this._lives),this._board.score=this._score),this._board.loadLevel(this._level),t.Global.lastLoadedLevel=this._level,this._fader=new t.Fader(this.game,"GUI","BLACK"),this._fader.onFadeFinished.add(this.faderFinished,this),this.world.add(this._fader),this._fader.fadeIn(500),this._playNextMusic=!0,this.playMusic(),this._mouseDown=!1},i.prototype.dragStart=function(t){this._board.paused||(this._mousePosition.copyFrom(t.position),this._mousePosition.subtract(this.game.width/2,this.game.height/2),this._mousePosition.y>.8*-(this.game.height/2)&&(this.game.device.desktop&&this._board.unstickBalls(),this._board.fireMissile(this._mousePosition)),this._mouseDown=!0)},i.prototype.mouseMove=function(t,e,i,s){this._board.paused||(this._mousePosition.copyFrom(t.position),this._mousePosition.subtract(this.game.width/2,this.game.height/2))},i.prototype.dragEnd=function(t){!this.game.device.desktop&&this._mouseDown&&t.y-this.game.height/2>.8*-(this.game.height/2)&&this._board.unstickBalls(),this._mouseDown=!1},i.prototype.update=function(){this._board.updatePaddlePosition(this._mousePosition);var t=this.game.time.physicsElapsed;this._board.tick(t)},i.prototype.shutdown=function(){},i.prototype.onExit=function(t){Utils.StorageUtils.save(),this._playNextMusic=!1,this._afterFade=i.FADE_TO_LEVELS,this._fader.frameName="WHITE",this._fader.fadeOut()},i.prototype.onNext=function(t){this._newGame=!1,this._lives=this._board.lives,this._score=this._board.score,++this._level,this._afterFade=i.FADE_TO_NEXT,this._fader.frameName="BLACK",this._fader.fadeOut()},i.prototype.onGameOver=function(){this._afterFade=i.FADE_TO_MAIN,this._fader.frameName="WHITE",this._fader.fadeOut()},i.prototype.faderFinished=function(e){e||(t.Global.sponsor.sdk.showAd(null,null,!1),this._afterFade===i.FADE_TO_MAIN?(t.Global.sponsor.sdk.endGameSession({score:this._board.score,level:this._level}),t.Global.sponsor.sdk.submitScore(0,this._board.score),t.Global.sponsor.sdk.gameOver(),this.game.state.start("Menu",!0,!1)):this._afterFade===i.FADE_TO_LEVELS?(t.Global.sponsor.sdk.endGameSession({score:this._board.score,level:this._level}),t.Global.sponsor.sdk.submitScore(0,this._board.score),t.Global.sponsor.sdk.gameOver(),this.game.state.start("Levels",!0,!1)):this._afterFade===i.FADE_TO_NEXT&&(this._level<t.Global.LEVELS?this.game.state.start("BgLoader",!0,!1,this._level):(this.game.state.states.Menu.congrats=!0,this.game.state.start("Menu",!0,!1))))},i.prototype.playMusic=function(){if("MainMusic"===Utils.AudioUtils.currentMusic&&Utils.AudioUtils.stopMusic(),"Play"===this.game.state.current&&t.Global.musicOn&&!Utils.AudioUtils.isMusicPlaying&&this._playNextMusic){var e=this.game.musicLoader,i=e.getMusic();null!==i?Utils.AudioUtils.playMusic(i,!1,!0):this.game.time.events.add(3e3,function(){this.playMusic()},this)}},i.prototype.stopMusic=function(){this._playNextMusic=!1,Utils.AudioUtils.stopMusic()},i.prototype.onMusicFinished=function(t){"Play"===this.game.state.current&&this.playMusic()},i.FADE_TO_MAIN=0,i.FADE_TO_LEVELS=1,i.FADE_TO_NEXT=2,i}(Phaser.State);t.Play=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this),this._hourglass=null,this._ready=!1,t.Global.LOW&&(i.LOADING_BAR_WIDTH*=.4,i.TEXT_SIZE*=.4)}return __extends(i,e),i.prototype.preload=function(){this.stage.backgroundColor=16777215,this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width,this.game.height),this.camera.focusOnXY(0,0);var e=this.game.height/2*.7;this._loadingBar=this.add.sprite(-i.LOADING_BAR_WIDTH/2,e,"Splash","Splash_Bar"),this._loadingBar.anchor.set(0,1),this._loadingBar.width=0,this._loadingText=this.add.bitmapText(0,e+i.TEXT_SIZE,"SplashFont","0%",i.TEXT_SIZE),this._loadingText.anchor.set(.5,.5);var s="assets/";if(this.game.device.ie||Phaser.Device.isAndroidStockBrowser())for(var a=0;a<t.Sfx.SOUND_NAMES.length;a++)this.load.audio(t.Sfx.SOUND_NAMES[a],"assets/Sfx/"+t.Sfx.SOUND_NAMES[a]+".m4a");else this.load.audio("SFX",["assets/sfx.ogg","assets/sfx.m4a"]);this.load.audio("MainMusic",["assets/Main.ogg","assets/Main.m4a"]);var o=s+"Backgrounds/";this.load.image("Title",o+"Title.jpg");var n=s+t.Global.assetsPath;this.load.atlas("GUI",n+"GUI_Shards.png",n+"GUI_Shards.json"),this.load.atlas("Game",n+"Shards_game.png",n+"Shards_game.json"),this.load.atlas("Hourglass",n+"Hourglass.png",n+"Hourglass.json"),this.load.xml("FontData",n+"Font.xml"),this.load.xml("FontForeData",n+"Font_fore.xml"),this.load.xml("FontBackData",n+"Font_back.xml"),this.load.binary("LevelData",s+"levels.bin",this.onBinaryLoaded,this),this.load.json("Text",s+"text.json"),this.load.json("Config",s+"config.json"),2===t.Global.sponsor.id&&this.load.image("MoreGames",t.Global.sponsor.sdk.getMoreGamesButton())},i.prototype.onBinaryLoaded=function(t,e){return e},i.prototype.loadUpdate=function(){this.setLoadingText(this.load.progress)},i.prototype.create=function(){this.game.device.iOS&&this.game.state.add("SoundDialog",t.SoundDialog),this.setLoadingText(100),this._loadingBar.width=i.LOADING_BAR_WIDTH;var e=new t.MusicManager(this.game);this.game.musicLoader=e,e.loadMusic(),this.cache.addBitmapFontFromImage("Font",null,"GUI",this.cache.getXML("FontData"),"xml"),this.cache.addBitmapFontFromImage("FontFore",null,"Game",this.cache.getXML("FontForeData"),"xml"),this.cache.addBitmapFontFromImage("FontBack",null,"Game",this.cache.getXML("FontBackData"),"xml");var s=(t.Global.LOW?.4:1,this.cache.getImage("Title")),a=this.cache.getFrameData("Title"),o=new Phaser.Frame(1,0,0,s.width,260,"Top"),n=new Phaser.Frame(1,0,s.height-36,s.width,36,"Bottom");a.addFrame(o),a.addFrame(n),this.readConfig(),this.loadSavedData(),Utils.TextUtils.setTexts(this.game.cache.getJSON("Text")),Utils.AudioUtils.addMusic("MainMusic",this.add.audio("MainMusic"));var r=0;if(this.game.device.ie||Phaser.Device.isAndroidStockBrowser()){r=.02,Utils.AudioUtils.setSounds(null,t.Sfx.SOUND_NAMES);for(var h=0;h<t.Sfx.SOUND_NAMES.length;h++){var l=this.add.audio(t.Sfx.SOUND_NAMES[h]);l.allowMultiple=!0,Utils.AudioUtils.addSound(t.Sfx.SOUND_NAMES[h],l)}}else{this.game.device.iOS&&(r=.1);var _=this.add.audio("SFX");Utils.AudioUtils.setSounds(_,t.Sfx.SOUND_NAMES),_.allowMultiple=!0,_.addMarker("ball_lost",0,1.229),_.addMarker("ball_sticky",2.5-r,.261+r),_.addMarker("ball_sticky_hit",4-r,.184+r),_.addMarker("bomb_explosion",5.5-r,.468+r),_.addMarker("border_hit_1",7-r,.302+r),_.addMarker("border_hit_2",8.5-r,.091+r),_.addMarker("border_hit_3",10-r,.25+r),_.addMarker("brick_damaged_1",11.5-r,.749+r),_.addMarker("brick_damaged_2",13-r,.091+r),_.addMarker("brick_damaged_3",14.5-r,.087+r),_.addMarker("brick_destroyed_1",16-r,.447+r),_.addMarker("cannon_explosion",17.5-r,.3+r),_.addMarker("cannon_fire",19-r,.12+r),_.addMarker("cannon_off",20.5-r,1.093+r),_.addMarker("cannon_on",23-r,1.1+r),_.addMarker("click",25.5-r,.397+r),_.addMarker("fire",27-r,.677+r),_.addMarker("freeze",28.5-r,1.296+r),_.addMarker("game_over",31-r,8.001+r),_.addMarker("impact",40.5-r,.246+r),_.addMarker("life",42-r,1.449+r),_.addMarker("paddle_enlarge",44.5-r,.295+r),_.addMarker("paddle_hit_1",46-r,.12+r),_.addMarker("paddle_hit_2",47.5-r,.107+r),_.addMarker("paddle_hit_3",49-r,.104+r),_.addMarker("paddle_shrink",50.5-r,.295+r),_.addMarker("powerball",52-r,1.009+r),_.addMarker("split_ball",54.5-r,.225+r),_.addMarker("swoosh",56-r,.517+r),_.addMarker("tick",57.5-r,.008+r),_.addMarker("unbreakable_hit_1",59-r,.116+r),_.addMarker("unbreakable_hit_2",60.5-r,.104+r),_.addMarker("enemy_explosion",62-r,.597+r),_.addMarker("enemy_border_hit_1",63.5-r,.302+r),_.addMarker("enemy_border_hit_2",65-r,.091+r),_.addMarker("enemy_border_hit_3",66.5-r,.25+r),_.addMarker("enemy_brick_damaged_1",68-r,.304+r),_.addMarker("enemy_brick_damaged_2",69.5-r,.091+r),_.addMarker("enemy_brick_damaged_3",71-r,.067+r),_.addMarker("enemy_unbreakable_hit_1",72.5-r,.062+r),_.addMarker("enemy_unbreakable_hit_2",74-r,.033+r)}this.time.events.add(500,function(){this._loadingBar.visible=!1,this._loadingText.visible=!1},this),this.time.events.add(1500,function(){if(!this._ready){var t=this.add.sprite(0,this._loadingBar.y,"Hourglass",0);t.anchor.set(.5,.5),t.animations.add("hourglass",Phaser.Animation.generateFrameNames("Loading",1,8),16,!0),t.animations.play("hourglass"),this._hourglass=t}},this)},i.prototype.loadSavedData=function(){Utils.StorageUtils.load();for(var e=t.Global.levelStats,i=e.length;i<t.Global.LEVELS;i++)e[i]=new t.LevelStats;e[0].unlocked=!0},i.prototype.readConfig=function(){var e=this.game.cache.getJSON("Config");void 0!==e.showLanguages&&(t.Global.showLanguages=e.showLanguages),void 0!==e.defaultLanguage&&(t.Global.currentLanguage=e.defaultLanguage),void 0!==e.supportedLanguages&&(t.Global.supportedLanguages=e.supportedLanguages),void 0!==e.fullscreenOption&&(t.Global.fullscreenOption=e.fullscreenOption&&Utils.FullscreenUtils.supported()),void 0!==e.unlockLevels&&(t.Global.unlockLevels=e.unlockLevels)},i.prototype.createLogo=function(){null!==this._hourglass&&(this._hourglass.visible=!1);var e=this.add.sprite(0,0,"Splash","Splash_Logo");e.anchor.set(.5,.5),e.scale.set(3,0),e.alpha=0;var i=500,s=1500,a=(this.add.tween(e).to({alpha:1},i,Phaser.Easing.Exponential.In,!0),this.add.tween(e.scale).to({x:1,y:1},i,Phaser.Easing.Exponential.In,!0));Utils.AudioUtils.playSound(t.Sfx.SWOOSH),a.onComplete.add(function(){this.time.events.add(s,function(){Utils.AudioUtils.playSound(t.Sfx.CLICK);var s=(this.add.tween(e).to({alpha:0},2*i,Phaser.Easing.Sinusoidal.In,!0),this.add.tween(e).to({y:this.game.height/2*.7},2*i,t.Easing.parabolic,!0));s.onComplete.add(this.nextState,this)},this)},this)},i.prototype.nextState=function(){this.game.device.iOS?this.game.state.start("SoundDialog"):this.game.state.start("Menu")},i.prototype.update=function(){var e=this.game.device.ie||Phaser.Device.isAndroidStockBrowser()||this.cache.isSoundDecoded("SFX");e&&this.cache.isSoundDecoded("MainMusic")&&this._ready===!1&&(this._ready=!0,"undefined"==typeof t.Global.sponsor.nobranding?this.createLogo():this.nextState())},i.prototype.setLoadingText=function(t){this._loadingText.setText(t+"%"),this._loadingText.updateText(),this._loadingBar.width=t/100*i.LOADING_BAR_WIDTH},i.LOADING_BAR_WIDTH=400,i.TEXT_SIZE=32,i}(Phaser.State);t.Preloader=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.prototype.init=function(t){this._level=t,this.stage.backgroundColor=0,this.time.events.add(3e3,function(){var t=this.add.sprite(0,0,"Hourglass");t.anchor.set(.5,.5),t.scale.set(5,5),t.smoothed=!1,t.animations.add("hourglass",Phaser.Animation.generateFrameNames("frame_",0,14,"",2),7,!0),t.animations.play("hourglass")},this)},i.prototype.preload=function(){var e=this.cache.getBinary("LevelData"),i=new t.BinaryFileReader(e);i.setFile(this._level);var s=i.readUint8()+1,a="assets/",o=a+"Backgrounds/";this.load.image("Bg",o+"Background_"+Utils.StringUtils.padNumber(s,2)+".jpg")},i.prototype.create=function(){this.game.state.start("Play",!0,!1)},i}(Phaser.State);t.BgLoader=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this),this._oldPosition=new Phaser.Point(-1e4,0),this._speedIcons=[],this._levelIcons=[],this._scrollCutOff=.25,this._scrollMaxVelocity=3200,this._scrollTimeToDecel=1,this._scrollDecelTime=0,this._updateInput=!1,t.Global.LOW&&(i.TEXT_SIZE*=.4,i.LABEL_OFFSET*=.4,i.ICONS_OFFSET*=.4,i.LEVELS_HEIGHT*=.4,i.BACK_OFFSET_X*=.4,i.BACK_OFFSET_Y*=.4,i.WHEEL_STEP*=.4)}return __extends(i,e),i.prototype.create=function(){var e=this.add.image(0,0,"Title",0,this.world);e.anchor.set(.5,.5),e.width=this.game.width,e.height=this.game.height,this._yscale=this.game.height/t.Global.GAME_HEIGHT*(t.Global.LOW?.4:1),this._middle=this.createMiddle(),this.world.add(this._middle),this._bottom=new Phaser.Group(this.game,this.world),this._bottom.position.set(-this.game.width/2,this.game.height/2);var s=this.add.image(0,0,"Title","Bottom",this._bottom);s.scale.y=this._yscale,s.width=this.game.width,s.anchor.set(0,1),this._top=this.createTop(),this._top.position.set(-this.game.width/2,-this.game.height/2),this.world.add(this._top);var a=this.cache.getFrameByName("GUI","SCROLLBAR");this._scrollBar=this.add.sprite(this.game.width/2-a.width-2,this._middleTop,"GUI",a.name,this.world),this._scrollBarHeight=a.height,this.setLastLevel(),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),this._btnBack=new UI.Button(this.game,"Back","GUI","ICON_CANCEL"),this._btnBack.position.set(this.game.width/2-i.BACK_OFFSET_X,this.game.height/2-i.BACK_OFFSET_Y),this._btnBack.scaleOnOver.set(1.1,1.1),this._btnBack.onClick.add(function(){this._fader.isRunning()||this._fader.fadeOut()},this),this.world.add(this._btnBack),this._fader=new t.Fader(this.game,"GUI","WHITE"),this._fader.onFadeFinished.add(this.faderFinished,this),this.world.add(this._fader),this._fader.fadeIn(),this._scrollDecelTime=0;var o=this;this.game.input.mouse.mouseWheelCallback=function(t){var e=o._middle.y-o._middleTop;o.setMiddlePosition(-e-o.game.input.mouse.wheelDelta*i.WHEEL_STEP),o._updateInput=!0},this._middle.postUpdate=function(){o._updateInput&&(o._updateInput=!1,o.input.mousePointer.dirty=!0,o.input.mousePointer.processInteractiveObjects(!1))}},i.prototype.faderFinished=function(t){t||this.game.state.start("Menu",!0,!1)},i.prototype.createTop=function(){var e=new Phaser.Group(this.game,this.world),s=i.LABEL_OFFSET+(this.game.width-t.Global.GAME_WIDTH)/2,a=(this.game.cache.getFrameByName("Title","Top"),t.Global.LOW?.4:1),o=this.add.image(0,0,"Title","Top",e);o.scale.y=this._yscale,o.width=this.game.width,this.add.bitmapText(s,i.LABEL_OFFSET,"Font",Utils.TextUtils.getText("TXT_GAME_SPEED"),i.TEXT_SIZE,e);var n=((this.game.width-2*i.LABEL_OFFSET)/3,s+55*a),r=i.ICONS_OFFSET,h=new t.IconSpeed(this.game,0,"BALL_SLOW_OFF","BALL_SLOW_ON","TXT_SPEED_SLOW");h.toggle.changeOnDown=!0;var l=new t.IconSpeed(this.game,1,"BALL_MEDIUM_OFF","BALL_MEDIUM_ON","TXT_SPEED_NORMAL");l.toggle.changeOnDown=!0;var _=new t.IconSpeed(this.game,2,"BALL_FAST_OFF","BALL_FAST_ON","TXT_SPEED_FAST");_.toggle.changeOnDown=!0,h.position.set(n,r);var c=this.game.width-s-_.iconWidth;return l.position.set(n+Math.floor((c-n)/2),r),_.position.set(c,r),h.toggle.onDown.add(this.onSpeedToggle,this),e.add(h),l.toggle.onDown.add(this.onSpeedToggle,this),e.add(l),_.toggle.onDown.add(this.onSpeedToggle,this),e.add(_),this._speedIcons[0]=h,this._speedIcons[1]=l,this._speedIcons[2]=_,this.add.bitmapText(s,o.height-i.TEXT_SIZE-i.LABEL_OFFSET/2,"Font",Utils.TextUtils.getText("TXT_LEVEL_SELECTION"),i.TEXT_SIZE,e),e},i.prototype.onSpeedToggle=function(e,i){if(!i)return void(e.toggled=!0);for(var s=0;3>s;s++)s!==e.difficulty?this._speedIcons[s].toggle.toggled=!1:t.Global.difficulty=s},i.prototype.createMiddle=function(){for(var e=new Phaser.Group(this.game,this.world),s=0;s<t.Global.LEVELS;s++){var a=new t.IconLevel(this.game,s);a.position.set(0,s*i.LEVELS_HEIGHT),(t.Global.levelStats[s].unlocked||t.Global.unlockLevels)&&a.addInputCallback(this.onStartLevel,this),e.add(a),this._levelIcons[s]=a}var o=this.cache.getFrameByName("Title","Top").height*this._yscale,n=this.cache.getFrameByName("Title","Bottom").height*this._yscale;return this._middleTop=-this.game.height/2+o,this._middleHeight=this.game.height-o-n,e},i.prototype.setLastLevel=function(){var e=t.Global.lastLoadedLevel;this.setMiddlePosition(e*i.LEVELS_HEIGHT)},i.prototype.setMiddlePosition=function(e){this._middle.x=0;var s=this._middle.y,a=Phaser.Math.clamp(e,0,t.Global.LEVELS*i.LEVELS_HEIGHT-this._middleHeight);this._middle.y=this._middleTop-a,s===this._middle.y&&(this._scrollDecelTime=0),this._scrollBar.y=this._middleTop+a/(t.Global.LEVELS*i.LEVELS_HEIGHT-this._middleHeight)*(this._middleHeight-this._scrollBarHeight);for(var o=0;o<t.Global.LEVELS;o++){var n=this._levelIcons[o],r=this._middle.y+o*i.LEVELS_HEIGHT,h=!(r+i.LEVELS_HEIGHT<this._middleTop||r>this._middleTop+this._middleHeight);n.visible=h}},i.prototype.mouseDragStart=function(t){var e=t.x-this.game.width/2-this._middle.x,i=t.y-this.game.height/2-this._middleTop;this._oldPosition.setTo(e,i),this._scrollDecelTime<.05?this._dragDistance=0:this._dragDistance=100,this._pointerReadTime=t.timeDown,this._scrollValue=0,this._scrollSamples=0,this._scrollDecelTime=0},i.prototype.mouseDragEnd=function(t){if(this._oldPosition.x=-1e4,this._dragDistance>5)for(var e=0;e<this._levelIcons.length;e++)this._levelIcons[e].unscale(),this._levelIcons[e].clearInput()},i.prototype.mouseDragMove=function(t,e,i,s){if(t.timeDown&&t.isDown&&-1e4!==this._oldPosition.x){var a=t.x-this.game.width/2-this._middle.x,o=t.y-this.game.height/2-this._middleTop;if(o>=0&&o<this._middleHeight){var n=-(o-this._oldPosition.y);this._oldPosition.setTo(a,o);var r=this.game.time.time;if(r>this._pointerReadTime){var h=r-this._pointerReadTime,l=n/(h/1e3);this._scrollValue=this._scrollValue*(1-this._scrollCutOff)+l*this._scrollCutOff,++this._scrollSamples,this._scrollDecelTime=this._scrollTimeToDecel,this._pointerReadTime=r,this._dragDistance+=Math.abs(n)}}else this._oldPosition.x=-1e4}},i.prototype.onStartLevel=function(e,i,s){if(s&&!(this._dragDistance>5)){var a=this.game.state.states.Play,o=e.parent.level;a.newGame=!0,a.level=o,t.Global.sponsor.sdk.startGameSession(),this.game.state.start("BgLoader",!0,!1,o)}},i.prototype.update=function(){if(this._scrollDecelTime>0){var t=this.time.physicsElapsed;this._scrollDecelTime=Math.max(0,this._scrollDecelTime-t);var e=this._scrollValue*t*this._scrollDecelTime*2;this._updateInput=!0;var i=this._middle.y-this._middleTop-e;this.setMiddlePosition(-i)}},i.prototype.shutdown=function(){this.game.input.mouse.mouseWheelCallback=null},i.TEXT_SIZE=36,i.LABEL_OFFSET=25,i.ICONS_OFFSET=135,i.LEVELS_HEIGHT=120,i.BACK_OFFSET_X=55,i.BACK_OFFSET_Y=50,i.WHEEL_STEP=50,i}(Phaser.State);t.Levels=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){e.call(this),t.Global.LOW&&(i.TEXT_SIZE*=.4,i.GLASS_HEIGHT*=.4,i.GLASS_WIDTH*=.4)}return __extends(i,e),i.prototype.create=function(){this.stage.backgroundColor=16777215;var e=t.Global.LOW?.4:1;this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width,this.game.height),this.camera.focusOnXY(0,0);var s=this.add.bitmapText(0,-100*e,"Font",Utils.TextUtils.getText("TXT_SOUND"),i.TEXT_SIZE);s.anchor.x=.5;var a=Math.max(i.GLASS_WIDTH,s.textWidth+60*e),o=Helper.NineImage.create(this.game,a,i.GLASS_HEIGHT,"GUI","GLASS",80*e,60*e,80*e,60*e,!1),n=this.game.add.sprite(0,0,o);n.anchor.set(.5,.5),n.addChild(s);var r=new UI.Button(this.game,"Cancel","GUI","BUTTON_CANCEL");r.position.set(-a/2+85*e,70*e),r.scaleOnOver.set(1.1,1.1),r.onClick.add(function(){t.Global.soundOn=!1,t.Global.musicOn=!1,this._block=!0,this._hideTween.start()},this),n.addChild(r);var h=new UI.Button(this.game,"Next","GUI","ICON_CONFIRM");h.position.set(a/2-85*e,70*e),h.scaleOnOver.set(1.1,1.1),h.onClick.add(function(){this._block=!0,this._hideTween.start()},this),n.addChild(h),this._offX=t.Global.GAME_WIDTH,n.x=this._offX,this._block=!0,this._showTween=this.add.tween(n).to({x:0},i.TWEEN_DURATION,Phaser.Easing.Sinusoidal.Out,!0),this._showTween.onComplete.add(function(){this._block=!1},this),this._hideTween=this.add.tween(n).to({x:this._offX},i.TWEEN_DURATION,Phaser.Easing.Sinusoidal.In,!1),this._hideTween.onComplete.add(function(){this.game.state.start("Menu")},this)},i.GLASS_WIDTH=400,i.GLASS_HEIGHT=300,i.TWEEN_DURATION=500,i.TEXT_SIZE=36,i}(Phaser.State);t.SoundDialog=e}(Shards||(Shards={}));var Shards;!function(t){var e=function(e){function i(){var s=-1!=navigator.userAgent.toLowerCase().indexOf("iphone"),a=-1!=navigator.userAgent.toLowerCase().indexOf("ipad"),o=s&&480==window.screen.height&&320==window.screen.width&&2==window.devicePixelRatio,n=a&&1024==window.screen.height&&768==window.screen.width&&1==window.devicePixelRatio;(o||n)&&(t.Global.NO_ANIMS=!0),(window.innerWidth*window.devicePixelRatio<=480||Phaser.Device.isAndroidStockBrowser()||o||n)&&(t.Global.LOW=!0,t.Global.assetsPath=t.Global.smallAssetsPath,t.Global.GAME_WIDTH*=.4,t.Global.GAME_HEIGHT*=.4,t.Global.MAX_GAME_WIDTH_DESKTOP*=.4,t.Global.MAX_GAME_HEIGHT_DESKTOP*=.4,t.Global.MAX_GAME_WIDTH_MOBILE*=.4,t.Global.MAX_GAME_HEIGHT_MOBILE*=.4,t.Settings.PTM*=.4,t.Settings.SHADOW_OFFSET_X*=.4,t.Settings.SHADOW_OFFSET_Y*=.4,t.Settings.BALL_DIAMETER*=.4,t.Settings.CANNON_OFFSET*=.4,t.Settings.BORDER_WIDTH*=.4,t.Settings.SPEED_NORMAL_SLOW_GAME*=.4,t.Settings.SPEED_INCREMENT*=.4,t.Global.NO_ANIMS=!0,t.Global.MAX_MUSIC=1);var r=Phaser.Device.isAndroidStockBrowser()?Phaser.CANVAS:Phaser.AUTO;e.call(this,t.Global.GAME_WIDTH,t.Global.GAME_HEIGHT,r,"content",null),i.game=this,t.Global.game=this,Utils.PhaserUtils.ChangeAnimationPhaserJSONData(this.additionalFrameProperties),Utils.PhaserUtils.AdjustTweenFunctions(),Utils.PhaserUtils.AddBitmapFontAddMethod(),this.state.add("Boot",t.Boot),this.state.add("Preloader",t.Preloader),this.state.add("Menu",t.Menu),this.state.add("Levels",t.Levels),this.state.add("Play",t.Play),this.state.add("BgLoader",t.BgLoader),this.state.start("Boot")}return __extends(i,e),Object.defineProperty(i.prototype,"musicLoader",{get:function(){return this._musicLoader},set:function(t){this._musicLoader=t},enumerable:!0,configurable:!0}),i.prototype.additionalFrameProperties=function(t,e){e.anchor&&(t.anchorX=e.anchor.w,t.anchorY=e.anchor.h),e.nextitem&&(t.nextItemX=e.nextitem.w,t.nextItemY=e.nextitem.h)},i}(Phaser.Game);t.Game=e}(Shards||(Shards={}));var Shards;!function(t){t.sponsorName="addictinggames";var e=function(){function t(){}return t.SPONSORS={none:{id:0,sdk:null},buongiorno:{id:1,sdk:null},famobi:{id:2,sdk:null,nobranding:!0},pmconnect:{id:3,sdk:null,logo:!0},addictinggames:{id:5,sdk:null,logo:!0}},t.sponsor=null,t.game=null,t.GAME_WIDTH=800,t.GAME_HEIGHT=1280,t.MAX_GAME_WIDTH_DESKTOP=800,t.MAX_GAME_HEIGHT_DESKTOP=1280,t.MAX_GAME_WIDTH_MOBILE=960,t.MAX_GAME_HEIGHT_MOBILE=1420,t.scaleX=1,t.scaleY=1,t.assetsPath="800/",t.smallAssetsPath="320/",t.LOW=!1,t.NO_ANIMS=!1,t.MAX_MUSIC=4,t.correctOrientation=!1,t.SBC_BOX2D_PTM_RATIO=48,t.musicOn=!0,t.soundOn=!0,t.fullscreenOption=!1,t.showLanguages=!1,t.supportedLanguages=["en"],t.currentLanguage="en",t.unlockLevels=!1,t.LEVELS=80,t.shardiensOn=!0,t.lastLoadedLevel=0,t.difficulty=1,t.hiScore=0,t.levelStats=[],t}();t.Global=e}(Shards||(Shards={}));var PhaserGlobal={stopFocus:!0};"famobi"!==Shards.sponsorName?window.onload=launch:window.famobi_onload=launch;var Shards;!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.prototype.preload=function(){this.game.load.image("Logo","assets/sponsor/Logo.png")},i.prototype.create=function(){this.world.setBounds(-this.game.width/2,-this.game.height/2,this.game.width,this.game.height),this.camera.focusOnXY(0,0),this.stage.backgroundColor=16777215;var e=t.Global.LOW?.4:1,i=this.game.add.image(0,0,"Logo");i.anchor.setTo(.5,.5),i.scale.set(e,e),this.game.add.tween(i).from({y:-this.game.height/2},1e3,Phaser.Easing.Bounce.Out,!0),this.game.add.tween(i).from({alpha:0},1e3,Phaser.Easing.Bounce.Out,!0),this.time.events.add(2e3,function(){this.game.add.tween(i).to({alpha:0},300,Phaser.Easing.Linear.None,!0),this.game.add.tween(i).to({y:400*e},500,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.state.start("Preloader",!0,!1)},this)},this)},i.prototype.shutdown=function(){this.cache.removeImage("Logo")},i}(Phaser.State);t.Logo=e}(Shards||(Shards={}));var Sponsor;!function(t){var e=function(){function t(t){this._game=t}return t.prototype.startGameSession=function(t){},t.prototype.endGameSession=function(t){},t.prototype.levelUp=function(t){},t.prototype.gameOver=function(t){},t.prototype.submitScore=function(t,e){},t.prototype.showAd=function(t,e,i){void 0===i&&(i=!1)},t.prototype.forceAd=function(t,e){this.showAd(t,e,!0)},t.prototype.showSplash=function(){},t.prototype.moreGamesLink=function(){},t.prototype.showLogo=function(){},t.prototype.hideLogo=function(){},t.prototype.submitAchievement=function(t){},t}();t.SponsorAdapter=e}(Sponsor||(Sponsor={}));var Sponsor;!function(t){var e=function(t){function e(e){t.call(this,e),this._sdk=null,this._sdk=window.GamifiveSDK,this._sdk.init({lite:!0,debug:!0,moreGamesButtonStyle:{top:"100%",marginTop:"-46px",position:"absolute"}})}return __extends(e,t),e.prototype.startGameSession=function(t){this._sdk.startSession()},e.prototype.endGameSession=function(t){this._sdk.endSession({score:t.score||0,level:t.level||0})},e.prototype.getLastLevel=function(){var t=this._sdk.getConfig().user.level;return isNaN(t)&&(t=0),t},e.prototype.saveUserData=function(t){this._sdk.saveUserData(t)},e.prototype.loadUserData=function(){var t=this._sdk.loadUserData();return t},e}(t.SponsorAdapter);t.SponsorBuongiorno=e}(Sponsor||(Sponsor={}));var Sponsor;!function(t){var e=function(t){function e(e){t.call(this,e),this._sdk=null,this._sdk=window.famobi}return __extends(e,t),e.prototype.levelUp=function(t){this._sdk.levelUp()},e.prototype.gameOver=function(t){this._sdk.gameOver()},e.prototype.submitScore=function(t,e){this._sdk.submitHighscore(t,e)},e.prototype.showAd=function(t,e,i){void 0===i&&(i=!1),this._sdk.showAd(function(){null!==t&&t.call(e)},i)},e.prototype.forceAd=function(t,e){this.showAd(t,e,!0)},e.prototype.moreGamesLink=function(){this._sdk.moreGamesLink()},e.prototype.getMoreGamesButton=function(){return this._sdk.getMoreGamesButtonImage()},e.DEBUG=!0,e}(t.SponsorAdapter);t.SponsorFamobi=e}(Sponsor||(Sponsor={}));